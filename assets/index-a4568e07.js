function Pb(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function kb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var mS={exports:{}},sf={},gS={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ic=Symbol.for("react.element"),Nb=Symbol.for("react.portal"),bb=Symbol.for("react.fragment"),xb=Symbol.for("react.strict_mode"),Db=Symbol.for("react.profiler"),Ob=Symbol.for("react.provider"),Vb=Symbol.for("react.context"),Lb=Symbol.for("react.forward_ref"),Mb=Symbol.for("react.suspense"),Fb=Symbol.for("react.memo"),Ub=Symbol.for("react.lazy"),NI=Symbol.iterator;function Bb(n){return n===null||typeof n!="object"?null:(n=NI&&n[NI]||n["@@iterator"],typeof n=="function"?n:null)}var _S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yS=Object.assign,vS={};function ka(n,e,t){this.props=n,this.context=e,this.refs=vS,this.updater=t||_S}ka.prototype.isReactComponent={};ka.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};ka.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function wS(){}wS.prototype=ka.prototype;function R_(n,e,t){this.props=n,this.context=e,this.refs=vS,this.updater=t||_S}var A_=R_.prototype=new wS;A_.constructor=R_;yS(A_,ka.prototype);A_.isPureReactComponent=!0;var bI=Array.isArray,IS=Object.prototype.hasOwnProperty,P_={current:null},ES={key:!0,ref:!0,__self:!0,__source:!0};function TS(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)IS.call(e,r)&&!ES.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:ic,type:n,key:s,ref:o,props:i,_owner:P_.current}}function jb(n,e){return{$$typeof:ic,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function k_(n){return typeof n=="object"&&n!==null&&n.$$typeof===ic}function zb(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var xI=/\/+/g;function Lp(n,e){return typeof n=="object"&&n!==null&&n.key!=null?zb(""+n.key):e.toString(36)}function Ch(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case ic:case Nb:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Lp(o,0):r,bI(i)?(t="",n!=null&&(t=n.replace(xI,"$&/")+"/"),Ch(i,e,t,"",function(c){return c})):i!=null&&(k_(i)&&(i=jb(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(xI,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",bI(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+Lp(s,a);o+=Ch(s,e,t,l,i)}else if(l=Bb(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+Lp(s,a++),o+=Ch(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zc(n,e,t){if(n==null)return n;var r=[],i=0;return Ch(n,r,"","",function(s){return e.call(t,s,i++)}),r}function qb(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Yt={current:null},Rh={transition:null},$b={ReactCurrentDispatcher:Yt,ReactCurrentBatchConfig:Rh,ReactCurrentOwner:P_};de.Children={map:Zc,forEach:function(n,e,t){Zc(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Zc(n,function(){e++}),e},toArray:function(n){return Zc(n,function(e){return e})||[]},only:function(n){if(!k_(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};de.Component=ka;de.Fragment=bb;de.Profiler=Db;de.PureComponent=R_;de.StrictMode=xb;de.Suspense=Mb;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$b;de.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=yS({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=P_.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)IS.call(e,l)&&!ES.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ic,type:n.type,key:i,ref:s,props:r,_owner:o}};de.createContext=function(n){return n={$$typeof:Vb,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Ob,_context:n},n.Consumer=n};de.createElement=TS;de.createFactory=function(n){var e=TS.bind(null,n);return e.type=n,e};de.createRef=function(){return{current:null}};de.forwardRef=function(n){return{$$typeof:Lb,render:n}};de.isValidElement=k_;de.lazy=function(n){return{$$typeof:Ub,_payload:{_status:-1,_result:n},_init:qb}};de.memo=function(n,e){return{$$typeof:Fb,type:n,compare:e===void 0?null:e}};de.startTransition=function(n){var e=Rh.transition;Rh.transition={};try{n()}finally{Rh.transition=e}};de.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};de.useCallback=function(n,e){return Yt.current.useCallback(n,e)};de.useContext=function(n){return Yt.current.useContext(n)};de.useDebugValue=function(){};de.useDeferredValue=function(n){return Yt.current.useDeferredValue(n)};de.useEffect=function(n,e){return Yt.current.useEffect(n,e)};de.useId=function(){return Yt.current.useId()};de.useImperativeHandle=function(n,e,t){return Yt.current.useImperativeHandle(n,e,t)};de.useInsertionEffect=function(n,e){return Yt.current.useInsertionEffect(n,e)};de.useLayoutEffect=function(n,e){return Yt.current.useLayoutEffect(n,e)};de.useMemo=function(n,e){return Yt.current.useMemo(n,e)};de.useReducer=function(n,e,t){return Yt.current.useReducer(n,e,t)};de.useRef=function(n){return Yt.current.useRef(n)};de.useState=function(n){return Yt.current.useState(n)};de.useSyncExternalStore=function(n,e,t){return Yt.current.useSyncExternalStore(n,e,t)};de.useTransition=function(){return Yt.current.useTransition()};de.version="18.2.0";gS.exports=de;var B=gS.exports;const SS=kb(B),Wb=Pb({__proto__:null,default:SS},[B]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gb=B,Kb=Symbol.for("react.element"),Hb=Symbol.for("react.fragment"),Qb=Object.prototype.hasOwnProperty,Yb=Gb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jb={key:!0,ref:!0,__self:!0,__source:!0};function CS(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Qb.call(e,r)&&!Jb.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Kb,type:n,key:s,ref:o,props:i,_owner:Yb.current}}sf.Fragment=Hb;sf.jsx=CS;sf.jsxs=CS;mS.exports=sf;var q=mS.exports,bm={},RS={exports:{}},Tn={},AS={exports:{}},PS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(H,te){var se=H.length;H.push(te);e:for(;0<se;){var Me=se-1>>>1,Ie=H[Me];if(0<i(Ie,te))H[Me]=te,H[se]=Ie,se=Me;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var te=H[0],se=H.pop();if(se!==te){H[0]=se;e:for(var Me=0,Ie=H.length,Xe=Ie>>>1;Me<Xe;){var gr=2*(Me+1)-1,_r=H[gr],yr=gr+1,Jn=H[yr];if(0>i(_r,se))yr<Ie&&0>i(Jn,_r)?(H[Me]=Jn,H[yr]=se,Me=yr):(H[Me]=_r,H[gr]=se,Me=gr);else if(yr<Ie&&0>i(Jn,se))H[Me]=Jn,H[yr]=se,Me=yr;else break e}}return te}function i(H,te){var se=H.sortIndex-te.sortIndex;return se!==0?se:H.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,d=null,p=3,_=!1,E=!1,C=!1,P=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(H){for(var te=t(c);te!==null;){if(te.callback===null)r(c);else if(te.startTime<=H)r(c),te.sortIndex=te.expirationTime,e(l,te);else break;te=t(c)}}function D(H){if(C=!1,w(H),!E)if(t(l)!==null)E=!0,Ut(L);else{var te=t(c);te!==null&&mr(D,te.startTime-H)}}function L(H,te){E=!1,C&&(C=!1,I(y),y=-1),_=!0;var se=p;try{for(w(te),d=t(l);d!==null&&(!(d.expirationTime>te)||H&&!k());){var Me=d.callback;if(typeof Me=="function"){d.callback=null,p=d.priorityLevel;var Ie=Me(d.expirationTime<=te);te=n.unstable_now(),typeof Ie=="function"?d.callback=Ie:d===t(l)&&r(l),w(te)}else r(l);d=t(l)}if(d!==null)var Xe=!0;else{var gr=t(c);gr!==null&&mr(D,gr.startTime-te),Xe=!1}return Xe}finally{d=null,p=se,_=!1}}var M=!1,T=null,y=-1,S=5,R=-1;function k(){return!(n.unstable_now()-R<S)}function b(){if(T!==null){var H=n.unstable_now();R=H;var te=!0;try{te=T(!0,H)}finally{te?A():(M=!1,T=null)}}else M=!1}var A;if(typeof v=="function")A=function(){v(b)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,Re=re.port2;re.port1.onmessage=b,A=function(){Re.postMessage(null)}}else A=function(){P(b,0)};function Ut(H){T=H,M||(M=!0,A())}function mr(H,te){y=P(function(){H(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_continueExecution=function(){E||_||(E=!0,Ut(L))},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(H){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var se=p;p=te;try{return H()}finally{p=se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(H,te){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var se=p;p=H;try{return te()}finally{p=se}},n.unstable_scheduleCallback=function(H,te,se){var Me=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Me+se:Me):se=Me,H){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=se+Ie,H={id:h++,callback:te,priorityLevel:H,startTime:se,expirationTime:Ie,sortIndex:-1},se>Me?(H.sortIndex=se,e(c,H),t(l)===null&&H===t(c)&&(C?(I(y),y=-1):C=!0,mr(D,se-Me))):(H.sortIndex=Ie,e(l,H),E||_||(E=!0,Ut(L))),H},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(H){var te=p;return function(){var se=p;p=te;try{return H.apply(this,arguments)}finally{p=se}}}})(PS);AS.exports=PS;var Xb=AS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kS=B,In=Xb;function j(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NS=new Set,lu={};function Hs(n,e){ta(n,e),ta(n+"Capture",e)}function ta(n,e){for(lu[n]=e,n=0;n<e.length;n++)NS.add(e[n])}var Or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xm=Object.prototype.hasOwnProperty,Zb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,DI={},OI={};function ex(n){return xm.call(OI,n)?!0:xm.call(DI,n)?!1:Zb.test(n)?OI[n]=!0:(DI[n]=!0,!1)}function tx(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function nx(n,e,t,r){if(e===null||typeof e>"u"||tx(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){At[n]=new Jt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];At[e]=new Jt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){At[n]=new Jt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){At[n]=new Jt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){At[n]=new Jt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){At[n]=new Jt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){At[n]=new Jt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){At[n]=new Jt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){At[n]=new Jt(n,5,!1,n.toLowerCase(),null,!1,!1)});var N_=/[\-:]([a-z])/g;function b_(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(N_,b_);At[e]=new Jt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(N_,b_);At[e]=new Jt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(N_,b_);At[e]=new Jt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){At[n]=new Jt(n,1,!1,n.toLowerCase(),null,!1,!1)});At.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){At[n]=new Jt(n,1,!1,n.toLowerCase(),null,!0,!0)});function x_(n,e,t,r){var i=At.hasOwnProperty(e)?At[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nx(e,t,i,r)&&(t=null),r||i===null?ex(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var qr=kS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eh=Symbol.for("react.element"),So=Symbol.for("react.portal"),Co=Symbol.for("react.fragment"),D_=Symbol.for("react.strict_mode"),Dm=Symbol.for("react.profiler"),bS=Symbol.for("react.provider"),xS=Symbol.for("react.context"),O_=Symbol.for("react.forward_ref"),Om=Symbol.for("react.suspense"),Vm=Symbol.for("react.suspense_list"),V_=Symbol.for("react.memo"),si=Symbol.for("react.lazy"),DS=Symbol.for("react.offscreen"),VI=Symbol.iterator;function ll(n){return n===null||typeof n!="object"?null:(n=VI&&n[VI]||n["@@iterator"],typeof n=="function"?n:null)}var je=Object.assign,Mp;function Nl(n){if(Mp===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Mp=e&&e[1]||""}return`
`+Mp+n}var Fp=!1;function Up(n,e){if(!n||Fp)return"";Fp=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Fp=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Nl(n):""}function rx(n){switch(n.tag){case 5:return Nl(n.type);case 16:return Nl("Lazy");case 13:return Nl("Suspense");case 19:return Nl("SuspenseList");case 0:case 2:case 15:return n=Up(n.type,!1),n;case 11:return n=Up(n.type.render,!1),n;case 1:return n=Up(n.type,!0),n;default:return""}}function Lm(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Co:return"Fragment";case So:return"Portal";case Dm:return"Profiler";case D_:return"StrictMode";case Om:return"Suspense";case Vm:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case xS:return(n.displayName||"Context")+".Consumer";case bS:return(n._context.displayName||"Context")+".Provider";case O_:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case V_:return e=n.displayName||null,e!==null?e:Lm(n.type)||"Memo";case si:e=n._payload,n=n._init;try{return Lm(n(e))}catch{}}return null}function ix(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lm(e);case 8:return e===D_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ki(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function OS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sx(n){var e=OS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function th(n){n._valueTracker||(n._valueTracker=sx(n))}function VS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=OS(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Jh(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Mm(n,e){var t=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function LI(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=ki(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function LS(n,e){e=e.checked,e!=null&&x_(n,"checked",e,!1)}function Fm(n,e){LS(n,e);var t=ki(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Um(n,e.type,t):e.hasOwnProperty("defaultValue")&&Um(n,e.type,ki(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function MI(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Um(n,e,t){(e!=="number"||Jh(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var bl=Array.isArray;function Uo(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+ki(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Bm(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function FI(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(j(92));if(bl(t)){if(1<t.length)throw Error(j(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ki(t)}}function MS(n,e){var t=ki(e.value),r=ki(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function UI(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function FS(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jm(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?FS(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var nh,US=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(nh=nh||document.createElement("div"),nh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function uu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Bl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ox=["Webkit","ms","Moz","O"];Object.keys(Bl).forEach(function(n){ox.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Bl[e]=Bl[n]})});function BS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Bl.hasOwnProperty(n)&&Bl[n]?(""+e).trim():e+"px"}function jS(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=BS(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var ax=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zm(n,e){if(e){if(ax[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function qm(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $m=null;function L_(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Wm=null,Bo=null,jo=null;function BI(n){if(n=ac(n)){if(typeof Wm!="function")throw Error(j(280));var e=n.stateNode;e&&(e=cf(e),Wm(n.stateNode,n.type,e))}}function zS(n){Bo?jo?jo.push(n):jo=[n]:Bo=n}function qS(){if(Bo){var n=Bo,e=jo;if(jo=Bo=null,BI(n),e)for(n=0;n<e.length;n++)BI(e[n])}}function $S(n,e){return n(e)}function WS(){}var Bp=!1;function GS(n,e,t){if(Bp)return n(e,t);Bp=!0;try{return $S(n,e,t)}finally{Bp=!1,(Bo!==null||jo!==null)&&(WS(),qS())}}function cu(n,e){var t=n.stateNode;if(t===null)return null;var r=cf(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(j(231,e,typeof t));return t}var Gm=!1;if(Or)try{var ul={};Object.defineProperty(ul,"passive",{get:function(){Gm=!0}}),window.addEventListener("test",ul,ul),window.removeEventListener("test",ul,ul)}catch{Gm=!1}function lx(n,e,t,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(h){this.onError(h)}}var jl=!1,Xh=null,Zh=!1,Km=null,ux={onError:function(n){jl=!0,Xh=n}};function cx(n,e,t,r,i,s,o,a,l){jl=!1,Xh=null,lx.apply(ux,arguments)}function hx(n,e,t,r,i,s,o,a,l){if(cx.apply(this,arguments),jl){if(jl){var c=Xh;jl=!1,Xh=null}else throw Error(j(198));Zh||(Zh=!0,Km=c)}}function Qs(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function KS(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function jI(n){if(Qs(n)!==n)throw Error(j(188))}function dx(n){var e=n.alternate;if(!e){if(e=Qs(n),e===null)throw Error(j(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return jI(i),n;if(s===r)return jI(i),e;s=s.sibling}throw Error(j(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(j(189))}}if(t.alternate!==r)throw Error(j(190))}if(t.tag!==3)throw Error(j(188));return t.stateNode.current===t?n:e}function HS(n){return n=dx(n),n!==null?QS(n):null}function QS(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=QS(n);if(e!==null)return e;n=n.sibling}return null}var YS=In.unstable_scheduleCallback,zI=In.unstable_cancelCallback,fx=In.unstable_shouldYield,px=In.unstable_requestPaint,Ze=In.unstable_now,mx=In.unstable_getCurrentPriorityLevel,M_=In.unstable_ImmediatePriority,JS=In.unstable_UserBlockingPriority,ed=In.unstable_NormalPriority,gx=In.unstable_LowPriority,XS=In.unstable_IdlePriority,of=null,lr=null;function _x(n){if(lr&&typeof lr.onCommitFiberRoot=="function")try{lr.onCommitFiberRoot(of,n,void 0,(n.current.flags&128)===128)}catch{}}var qn=Math.clz32?Math.clz32:wx,yx=Math.log,vx=Math.LN2;function wx(n){return n>>>=0,n===0?32:31-(yx(n)/vx|0)|0}var rh=64,ih=4194304;function xl(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function td(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=xl(a):(s&=o,s!==0&&(r=xl(s)))}else o=t&~i,o!==0?r=xl(o):s!==0&&(r=xl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-qn(e),i=1<<t,r|=n[t],e&=~i;return r}function Ix(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ex(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-qn(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=Ix(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function Hm(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ZS(){var n=rh;return rh<<=1,!(rh&4194240)&&(rh=64),n}function jp(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function sc(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-qn(e),n[e]=t}function Tx(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-qn(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function F_(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-qn(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var ve=0;function eC(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var tC,U_,nC,rC,iC,Qm=!1,sh=[],gi=null,_i=null,yi=null,hu=new Map,du=new Map,ai=[],Sx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qI(n,e){switch(n){case"focusin":case"focusout":gi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":hu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":du.delete(e.pointerId)}}function cl(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ac(e),e!==null&&U_(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function Cx(n,e,t,r,i){switch(e){case"focusin":return gi=cl(gi,n,e,t,r,i),!0;case"dragenter":return _i=cl(_i,n,e,t,r,i),!0;case"mouseover":return yi=cl(yi,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return hu.set(s,cl(hu.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,du.set(s,cl(du.get(s)||null,n,e,t,r,i)),!0}return!1}function sC(n){var e=fs(n.target);if(e!==null){var t=Qs(e);if(t!==null){if(e=t.tag,e===13){if(e=KS(t),e!==null){n.blockedOn=e,iC(n.priority,function(){nC(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ah(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Ym(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);$m=r,t.target.dispatchEvent(r),$m=null}else return e=ac(t),e!==null&&U_(e),n.blockedOn=t,!1;e.shift()}return!0}function $I(n,e,t){Ah(n)&&t.delete(e)}function Rx(){Qm=!1,gi!==null&&Ah(gi)&&(gi=null),_i!==null&&Ah(_i)&&(_i=null),yi!==null&&Ah(yi)&&(yi=null),hu.forEach($I),du.forEach($I)}function hl(n,e){n.blockedOn===e&&(n.blockedOn=null,Qm||(Qm=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,Rx)))}function fu(n){function e(i){return hl(i,n)}if(0<sh.length){hl(sh[0],n);for(var t=1;t<sh.length;t++){var r=sh[t];r.blockedOn===n&&(r.blockedOn=null)}}for(gi!==null&&hl(gi,n),_i!==null&&hl(_i,n),yi!==null&&hl(yi,n),hu.forEach(e),du.forEach(e),t=0;t<ai.length;t++)r=ai[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ai.length&&(t=ai[0],t.blockedOn===null);)sC(t),t.blockedOn===null&&ai.shift()}var zo=qr.ReactCurrentBatchConfig,nd=!0;function Ax(n,e,t,r){var i=ve,s=zo.transition;zo.transition=null;try{ve=1,B_(n,e,t,r)}finally{ve=i,zo.transition=s}}function Px(n,e,t,r){var i=ve,s=zo.transition;zo.transition=null;try{ve=4,B_(n,e,t,r)}finally{ve=i,zo.transition=s}}function B_(n,e,t,r){if(nd){var i=Ym(n,e,t,r);if(i===null)Jp(n,e,r,rd,t),qI(n,r);else if(Cx(i,n,e,t,r))r.stopPropagation();else if(qI(n,r),e&4&&-1<Sx.indexOf(n)){for(;i!==null;){var s=ac(i);if(s!==null&&tC(s),s=Ym(n,e,t,r),s===null&&Jp(n,e,r,rd,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Jp(n,e,r,null,t)}}var rd=null;function Ym(n,e,t,r){if(rd=null,n=L_(r),n=fs(n),n!==null)if(e=Qs(n),e===null)n=null;else if(t=e.tag,t===13){if(n=KS(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return rd=n,null}function oC(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mx()){case M_:return 1;case JS:return 4;case ed:case gx:return 16;case XS:return 536870912;default:return 16}default:return 16}}var hi=null,j_=null,Ph=null;function aC(){if(Ph)return Ph;var n,e=j_,t=e.length,r,i="value"in hi?hi.value:hi.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return Ph=i.slice(n,1<r?1-r:void 0)}function kh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function oh(){return!0}function WI(){return!1}function Sn(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?oh:WI,this.isPropagationStopped=WI,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=oh)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=oh)},persist:function(){},isPersistent:oh}),e}var Na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},z_=Sn(Na),oc=je({},Na,{view:0,detail:0}),kx=Sn(oc),zp,qp,dl,af=je({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:q_,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==dl&&(dl&&n.type==="mousemove"?(zp=n.screenX-dl.screenX,qp=n.screenY-dl.screenY):qp=zp=0,dl=n),zp)},movementY:function(n){return"movementY"in n?n.movementY:qp}}),GI=Sn(af),Nx=je({},af,{dataTransfer:0}),bx=Sn(Nx),xx=je({},oc,{relatedTarget:0}),$p=Sn(xx),Dx=je({},Na,{animationName:0,elapsedTime:0,pseudoElement:0}),Ox=Sn(Dx),Vx=je({},Na,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Lx=Sn(Vx),Mx=je({},Na,{data:0}),KI=Sn(Mx),Fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ux={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jx(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Bx[n])?!!e[n]:!1}function q_(){return jx}var zx=je({},oc,{key:function(n){if(n.key){var e=Fx[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=kh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ux[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:q_,charCode:function(n){return n.type==="keypress"?kh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?kh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),qx=Sn(zx),$x=je({},af,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),HI=Sn($x),Wx=je({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:q_}),Gx=Sn(Wx),Kx=je({},Na,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hx=Sn(Kx),Qx=je({},af,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Yx=Sn(Qx),Jx=[9,13,27,32],$_=Or&&"CompositionEvent"in window,zl=null;Or&&"documentMode"in document&&(zl=document.documentMode);var Xx=Or&&"TextEvent"in window&&!zl,lC=Or&&(!$_||zl&&8<zl&&11>=zl),QI=String.fromCharCode(32),YI=!1;function uC(n,e){switch(n){case"keyup":return Jx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cC(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ro=!1;function Zx(n,e){switch(n){case"compositionend":return cC(e);case"keypress":return e.which!==32?null:(YI=!0,QI);case"textInput":return n=e.data,n===QI&&YI?null:n;default:return null}}function eD(n,e){if(Ro)return n==="compositionend"||!$_&&uC(n,e)?(n=aC(),Ph=j_=hi=null,Ro=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lC&&e.locale!=="ko"?null:e.data;default:return null}}var tD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function JI(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!tD[n.type]:e==="textarea"}function hC(n,e,t,r){zS(r),e=id(e,"onChange"),0<e.length&&(t=new z_("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ql=null,pu=null;function nD(n){EC(n,0)}function lf(n){var e=ko(n);if(VS(e))return n}function rD(n,e){if(n==="change")return e}var dC=!1;if(Or){var Wp;if(Or){var Gp="oninput"in document;if(!Gp){var XI=document.createElement("div");XI.setAttribute("oninput","return;"),Gp=typeof XI.oninput=="function"}Wp=Gp}else Wp=!1;dC=Wp&&(!document.documentMode||9<document.documentMode)}function ZI(){ql&&(ql.detachEvent("onpropertychange",fC),pu=ql=null)}function fC(n){if(n.propertyName==="value"&&lf(pu)){var e=[];hC(e,pu,n,L_(n)),GS(nD,e)}}function iD(n,e,t){n==="focusin"?(ZI(),ql=e,pu=t,ql.attachEvent("onpropertychange",fC)):n==="focusout"&&ZI()}function sD(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return lf(pu)}function oD(n,e){if(n==="click")return lf(e)}function aD(n,e){if(n==="input"||n==="change")return lf(e)}function lD(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Gn=typeof Object.is=="function"?Object.is:lD;function mu(n,e){if(Gn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!xm.call(e,i)||!Gn(n[i],e[i]))return!1}return!0}function eE(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function tE(n,e){var t=eE(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=eE(t)}}function pC(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?pC(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function mC(){for(var n=window,e=Jh();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Jh(n.document)}return e}function W_(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function uD(n){var e=mC(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&pC(t.ownerDocument.documentElement,t)){if(r!==null&&W_(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=tE(t,s);var o=tE(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var cD=Or&&"documentMode"in document&&11>=document.documentMode,Ao=null,Jm=null,$l=null,Xm=!1;function nE(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Xm||Ao==null||Ao!==Jh(r)||(r=Ao,"selectionStart"in r&&W_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$l&&mu($l,r)||($l=r,r=id(Jm,"onSelect"),0<r.length&&(e=new z_("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ao)))}function ah(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Po={animationend:ah("Animation","AnimationEnd"),animationiteration:ah("Animation","AnimationIteration"),animationstart:ah("Animation","AnimationStart"),transitionend:ah("Transition","TransitionEnd")},Kp={},gC={};Or&&(gC=document.createElement("div").style,"AnimationEvent"in window||(delete Po.animationend.animation,delete Po.animationiteration.animation,delete Po.animationstart.animation),"TransitionEvent"in window||delete Po.transitionend.transition);function uf(n){if(Kp[n])return Kp[n];if(!Po[n])return n;var e=Po[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in gC)return Kp[n]=e[t];return n}var _C=uf("animationend"),yC=uf("animationiteration"),vC=uf("animationstart"),wC=uf("transitionend"),IC=new Map,rE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qi(n,e){IC.set(n,e),Hs(e,[n])}for(var Hp=0;Hp<rE.length;Hp++){var Qp=rE[Hp],hD=Qp.toLowerCase(),dD=Qp[0].toUpperCase()+Qp.slice(1);qi(hD,"on"+dD)}qi(_C,"onAnimationEnd");qi(yC,"onAnimationIteration");qi(vC,"onAnimationStart");qi("dblclick","onDoubleClick");qi("focusin","onFocus");qi("focusout","onBlur");qi(wC,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dl));function iE(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,hx(r,e,void 0,n),n.currentTarget=null}function EC(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;iE(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;iE(i,a,c),s=l}}}if(Zh)throw n=Km,Zh=!1,Km=null,n}function Pe(n,e){var t=e[rg];t===void 0&&(t=e[rg]=new Set);var r=n+"__bubble";t.has(r)||(TC(e,n,2,!1),t.add(r))}function Yp(n,e,t){var r=0;e&&(r|=4),TC(t,n,r,e)}var lh="_reactListening"+Math.random().toString(36).slice(2);function gu(n){if(!n[lh]){n[lh]=!0,NS.forEach(function(t){t!=="selectionchange"&&(fD.has(t)||Yp(t,!1,n),Yp(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[lh]||(e[lh]=!0,Yp("selectionchange",!1,e))}}function TC(n,e,t,r){switch(oC(e)){case 1:var i=Ax;break;case 4:i=Px;break;default:i=B_}t=i.bind(null,e,t,n),i=void 0,!Gm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Jp(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=fs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}GS(function(){var c=s,h=L_(t),d=[];e:{var p=IC.get(n);if(p!==void 0){var _=z_,E=n;switch(n){case"keypress":if(kh(t)===0)break e;case"keydown":case"keyup":_=qx;break;case"focusin":E="focus",_=$p;break;case"focusout":E="blur",_=$p;break;case"beforeblur":case"afterblur":_=$p;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=GI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=bx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=Gx;break;case _C:case yC:case vC:_=Ox;break;case wC:_=Hx;break;case"scroll":_=kx;break;case"wheel":_=Yx;break;case"copy":case"cut":case"paste":_=Lx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=HI}var C=(e&4)!==0,P=!C&&n==="scroll",I=C?p!==null?p+"Capture":null:p;C=[];for(var v=c,w;v!==null;){w=v;var D=w.stateNode;if(w.tag===5&&D!==null&&(w=D,I!==null&&(D=cu(v,I),D!=null&&C.push(_u(v,D,w)))),P)break;v=v.return}0<C.length&&(p=new _(p,E,null,t,h),d.push({event:p,listeners:C}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",p&&t!==$m&&(E=t.relatedTarget||t.fromElement)&&(fs(E)||E[Vr]))break e;if((_||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,_?(E=t.relatedTarget||t.toElement,_=c,E=E?fs(E):null,E!==null&&(P=Qs(E),E!==P||E.tag!==5&&E.tag!==6)&&(E=null)):(_=null,E=c),_!==E)){if(C=GI,D="onMouseLeave",I="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(C=HI,D="onPointerLeave",I="onPointerEnter",v="pointer"),P=_==null?p:ko(_),w=E==null?p:ko(E),p=new C(D,v+"leave",_,t,h),p.target=P,p.relatedTarget=w,D=null,fs(h)===c&&(C=new C(I,v+"enter",E,t,h),C.target=w,C.relatedTarget=P,D=C),P=D,_&&E)t:{for(C=_,I=E,v=0,w=C;w;w=ho(w))v++;for(w=0,D=I;D;D=ho(D))w++;for(;0<v-w;)C=ho(C),v--;for(;0<w-v;)I=ho(I),w--;for(;v--;){if(C===I||I!==null&&C===I.alternate)break t;C=ho(C),I=ho(I)}C=null}else C=null;_!==null&&sE(d,p,_,C,!1),E!==null&&P!==null&&sE(d,P,E,C,!0)}}e:{if(p=c?ko(c):window,_=p.nodeName&&p.nodeName.toLowerCase(),_==="select"||_==="input"&&p.type==="file")var L=rD;else if(JI(p))if(dC)L=aD;else{L=sD;var M=iD}else(_=p.nodeName)&&_.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=oD);if(L&&(L=L(n,c))){hC(d,L,t,h);break e}M&&M(n,p,c),n==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&Um(p,"number",p.value)}switch(M=c?ko(c):window,n){case"focusin":(JI(M)||M.contentEditable==="true")&&(Ao=M,Jm=c,$l=null);break;case"focusout":$l=Jm=Ao=null;break;case"mousedown":Xm=!0;break;case"contextmenu":case"mouseup":case"dragend":Xm=!1,nE(d,t,h);break;case"selectionchange":if(cD)break;case"keydown":case"keyup":nE(d,t,h)}var T;if($_)e:{switch(n){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Ro?uC(n,t)&&(y="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(y="onCompositionStart");y&&(lC&&t.locale!=="ko"&&(Ro||y!=="onCompositionStart"?y==="onCompositionEnd"&&Ro&&(T=aC()):(hi=h,j_="value"in hi?hi.value:hi.textContent,Ro=!0)),M=id(c,y),0<M.length&&(y=new KI(y,n,null,t,h),d.push({event:y,listeners:M}),T?y.data=T:(T=cC(t),T!==null&&(y.data=T)))),(T=Xx?Zx(n,t):eD(n,t))&&(c=id(c,"onBeforeInput"),0<c.length&&(h=new KI("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:c}),h.data=T))}EC(d,e)})}function _u(n,e,t){return{instance:n,listener:e,currentTarget:t}}function id(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=cu(n,t),s!=null&&r.unshift(_u(n,s,i)),s=cu(n,e),s!=null&&r.push(_u(n,s,i))),n=n.return}return r}function ho(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function sE(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=cu(t,s),l!=null&&o.unshift(_u(t,l,a))):i||(l=cu(t,s),l!=null&&o.push(_u(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var pD=/\r\n?/g,mD=/\u0000|\uFFFD/g;function oE(n){return(typeof n=="string"?n:""+n).replace(pD,`
`).replace(mD,"")}function uh(n,e,t){if(e=oE(e),oE(n)!==e&&t)throw Error(j(425))}function sd(){}var Zm=null,eg=null;function tg(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ng=typeof setTimeout=="function"?setTimeout:void 0,gD=typeof clearTimeout=="function"?clearTimeout:void 0,aE=typeof Promise=="function"?Promise:void 0,_D=typeof queueMicrotask=="function"?queueMicrotask:typeof aE<"u"?function(n){return aE.resolve(null).then(n).catch(yD)}:ng;function yD(n){setTimeout(function(){throw n})}function Xp(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),fu(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);fu(e)}function vi(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function lE(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var ba=Math.random().toString(36).slice(2),er="__reactFiber$"+ba,yu="__reactProps$"+ba,Vr="__reactContainer$"+ba,rg="__reactEvents$"+ba,vD="__reactListeners$"+ba,wD="__reactHandles$"+ba;function fs(n){var e=n[er];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Vr]||t[er]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=lE(n);n!==null;){if(t=n[er])return t;n=lE(n)}return e}n=t,t=n.parentNode}return null}function ac(n){return n=n[er]||n[Vr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ko(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(j(33))}function cf(n){return n[yu]||null}var ig=[],No=-1;function $i(n){return{current:n}}function be(n){0>No||(n.current=ig[No],ig[No]=null,No--)}function Ce(n,e){No++,ig[No]=n.current,n.current=e}var Ni={},Ft=$i(Ni),ln=$i(!1),Rs=Ni;function na(n,e){var t=n.type.contextTypes;if(!t)return Ni;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function un(n){return n=n.childContextTypes,n!=null}function od(){be(ln),be(Ft)}function uE(n,e,t){if(Ft.current!==Ni)throw Error(j(168));Ce(Ft,e),Ce(ln,t)}function SC(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(j(108,ix(n)||"Unknown",i));return je({},t,r)}function ad(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ni,Rs=Ft.current,Ce(Ft,n),Ce(ln,ln.current),!0}function cE(n,e,t){var r=n.stateNode;if(!r)throw Error(j(169));t?(n=SC(n,e,Rs),r.__reactInternalMemoizedMergedChildContext=n,be(ln),be(Ft),Ce(Ft,n)):be(ln),Ce(ln,t)}var Tr=null,hf=!1,Zp=!1;function CC(n){Tr===null?Tr=[n]:Tr.push(n)}function ID(n){hf=!0,CC(n)}function Wi(){if(!Zp&&Tr!==null){Zp=!0;var n=0,e=ve;try{var t=Tr;for(ve=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Tr=null,hf=!1}catch(i){throw Tr!==null&&(Tr=Tr.slice(n+1)),YS(M_,Wi),i}finally{ve=e,Zp=!1}}return null}var bo=[],xo=0,ld=null,ud=0,Cn=[],Rn=0,As=null,Sr=1,Cr="";function rs(n,e){bo[xo++]=ud,bo[xo++]=ld,ld=n,ud=e}function RC(n,e,t){Cn[Rn++]=Sr,Cn[Rn++]=Cr,Cn[Rn++]=As,As=n;var r=Sr;n=Cr;var i=32-qn(r)-1;r&=~(1<<i),t+=1;var s=32-qn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Sr=1<<32-qn(e)+i|t<<i|r,Cr=s+n}else Sr=1<<s|t<<i|r,Cr=n}function G_(n){n.return!==null&&(rs(n,1),RC(n,1,0))}function K_(n){for(;n===ld;)ld=bo[--xo],bo[xo]=null,ud=bo[--xo],bo[xo]=null;for(;n===As;)As=Cn[--Rn],Cn[Rn]=null,Cr=Cn[--Rn],Cn[Rn]=null,Sr=Cn[--Rn],Cn[Rn]=null}var yn=null,gn=null,xe=!1,Un=null;function AC(n,e){var t=An(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function hE(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,yn=n,gn=vi(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,yn=n,gn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=As!==null?{id:Sr,overflow:Cr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=An(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,yn=n,gn=null,!0):!1;default:return!1}}function sg(n){return(n.mode&1)!==0&&(n.flags&128)===0}function og(n){if(xe){var e=gn;if(e){var t=e;if(!hE(n,e)){if(sg(n))throw Error(j(418));e=vi(t.nextSibling);var r=yn;e&&hE(n,e)?AC(r,t):(n.flags=n.flags&-4097|2,xe=!1,yn=n)}}else{if(sg(n))throw Error(j(418));n.flags=n.flags&-4097|2,xe=!1,yn=n}}}function dE(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;yn=n}function ch(n){if(n!==yn)return!1;if(!xe)return dE(n),xe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!tg(n.type,n.memoizedProps)),e&&(e=gn)){if(sg(n))throw PC(),Error(j(418));for(;e;)AC(n,e),e=vi(e.nextSibling)}if(dE(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(j(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){gn=vi(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}gn=null}}else gn=yn?vi(n.stateNode.nextSibling):null;return!0}function PC(){for(var n=gn;n;)n=vi(n.nextSibling)}function ra(){gn=yn=null,xe=!1}function H_(n){Un===null?Un=[n]:Un.push(n)}var ED=qr.ReactCurrentBatchConfig;function Mn(n,e){if(n&&n.defaultProps){e=je({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var cd=$i(null),hd=null,Do=null,Q_=null;function Y_(){Q_=Do=hd=null}function J_(n){var e=cd.current;be(cd),n._currentValue=e}function ag(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function qo(n,e){hd=n,Q_=Do=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(tn=!0),n.firstContext=null)}function bn(n){var e=n._currentValue;if(Q_!==n)if(n={context:n,memoizedValue:e,next:null},Do===null){if(hd===null)throw Error(j(308));Do=n,hd.dependencies={lanes:0,firstContext:n}}else Do=Do.next=n;return e}var ps=null;function X_(n){ps===null?ps=[n]:ps.push(n)}function kC(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,X_(e)):(t.next=i.next,i.next=t),e.interleaved=t,Lr(n,r)}function Lr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var oi=!1;function Z_(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NC(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function br(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function wi(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,pe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Lr(n,t)}return i=r.interleaved,i===null?(e.next=e,X_(r)):(e.next=i.next,i.next=e),r.interleaved=e,Lr(n,t)}function Nh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,F_(n,t)}}function fE(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function dd(n,e,t,r){var i=n.updateQueue;oi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,h=c=l=null,a=s;do{var p=a.lane,_=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=n,C=a;switch(p=e,_=t,C.tag){case 1:if(E=C.payload,typeof E=="function"){d=E.call(_,d,p);break e}d=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=C.payload,p=typeof E=="function"?E.call(_,d,p):E,p==null)break e;d=je({},d,p);break e;case 2:oi=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else _={eventTime:_,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=_,l=d):h=h.next=_,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(1);if(h===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ks|=o,n.lanes=o,n.memoizedState=d}}function pE(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(j(191,i));i.call(r)}}}var bC=new kS.Component().refs;function lg(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:je({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var df={isMounted:function(n){return(n=n._reactInternals)?Qs(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Wt(),i=Ei(n),s=br(r,i);s.payload=e,t!=null&&(s.callback=t),e=wi(n,s,i),e!==null&&($n(e,n,i,r),Nh(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Wt(),i=Ei(n),s=br(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=wi(n,s,i),e!==null&&($n(e,n,i,r),Nh(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Wt(),r=Ei(n),i=br(t,r);i.tag=2,e!=null&&(i.callback=e),e=wi(n,i,r),e!==null&&($n(e,n,r,t),Nh(e,n,r))}};function mE(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!mu(t,r)||!mu(i,s):!0}function xC(n,e,t){var r=!1,i=Ni,s=e.contextType;return typeof s=="object"&&s!==null?s=bn(s):(i=un(e)?Rs:Ft.current,r=e.contextTypes,s=(r=r!=null)?na(n,i):Ni),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=df,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function gE(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&df.enqueueReplaceState(e,e.state,null)}function ug(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=bC,Z_(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=bn(s):(s=un(e)?Rs:Ft.current,i.context=na(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(lg(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&df.enqueueReplaceState(i,i.state,null),dd(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function fl(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(j(309));var r=t.stateNode}if(!r)throw Error(j(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===bC&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(j(284));if(!t._owner)throw Error(j(290,n))}return n}function hh(n,e){throw n=Object.prototype.toString.call(e),Error(j(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function _E(n){var e=n._init;return e(n._payload)}function DC(n){function e(I,v){if(n){var w=I.deletions;w===null?(I.deletions=[v],I.flags|=16):w.push(v)}}function t(I,v){if(!n)return null;for(;v!==null;)e(I,v),v=v.sibling;return null}function r(I,v){for(I=new Map;v!==null;)v.key!==null?I.set(v.key,v):I.set(v.index,v),v=v.sibling;return I}function i(I,v){return I=Ti(I,v),I.index=0,I.sibling=null,I}function s(I,v,w){return I.index=w,n?(w=I.alternate,w!==null?(w=w.index,w<v?(I.flags|=2,v):w):(I.flags|=2,v)):(I.flags|=1048576,v)}function o(I){return n&&I.alternate===null&&(I.flags|=2),I}function a(I,v,w,D){return v===null||v.tag!==6?(v=om(w,I.mode,D),v.return=I,v):(v=i(v,w),v.return=I,v)}function l(I,v,w,D){var L=w.type;return L===Co?h(I,v,w.props.children,D,w.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===si&&_E(L)===v.type)?(D=i(v,w.props),D.ref=fl(I,v,w),D.return=I,D):(D=Lh(w.type,w.key,w.props,null,I.mode,D),D.ref=fl(I,v,w),D.return=I,D)}function c(I,v,w,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=am(w,I.mode,D),v.return=I,v):(v=i(v,w.children||[]),v.return=I,v)}function h(I,v,w,D,L){return v===null||v.tag!==7?(v=Is(w,I.mode,D,L),v.return=I,v):(v=i(v,w),v.return=I,v)}function d(I,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=om(""+v,I.mode,w),v.return=I,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case eh:return w=Lh(v.type,v.key,v.props,null,I.mode,w),w.ref=fl(I,null,v),w.return=I,w;case So:return v=am(v,I.mode,w),v.return=I,v;case si:var D=v._init;return d(I,D(v._payload),w)}if(bl(v)||ll(v))return v=Is(v,I.mode,w,null),v.return=I,v;hh(I,v)}return null}function p(I,v,w,D){var L=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return L!==null?null:a(I,v,""+w,D);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case eh:return w.key===L?l(I,v,w,D):null;case So:return w.key===L?c(I,v,w,D):null;case si:return L=w._init,p(I,v,L(w._payload),D)}if(bl(w)||ll(w))return L!==null?null:h(I,v,w,D,null);hh(I,w)}return null}function _(I,v,w,D,L){if(typeof D=="string"&&D!==""||typeof D=="number")return I=I.get(w)||null,a(v,I,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case eh:return I=I.get(D.key===null?w:D.key)||null,l(v,I,D,L);case So:return I=I.get(D.key===null?w:D.key)||null,c(v,I,D,L);case si:var M=D._init;return _(I,v,w,M(D._payload),L)}if(bl(D)||ll(D))return I=I.get(w)||null,h(v,I,D,L,null);hh(v,D)}return null}function E(I,v,w,D){for(var L=null,M=null,T=v,y=v=0,S=null;T!==null&&y<w.length;y++){T.index>y?(S=T,T=null):S=T.sibling;var R=p(I,T,w[y],D);if(R===null){T===null&&(T=S);break}n&&T&&R.alternate===null&&e(I,T),v=s(R,v,y),M===null?L=R:M.sibling=R,M=R,T=S}if(y===w.length)return t(I,T),xe&&rs(I,y),L;if(T===null){for(;y<w.length;y++)T=d(I,w[y],D),T!==null&&(v=s(T,v,y),M===null?L=T:M.sibling=T,M=T);return xe&&rs(I,y),L}for(T=r(I,T);y<w.length;y++)S=_(T,I,y,w[y],D),S!==null&&(n&&S.alternate!==null&&T.delete(S.key===null?y:S.key),v=s(S,v,y),M===null?L=S:M.sibling=S,M=S);return n&&T.forEach(function(k){return e(I,k)}),xe&&rs(I,y),L}function C(I,v,w,D){var L=ll(w);if(typeof L!="function")throw Error(j(150));if(w=L.call(w),w==null)throw Error(j(151));for(var M=L=null,T=v,y=v=0,S=null,R=w.next();T!==null&&!R.done;y++,R=w.next()){T.index>y?(S=T,T=null):S=T.sibling;var k=p(I,T,R.value,D);if(k===null){T===null&&(T=S);break}n&&T&&k.alternate===null&&e(I,T),v=s(k,v,y),M===null?L=k:M.sibling=k,M=k,T=S}if(R.done)return t(I,T),xe&&rs(I,y),L;if(T===null){for(;!R.done;y++,R=w.next())R=d(I,R.value,D),R!==null&&(v=s(R,v,y),M===null?L=R:M.sibling=R,M=R);return xe&&rs(I,y),L}for(T=r(I,T);!R.done;y++,R=w.next())R=_(T,I,y,R.value,D),R!==null&&(n&&R.alternate!==null&&T.delete(R.key===null?y:R.key),v=s(R,v,y),M===null?L=R:M.sibling=R,M=R);return n&&T.forEach(function(b){return e(I,b)}),xe&&rs(I,y),L}function P(I,v,w,D){if(typeof w=="object"&&w!==null&&w.type===Co&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case eh:e:{for(var L=w.key,M=v;M!==null;){if(M.key===L){if(L=w.type,L===Co){if(M.tag===7){t(I,M.sibling),v=i(M,w.props.children),v.return=I,I=v;break e}}else if(M.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===si&&_E(L)===M.type){t(I,M.sibling),v=i(M,w.props),v.ref=fl(I,M,w),v.return=I,I=v;break e}t(I,M);break}else e(I,M);M=M.sibling}w.type===Co?(v=Is(w.props.children,I.mode,D,w.key),v.return=I,I=v):(D=Lh(w.type,w.key,w.props,null,I.mode,D),D.ref=fl(I,v,w),D.return=I,I=D)}return o(I);case So:e:{for(M=w.key;v!==null;){if(v.key===M)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){t(I,v.sibling),v=i(v,w.children||[]),v.return=I,I=v;break e}else{t(I,v);break}else e(I,v);v=v.sibling}v=am(w,I.mode,D),v.return=I,I=v}return o(I);case si:return M=w._init,P(I,v,M(w._payload),D)}if(bl(w))return E(I,v,w,D);if(ll(w))return C(I,v,w,D);hh(I,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(t(I,v.sibling),v=i(v,w),v.return=I,I=v):(t(I,v),v=om(w,I.mode,D),v.return=I,I=v),o(I)):t(I,v)}return P}var ia=DC(!0),OC=DC(!1),lc={},ur=$i(lc),vu=$i(lc),wu=$i(lc);function ms(n){if(n===lc)throw Error(j(174));return n}function ey(n,e){switch(Ce(wu,e),Ce(vu,n),Ce(ur,lc),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:jm(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=jm(e,n)}be(ur),Ce(ur,e)}function sa(){be(ur),be(vu),be(wu)}function VC(n){ms(wu.current);var e=ms(ur.current),t=jm(e,n.type);e!==t&&(Ce(vu,n),Ce(ur,t))}function ty(n){vu.current===n&&(be(ur),be(vu))}var Fe=$i(0);function fd(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var em=[];function ny(){for(var n=0;n<em.length;n++)em[n]._workInProgressVersionPrimary=null;em.length=0}var bh=qr.ReactCurrentDispatcher,tm=qr.ReactCurrentBatchConfig,Ps=0,Ue=null,at=null,pt=null,pd=!1,Wl=!1,Iu=0,TD=0;function xt(){throw Error(j(321))}function ry(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Gn(n[t],e[t]))return!1;return!0}function iy(n,e,t,r,i,s){if(Ps=s,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bh.current=n===null||n.memoizedState===null?AD:PD,n=t(r,i),Wl){s=0;do{if(Wl=!1,Iu=0,25<=s)throw Error(j(301));s+=1,pt=at=null,e.updateQueue=null,bh.current=kD,n=t(r,i)}while(Wl)}if(bh.current=md,e=at!==null&&at.next!==null,Ps=0,pt=at=Ue=null,pd=!1,e)throw Error(j(300));return n}function sy(){var n=Iu!==0;return Iu=0,n}function Zn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Ue.memoizedState=pt=n:pt=pt.next=n,pt}function xn(){if(at===null){var n=Ue.alternate;n=n!==null?n.memoizedState:null}else n=at.next;var e=pt===null?Ue.memoizedState:pt.next;if(e!==null)pt=e,at=n;else{if(n===null)throw Error(j(310));at=n,n={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},pt===null?Ue.memoizedState=pt=n:pt=pt.next=n}return pt}function Eu(n,e){return typeof e=="function"?e(n):e}function nm(n){var e=xn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var r=at,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((Ps&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,Ue.lanes|=h,ks|=h}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Gn(r,e.memoizedState)||(tn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Ue.lanes|=s,ks|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function rm(n){var e=xn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Gn(s,e.memoizedState)||(tn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function LC(){}function MC(n,e){var t=Ue,r=xn(),i=e(),s=!Gn(r.memoizedState,i);if(s&&(r.memoizedState=i,tn=!0),r=r.queue,oy(BC.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||pt!==null&&pt.memoizedState.tag&1){if(t.flags|=2048,Tu(9,UC.bind(null,t,r,i,e),void 0,null),yt===null)throw Error(j(349));Ps&30||FC(t,e,i)}return i}function FC(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function UC(n,e,t,r){e.value=t,e.getSnapshot=r,jC(e)&&zC(n)}function BC(n,e,t){return t(function(){jC(e)&&zC(n)})}function jC(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Gn(n,t)}catch{return!0}}function zC(n){var e=Lr(n,1);e!==null&&$n(e,n,1,-1)}function yE(n){var e=Zn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eu,lastRenderedState:n},e.queue=n,n=n.dispatch=RD.bind(null,Ue,n),[e.memoizedState,n]}function Tu(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function qC(){return xn().memoizedState}function xh(n,e,t,r){var i=Zn();Ue.flags|=n,i.memoizedState=Tu(1|e,t,void 0,r===void 0?null:r)}function ff(n,e,t,r){var i=xn();r=r===void 0?null:r;var s=void 0;if(at!==null){var o=at.memoizedState;if(s=o.destroy,r!==null&&ry(r,o.deps)){i.memoizedState=Tu(e,t,s,r);return}}Ue.flags|=n,i.memoizedState=Tu(1|e,t,s,r)}function vE(n,e){return xh(8390656,8,n,e)}function oy(n,e){return ff(2048,8,n,e)}function $C(n,e){return ff(4,2,n,e)}function WC(n,e){return ff(4,4,n,e)}function GC(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function KC(n,e,t){return t=t!=null?t.concat([n]):null,ff(4,4,GC.bind(null,e,n),t)}function ay(){}function HC(n,e){var t=xn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ry(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function QC(n,e){var t=xn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ry(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function YC(n,e,t){return Ps&21?(Gn(t,e)||(t=ZS(),Ue.lanes|=t,ks|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,tn=!0),n.memoizedState=t)}function SD(n,e){var t=ve;ve=t!==0&&4>t?t:4,n(!0);var r=tm.transition;tm.transition={};try{n(!1),e()}finally{ve=t,tm.transition=r}}function JC(){return xn().memoizedState}function CD(n,e,t){var r=Ei(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},XC(n))ZC(e,t);else if(t=kC(n,e,t,r),t!==null){var i=Wt();$n(t,n,r,i),eR(t,e,r)}}function RD(n,e,t){var r=Ei(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(XC(n))ZC(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,Gn(a,o)){var l=e.interleaved;l===null?(i.next=i,X_(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=kC(n,e,i,r),t!==null&&(i=Wt(),$n(t,n,r,i),eR(t,e,r))}}function XC(n){var e=n.alternate;return n===Ue||e!==null&&e===Ue}function ZC(n,e){Wl=pd=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function eR(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,F_(n,t)}}var md={readContext:bn,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useInsertionEffect:xt,useLayoutEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useMutableSource:xt,useSyncExternalStore:xt,useId:xt,unstable_isNewReconciler:!1},AD={readContext:bn,useCallback:function(n,e){return Zn().memoizedState=[n,e===void 0?null:e],n},useContext:bn,useEffect:vE,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,xh(4194308,4,GC.bind(null,e,n),t)},useLayoutEffect:function(n,e){return xh(4194308,4,n,e)},useInsertionEffect:function(n,e){return xh(4,2,n,e)},useMemo:function(n,e){var t=Zn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Zn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=CD.bind(null,Ue,n),[r.memoizedState,n]},useRef:function(n){var e=Zn();return n={current:n},e.memoizedState=n},useState:yE,useDebugValue:ay,useDeferredValue:function(n){return Zn().memoizedState=n},useTransition:function(){var n=yE(!1),e=n[0];return n=SD.bind(null,n[1]),Zn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Ue,i=Zn();if(xe){if(t===void 0)throw Error(j(407));t=t()}else{if(t=e(),yt===null)throw Error(j(349));Ps&30||FC(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,vE(BC.bind(null,r,s,n),[n]),r.flags|=2048,Tu(9,UC.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Zn(),e=yt.identifierPrefix;if(xe){var t=Cr,r=Sr;t=(r&~(1<<32-qn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Iu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=TD++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},PD={readContext:bn,useCallback:HC,useContext:bn,useEffect:oy,useImperativeHandle:KC,useInsertionEffect:$C,useLayoutEffect:WC,useMemo:QC,useReducer:nm,useRef:qC,useState:function(){return nm(Eu)},useDebugValue:ay,useDeferredValue:function(n){var e=xn();return YC(e,at.memoizedState,n)},useTransition:function(){var n=nm(Eu)[0],e=xn().memoizedState;return[n,e]},useMutableSource:LC,useSyncExternalStore:MC,useId:JC,unstable_isNewReconciler:!1},kD={readContext:bn,useCallback:HC,useContext:bn,useEffect:oy,useImperativeHandle:KC,useInsertionEffect:$C,useLayoutEffect:WC,useMemo:QC,useReducer:rm,useRef:qC,useState:function(){return rm(Eu)},useDebugValue:ay,useDeferredValue:function(n){var e=xn();return at===null?e.memoizedState=n:YC(e,at.memoizedState,n)},useTransition:function(){var n=rm(Eu)[0],e=xn().memoizedState;return[n,e]},useMutableSource:LC,useSyncExternalStore:MC,useId:JC,unstable_isNewReconciler:!1};function oa(n,e){try{var t="",r=e;do t+=rx(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function im(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function cg(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var ND=typeof WeakMap=="function"?WeakMap:Map;function tR(n,e,t){t=br(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){_d||(_d=!0,wg=r),cg(n,e)},t}function nR(n,e,t){t=br(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){cg(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){cg(n,e),typeof r!="function"&&(Ii===null?Ii=new Set([this]):Ii.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function wE(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new ND;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=$D.bind(null,n,e,t),e.then(n,n))}function IE(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function EE(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=br(-1,1),e.tag=2,wi(t,e,1))),t.lanes|=1),n)}var bD=qr.ReactCurrentOwner,tn=!1;function zt(n,e,t,r){e.child=n===null?OC(e,null,t,r):ia(e,n.child,t,r)}function TE(n,e,t,r,i){t=t.render;var s=e.ref;return qo(e,i),r=iy(n,e,t,r,s,i),t=sy(),n!==null&&!tn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Mr(n,e,i)):(xe&&t&&G_(e),e.flags|=1,zt(n,e,r,i),e.child)}function SE(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!my(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,rR(n,e,s,r,i)):(n=Lh(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:mu,t(o,r)&&n.ref===e.ref)return Mr(n,e,i)}return e.flags|=1,n=Ti(s,r),n.ref=e.ref,n.return=e,e.child=n}function rR(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(mu(s,r)&&n.ref===e.ref)if(tn=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(tn=!0);else return e.lanes=n.lanes,Mr(n,e,i)}return hg(n,e,t,r,i)}function iR(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(Vo,pn),pn|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ce(Vo,pn),pn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Ce(Vo,pn),pn|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Ce(Vo,pn),pn|=r;return zt(n,e,i,t),e.child}function sR(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function hg(n,e,t,r,i){var s=un(t)?Rs:Ft.current;return s=na(e,s),qo(e,i),t=iy(n,e,t,r,s,i),r=sy(),n!==null&&!tn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Mr(n,e,i)):(xe&&r&&G_(e),e.flags|=1,zt(n,e,t,i),e.child)}function CE(n,e,t,r,i){if(un(t)){var s=!0;ad(e)}else s=!1;if(qo(e,i),e.stateNode===null)Dh(n,e),xC(e,t,r),ug(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=bn(c):(c=un(t)?Rs:Ft.current,c=na(e,c));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&gE(e,o,r,c),oi=!1;var p=e.memoizedState;o.state=p,dd(e,r,o,i),l=e.memoizedState,a!==r||p!==l||ln.current||oi?(typeof h=="function"&&(lg(e,t,h,r),l=e.memoizedState),(a=oi||mE(e,t,a,r,p,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,NC(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Mn(e.type,a),o.props=c,d=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=bn(l):(l=un(t)?Rs:Ft.current,l=na(e,l));var _=t.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||p!==l)&&gE(e,o,r,l),oi=!1,p=e.memoizedState,o.state=p,dd(e,r,o,i);var E=e.memoizedState;a!==d||p!==E||ln.current||oi?(typeof _=="function"&&(lg(e,t,_,r),E=e.memoizedState),(c=oi||mE(e,t,c,r,p,E,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),r=!1)}return dg(n,e,t,r,s,i)}function dg(n,e,t,r,i,s){sR(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&cE(e,t,!1),Mr(n,e,s);r=e.stateNode,bD.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=ia(e,n.child,null,s),e.child=ia(e,null,a,s)):zt(n,e,a,s),e.memoizedState=r.state,i&&cE(e,t,!0),e.child}function oR(n){var e=n.stateNode;e.pendingContext?uE(n,e.pendingContext,e.pendingContext!==e.context):e.context&&uE(n,e.context,!1),ey(n,e.containerInfo)}function RE(n,e,t,r,i){return ra(),H_(i),e.flags|=256,zt(n,e,t,r),e.child}var fg={dehydrated:null,treeContext:null,retryLane:0};function pg(n){return{baseLanes:n,cachePool:null,transitions:null}}function aR(n,e,t){var r=e.pendingProps,i=Fe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ce(Fe,i&1),n===null)return og(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gf(o,r,0,null),n=Is(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=pg(t),e.memoizedState=fg,n):ly(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return xD(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ti(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ti(a,s):(s=Is(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?pg(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=fg,r}return s=n.child,n=s.sibling,r=Ti(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function ly(n,e){return e=gf({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function dh(n,e,t,r){return r!==null&&H_(r),ia(e,n.child,null,t),n=ly(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function xD(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=im(Error(j(422))),dh(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=gf({mode:"visible",children:r.children},i,0,null),s=Is(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ia(e,n.child,null,o),e.child.memoizedState=pg(o),e.memoizedState=fg,s);if(!(e.mode&1))return dh(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(j(419)),r=im(s,r,void 0),dh(n,e,o,r)}if(a=(o&n.childLanes)!==0,tn||a){if(r=yt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Lr(n,i),$n(r,n,i,-1))}return py(),r=im(Error(j(421))),dh(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=WD.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,gn=vi(i.nextSibling),yn=e,xe=!0,Un=null,n!==null&&(Cn[Rn++]=Sr,Cn[Rn++]=Cr,Cn[Rn++]=As,Sr=n.id,Cr=n.overflow,As=e),e=ly(e,r.children),e.flags|=4096,e)}function AE(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),ag(n.return,e,t)}function sm(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function lR(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(zt(n,e,r.children,t),r=Fe.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&AE(n,t,e);else if(n.tag===19)AE(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Ce(Fe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&fd(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),sm(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&fd(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}sm(e,!0,t,null,s);break;case"together":sm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Dh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Mr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ks|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(j(153));if(e.child!==null){for(n=e.child,t=Ti(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Ti(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function DD(n,e,t){switch(e.tag){case 3:oR(e),ra();break;case 5:VC(e);break;case 1:un(e.type)&&ad(e);break;case 4:ey(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ce(cd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ce(Fe,Fe.current&1),e.flags|=128,null):t&e.child.childLanes?aR(n,e,t):(Ce(Fe,Fe.current&1),n=Mr(n,e,t),n!==null?n.sibling:null);Ce(Fe,Fe.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return lR(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ce(Fe,Fe.current),r)break;return null;case 22:case 23:return e.lanes=0,iR(n,e,t)}return Mr(n,e,t)}var uR,mg,cR,hR;uR=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};mg=function(){};cR=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,ms(ur.current);var s=null;switch(t){case"input":i=Mm(n,i),r=Mm(n,r),s=[];break;case"select":i=je({},i,{value:void 0}),r=je({},r,{value:void 0}),s=[];break;case"textarea":i=Bm(n,i),r=Bm(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=sd)}zm(t,r);var o;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(lu.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(lu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Pe("scroll",n),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};hR=function(n,e,t,r){t!==r&&(e.flags|=4)};function pl(n,e){if(!xe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Dt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function OD(n,e,t){var r=e.pendingProps;switch(K_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(e),null;case 1:return un(e.type)&&od(),Dt(e),null;case 3:return r=e.stateNode,sa(),be(ln),be(Ft),ny(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(ch(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Un!==null&&(Tg(Un),Un=null))),mg(n,e),Dt(e),null;case 5:ty(e);var i=ms(wu.current);if(t=e.type,n!==null&&e.stateNode!=null)cR(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(j(166));return Dt(e),null}if(n=ms(ur.current),ch(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[er]=e,r[yu]=s,n=(e.mode&1)!==0,t){case"dialog":Pe("cancel",r),Pe("close",r);break;case"iframe":case"object":case"embed":Pe("load",r);break;case"video":case"audio":for(i=0;i<Dl.length;i++)Pe(Dl[i],r);break;case"source":Pe("error",r);break;case"img":case"image":case"link":Pe("error",r),Pe("load",r);break;case"details":Pe("toggle",r);break;case"input":LI(r,s),Pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Pe("invalid",r);break;case"textarea":FI(r,s),Pe("invalid",r)}zm(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&uh(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&uh(r.textContent,a,n),i=["children",""+a]):lu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Pe("scroll",r)}switch(t){case"input":th(r),MI(r,s,!0);break;case"textarea":th(r),UI(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=sd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=FS(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[er]=e,n[yu]=r,uR(n,e,!1,!1),e.stateNode=n;e:{switch(o=qm(t,r),t){case"dialog":Pe("cancel",n),Pe("close",n),i=r;break;case"iframe":case"object":case"embed":Pe("load",n),i=r;break;case"video":case"audio":for(i=0;i<Dl.length;i++)Pe(Dl[i],n);i=r;break;case"source":Pe("error",n),i=r;break;case"img":case"image":case"link":Pe("error",n),Pe("load",n),i=r;break;case"details":Pe("toggle",n),i=r;break;case"input":LI(n,r),i=Mm(n,r),Pe("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=je({},r,{value:void 0}),Pe("invalid",n);break;case"textarea":FI(n,r),i=Bm(n,r),Pe("invalid",n);break;default:i=r}zm(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?jS(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&US(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&uu(n,l):typeof l=="number"&&uu(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Pe("scroll",n):l!=null&&x_(n,s,l,o))}switch(t){case"input":th(n),MI(n,r,!1);break;case"textarea":th(n),UI(n);break;case"option":r.value!=null&&n.setAttribute("value",""+ki(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Uo(n,!!r.multiple,s,!1):r.defaultValue!=null&&Uo(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=sd)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Dt(e),null;case 6:if(n&&e.stateNode!=null)hR(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(j(166));if(t=ms(wu.current),ms(ur.current),ch(e)){if(r=e.stateNode,t=e.memoizedProps,r[er]=e,(s=r.nodeValue!==t)&&(n=yn,n!==null))switch(n.tag){case 3:uh(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&uh(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[er]=e,e.stateNode=r}return Dt(e),null;case 13:if(be(Fe),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(xe&&gn!==null&&e.mode&1&&!(e.flags&128))PC(),ra(),e.flags|=98560,s=!1;else if(s=ch(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(j(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(j(317));s[er]=e}else ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Dt(e),s=!1}else Un!==null&&(Tg(Un),Un=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Fe.current&1?ut===0&&(ut=3):py())),e.updateQueue!==null&&(e.flags|=4),Dt(e),null);case 4:return sa(),mg(n,e),n===null&&gu(e.stateNode.containerInfo),Dt(e),null;case 10:return J_(e.type._context),Dt(e),null;case 17:return un(e.type)&&od(),Dt(e),null;case 19:if(be(Fe),s=e.memoizedState,s===null)return Dt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)pl(s,!1);else{if(ut!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=fd(n),o!==null){for(e.flags|=128,pl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ce(Fe,Fe.current&1|2),e.child}n=n.sibling}s.tail!==null&&Ze()>aa&&(e.flags|=128,r=!0,pl(s,!1),e.lanes=4194304)}else{if(!r)if(n=fd(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),pl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!xe)return Dt(e),null}else 2*Ze()-s.renderingStartTime>aa&&t!==1073741824&&(e.flags|=128,r=!0,pl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ze(),e.sibling=null,t=Fe.current,Ce(Fe,r?t&1|2:t&1),e):(Dt(e),null);case 22:case 23:return fy(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?pn&1073741824&&(Dt(e),e.subtreeFlags&6&&(e.flags|=8192)):Dt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function VD(n,e){switch(K_(e),e.tag){case 1:return un(e.type)&&od(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return sa(),be(ln),be(Ft),ny(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return ty(e),null;case 13:if(be(Fe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(j(340));ra()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return be(Fe),null;case 4:return sa(),null;case 10:return J_(e.type._context),null;case 22:case 23:return fy(),null;case 24:return null;default:return null}}var fh=!1,Vt=!1,LD=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Oo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){$e(n,e,r)}else t.current=null}function gg(n,e,t){try{t()}catch(r){$e(n,e,r)}}var PE=!1;function MD(n,e){if(Zm=nd,n=mC(),W_(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,h=0,d=n,p=null;t:for(;;){for(var _;d!==t||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(_=d.firstChild)!==null;)p=d,d=_;for(;;){if(d===n)break t;if(p===t&&++c===i&&(a=o),p===s&&++h===r&&(l=o),(_=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=_}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(eg={focusedElem:n,selectionRange:t},nd=!1,Y=e;Y!==null;)if(e=Y,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Y=n;else for(;Y!==null;){e=Y;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var C=E.memoizedProps,P=E.memoizedState,I=e.stateNode,v=I.getSnapshotBeforeUpdate(e.elementType===e.type?C:Mn(e.type,C),P);I.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(D){$e(e,e.return,D)}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}return E=PE,PE=!1,E}function Gl(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&gg(e,t,s)}i=i.next}while(i!==r)}}function pf(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function _g(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function dR(n){var e=n.alternate;e!==null&&(n.alternate=null,dR(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[er],delete e[yu],delete e[rg],delete e[vD],delete e[wD])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function fR(n){return n.tag===5||n.tag===3||n.tag===4}function kE(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||fR(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function yg(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=sd));else if(r!==4&&(n=n.child,n!==null))for(yg(n,e,t),n=n.sibling;n!==null;)yg(n,e,t),n=n.sibling}function vg(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(vg(n,e,t),n=n.sibling;n!==null;)vg(n,e,t),n=n.sibling}var St=null,Fn=!1;function ei(n,e,t){for(t=t.child;t!==null;)pR(n,e,t),t=t.sibling}function pR(n,e,t){if(lr&&typeof lr.onCommitFiberUnmount=="function")try{lr.onCommitFiberUnmount(of,t)}catch{}switch(t.tag){case 5:Vt||Oo(t,e);case 6:var r=St,i=Fn;St=null,ei(n,e,t),St=r,Fn=i,St!==null&&(Fn?(n=St,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):St.removeChild(t.stateNode));break;case 18:St!==null&&(Fn?(n=St,t=t.stateNode,n.nodeType===8?Xp(n.parentNode,t):n.nodeType===1&&Xp(n,t),fu(n)):Xp(St,t.stateNode));break;case 4:r=St,i=Fn,St=t.stateNode.containerInfo,Fn=!0,ei(n,e,t),St=r,Fn=i;break;case 0:case 11:case 14:case 15:if(!Vt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&gg(t,e,o),i=i.next}while(i!==r)}ei(n,e,t);break;case 1:if(!Vt&&(Oo(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){$e(t,e,a)}ei(n,e,t);break;case 21:ei(n,e,t);break;case 22:t.mode&1?(Vt=(r=Vt)||t.memoizedState!==null,ei(n,e,t),Vt=r):ei(n,e,t);break;default:ei(n,e,t)}}function NE(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new LD),e.forEach(function(r){var i=GD.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Vn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:St=a.stateNode,Fn=!1;break e;case 3:St=a.stateNode.containerInfo,Fn=!0;break e;case 4:St=a.stateNode.containerInfo,Fn=!0;break e}a=a.return}if(St===null)throw Error(j(160));pR(s,o,i),St=null,Fn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){$e(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mR(e,n),e=e.sibling}function mR(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Vn(e,n),Xn(n),r&4){try{Gl(3,n,n.return),pf(3,n)}catch(C){$e(n,n.return,C)}try{Gl(5,n,n.return)}catch(C){$e(n,n.return,C)}}break;case 1:Vn(e,n),Xn(n),r&512&&t!==null&&Oo(t,t.return);break;case 5:if(Vn(e,n),Xn(n),r&512&&t!==null&&Oo(t,t.return),n.flags&32){var i=n.stateNode;try{uu(i,"")}catch(C){$e(n,n.return,C)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&LS(i,s),qm(a,o);var c=qm(a,s);for(o=0;o<l.length;o+=2){var h=l[o],d=l[o+1];h==="style"?jS(i,d):h==="dangerouslySetInnerHTML"?US(i,d):h==="children"?uu(i,d):x_(i,h,d,c)}switch(a){case"input":Fm(i,s);break;case"textarea":MS(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var _=s.value;_!=null?Uo(i,!!s.multiple,_,!1):p!==!!s.multiple&&(s.defaultValue!=null?Uo(i,!!s.multiple,s.defaultValue,!0):Uo(i,!!s.multiple,s.multiple?[]:"",!1))}i[yu]=s}catch(C){$e(n,n.return,C)}}break;case 6:if(Vn(e,n),Xn(n),r&4){if(n.stateNode===null)throw Error(j(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(C){$e(n,n.return,C)}}break;case 3:if(Vn(e,n),Xn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{fu(e.containerInfo)}catch(C){$e(n,n.return,C)}break;case 4:Vn(e,n),Xn(n);break;case 13:Vn(e,n),Xn(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(hy=Ze())),r&4&&NE(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Vt=(c=Vt)||h,Vn(e,n),Vt=c):Vn(e,n),Xn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!h&&n.mode&1)for(Y=n,h=n.child;h!==null;){for(d=Y=h;Y!==null;){switch(p=Y,_=p.child,p.tag){case 0:case 11:case 14:case 15:Gl(4,p,p.return);break;case 1:Oo(p,p.return);var E=p.stateNode;if(typeof E.componentWillUnmount=="function"){r=p,t=p.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(C){$e(r,t,C)}}break;case 5:Oo(p,p.return);break;case 22:if(p.memoizedState!==null){xE(d);continue}}_!==null?(_.return=p,Y=_):xE(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=BS("display",o))}catch(C){$e(n,n.return,C)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(C){$e(n,n.return,C)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Vn(e,n),Xn(n),r&4&&NE(n);break;case 21:break;default:Vn(e,n),Xn(n)}}function Xn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(fR(t)){var r=t;break e}t=t.return}throw Error(j(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(uu(i,""),r.flags&=-33);var s=kE(n);vg(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=kE(n);yg(n,a,o);break;default:throw Error(j(161))}}catch(l){$e(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function FD(n,e,t){Y=n,gR(n)}function gR(n,e,t){for(var r=(n.mode&1)!==0;Y!==null;){var i=Y,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||fh;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Vt;a=fh;var c=Vt;if(fh=o,(Vt=l)&&!c)for(Y=i;Y!==null;)o=Y,l=o.child,o.tag===22&&o.memoizedState!==null?DE(i):l!==null?(l.return=o,Y=l):DE(i);for(;s!==null;)Y=s,gR(s),s=s.sibling;Y=i,fh=a,Vt=c}bE(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Y=s):bE(n)}}function bE(n){for(;Y!==null;){var e=Y;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vt||pf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Vt)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Mn(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&pE(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}pE(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&fu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}Vt||e.flags&512&&_g(e)}catch(p){$e(e,e.return,p)}}if(e===n){Y=null;break}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}}function xE(n){for(;Y!==null;){var e=Y;if(e===n){Y=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Y=t;break}Y=e.return}}function DE(n){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{pf(4,e)}catch(l){$e(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){$e(e,i,l)}}var s=e.return;try{_g(e)}catch(l){$e(e,s,l)}break;case 5:var o=e.return;try{_g(e)}catch(l){$e(e,o,l)}}}catch(l){$e(e,e.return,l)}if(e===n){Y=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Y=a;break}Y=e.return}}var UD=Math.ceil,gd=qr.ReactCurrentDispatcher,uy=qr.ReactCurrentOwner,kn=qr.ReactCurrentBatchConfig,pe=0,yt=null,st=null,Rt=0,pn=0,Vo=$i(0),ut=0,Su=null,ks=0,mf=0,cy=0,Kl=null,en=null,hy=0,aa=1/0,Er=null,_d=!1,wg=null,Ii=null,ph=!1,di=null,yd=0,Hl=0,Ig=null,Oh=-1,Vh=0;function Wt(){return pe&6?Ze():Oh!==-1?Oh:Oh=Ze()}function Ei(n){return n.mode&1?pe&2&&Rt!==0?Rt&-Rt:ED.transition!==null?(Vh===0&&(Vh=ZS()),Vh):(n=ve,n!==0||(n=window.event,n=n===void 0?16:oC(n.type)),n):1}function $n(n,e,t,r){if(50<Hl)throw Hl=0,Ig=null,Error(j(185));sc(n,t,r),(!(pe&2)||n!==yt)&&(n===yt&&(!(pe&2)&&(mf|=t),ut===4&&li(n,Rt)),cn(n,r),t===1&&pe===0&&!(e.mode&1)&&(aa=Ze()+500,hf&&Wi()))}function cn(n,e){var t=n.callbackNode;Ex(n,e);var r=td(n,n===yt?Rt:0);if(r===0)t!==null&&zI(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&zI(t),e===1)n.tag===0?ID(OE.bind(null,n)):CC(OE.bind(null,n)),_D(function(){!(pe&6)&&Wi()}),t=null;else{switch(eC(r)){case 1:t=M_;break;case 4:t=JS;break;case 16:t=ed;break;case 536870912:t=XS;break;default:t=ed}t=SR(t,_R.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function _R(n,e){if(Oh=-1,Vh=0,pe&6)throw Error(j(327));var t=n.callbackNode;if($o()&&n.callbackNode!==t)return null;var r=td(n,n===yt?Rt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=vd(n,r);else{e=r;var i=pe;pe|=2;var s=vR();(yt!==n||Rt!==e)&&(Er=null,aa=Ze()+500,ws(n,e));do try{zD();break}catch(a){yR(n,a)}while(1);Y_(),gd.current=s,pe=i,st!==null?e=0:(yt=null,Rt=0,e=ut)}if(e!==0){if(e===2&&(i=Hm(n),i!==0&&(r=i,e=Eg(n,i))),e===1)throw t=Su,ws(n,0),li(n,r),cn(n,Ze()),t;if(e===6)li(n,r);else{if(i=n.current.alternate,!(r&30)&&!BD(i)&&(e=vd(n,r),e===2&&(s=Hm(n),s!==0&&(r=s,e=Eg(n,s))),e===1))throw t=Su,ws(n,0),li(n,r),cn(n,Ze()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(j(345));case 2:is(n,en,Er);break;case 3:if(li(n,r),(r&130023424)===r&&(e=hy+500-Ze(),10<e)){if(td(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Wt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=ng(is.bind(null,n,en,Er),e);break}is(n,en,Er);break;case 4:if(li(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-qn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*UD(r/1960))-r,10<r){n.timeoutHandle=ng(is.bind(null,n,en,Er),r);break}is(n,en,Er);break;case 5:is(n,en,Er);break;default:throw Error(j(329))}}}return cn(n,Ze()),n.callbackNode===t?_R.bind(null,n):null}function Eg(n,e){var t=Kl;return n.current.memoizedState.isDehydrated&&(ws(n,e).flags|=256),n=vd(n,e),n!==2&&(e=en,en=t,e!==null&&Tg(e)),n}function Tg(n){en===null?en=n:en.push.apply(en,n)}function BD(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Gn(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function li(n,e){for(e&=~cy,e&=~mf,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-qn(e),r=1<<t;n[t]=-1,e&=~r}}function OE(n){if(pe&6)throw Error(j(327));$o();var e=td(n,0);if(!(e&1))return cn(n,Ze()),null;var t=vd(n,e);if(n.tag!==0&&t===2){var r=Hm(n);r!==0&&(e=r,t=Eg(n,r))}if(t===1)throw t=Su,ws(n,0),li(n,e),cn(n,Ze()),t;if(t===6)throw Error(j(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,is(n,en,Er),cn(n,Ze()),null}function dy(n,e){var t=pe;pe|=1;try{return n(e)}finally{pe=t,pe===0&&(aa=Ze()+500,hf&&Wi())}}function Ns(n){di!==null&&di.tag===0&&!(pe&6)&&$o();var e=pe;pe|=1;var t=kn.transition,r=ve;try{if(kn.transition=null,ve=1,n)return n()}finally{ve=r,kn.transition=t,pe=e,!(pe&6)&&Wi()}}function fy(){pn=Vo.current,be(Vo)}function ws(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,gD(t)),st!==null)for(t=st.return;t!==null;){var r=t;switch(K_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&od();break;case 3:sa(),be(ln),be(Ft),ny();break;case 5:ty(r);break;case 4:sa();break;case 13:be(Fe);break;case 19:be(Fe);break;case 10:J_(r.type._context);break;case 22:case 23:fy()}t=t.return}if(yt=n,st=n=Ti(n.current,null),Rt=pn=e,ut=0,Su=null,cy=mf=ks=0,en=Kl=null,ps!==null){for(e=0;e<ps.length;e++)if(t=ps[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}ps=null}return n}function yR(n,e){do{var t=st;try{if(Y_(),bh.current=md,pd){for(var r=Ue.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}pd=!1}if(Ps=0,pt=at=Ue=null,Wl=!1,Iu=0,uy.current=null,t===null||t.return===null){ut=1,Su=e,st=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=Rt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=IE(o);if(_!==null){_.flags&=-257,EE(_,o,a,s,e),_.mode&1&&wE(s,c,e),e=_,l=c;var E=e.updateQueue;if(E===null){var C=new Set;C.add(l),e.updateQueue=C}else E.add(l);break e}else{if(!(e&1)){wE(s,c,e),py();break e}l=Error(j(426))}}else if(xe&&a.mode&1){var P=IE(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),EE(P,o,a,s,e),H_(oa(l,a));break e}}s=l=oa(l,a),ut!==4&&(ut=2),Kl===null?Kl=[s]:Kl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var I=tR(s,l,e);fE(s,I);break e;case 1:a=l;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ii===null||!Ii.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var D=nR(s,a,e);fE(s,D);break e}}s=s.return}while(s!==null)}IR(t)}catch(L){e=L,st===t&&t!==null&&(st=t=t.return);continue}break}while(1)}function vR(){var n=gd.current;return gd.current=md,n===null?md:n}function py(){(ut===0||ut===3||ut===2)&&(ut=4),yt===null||!(ks&268435455)&&!(mf&268435455)||li(yt,Rt)}function vd(n,e){var t=pe;pe|=2;var r=vR();(yt!==n||Rt!==e)&&(Er=null,ws(n,e));do try{jD();break}catch(i){yR(n,i)}while(1);if(Y_(),pe=t,gd.current=r,st!==null)throw Error(j(261));return yt=null,Rt=0,ut}function jD(){for(;st!==null;)wR(st)}function zD(){for(;st!==null&&!fx();)wR(st)}function wR(n){var e=TR(n.alternate,n,pn);n.memoizedProps=n.pendingProps,e===null?IR(n):st=e,uy.current=null}function IR(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=VD(t,e),t!==null){t.flags&=32767,st=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ut=6,st=null;return}}else if(t=OD(t,e,pn),t!==null){st=t;return}if(e=e.sibling,e!==null){st=e;return}st=e=n}while(e!==null);ut===0&&(ut=5)}function is(n,e,t){var r=ve,i=kn.transition;try{kn.transition=null,ve=1,qD(n,e,t,r)}finally{kn.transition=i,ve=r}return null}function qD(n,e,t,r){do $o();while(di!==null);if(pe&6)throw Error(j(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(j(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(Tx(n,s),n===yt&&(st=yt=null,Rt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ph||(ph=!0,SR(ed,function(){return $o(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=kn.transition,kn.transition=null;var o=ve;ve=1;var a=pe;pe|=4,uy.current=null,MD(n,t),mR(t,n),uD(eg),nd=!!Zm,eg=Zm=null,n.current=t,FD(t),px(),pe=a,ve=o,kn.transition=s}else n.current=t;if(ph&&(ph=!1,di=n,yd=i),s=n.pendingLanes,s===0&&(Ii=null),_x(t.stateNode),cn(n,Ze()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(_d)throw _d=!1,n=wg,wg=null,n;return yd&1&&n.tag!==0&&$o(),s=n.pendingLanes,s&1?n===Ig?Hl++:(Hl=0,Ig=n):Hl=0,Wi(),null}function $o(){if(di!==null){var n=eC(yd),e=kn.transition,t=ve;try{if(kn.transition=null,ve=16>n?16:n,di===null)var r=!1;else{if(n=di,di=null,yd=0,pe&6)throw Error(j(331));var i=pe;for(pe|=4,Y=n.current;Y!==null;){var s=Y,o=s.child;if(Y.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Y=c;Y!==null;){var h=Y;switch(h.tag){case 0:case 11:case 15:Gl(8,h,s)}var d=h.child;if(d!==null)d.return=h,Y=d;else for(;Y!==null;){h=Y;var p=h.sibling,_=h.return;if(dR(h),h===c){Y=null;break}if(p!==null){p.return=_,Y=p;break}Y=_}}}var E=s.alternate;if(E!==null){var C=E.child;if(C!==null){E.child=null;do{var P=C.sibling;C.sibling=null,C=P}while(C!==null)}}Y=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Y=o;else e:for(;Y!==null;){if(s=Y,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gl(9,s,s.return)}var I=s.sibling;if(I!==null){I.return=s.return,Y=I;break e}Y=s.return}}var v=n.current;for(Y=v;Y!==null;){o=Y;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Y=w;else e:for(o=v;Y!==null;){if(a=Y,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:pf(9,a)}}catch(L){$e(a,a.return,L)}if(a===o){Y=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,Y=D;break e}Y=a.return}}if(pe=i,Wi(),lr&&typeof lr.onPostCommitFiberRoot=="function")try{lr.onPostCommitFiberRoot(of,n)}catch{}r=!0}return r}finally{ve=t,kn.transition=e}}return!1}function VE(n,e,t){e=oa(t,e),e=tR(n,e,1),n=wi(n,e,1),e=Wt(),n!==null&&(sc(n,1,e),cn(n,e))}function $e(n,e,t){if(n.tag===3)VE(n,n,t);else for(;e!==null;){if(e.tag===3){VE(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ii===null||!Ii.has(r))){n=oa(t,n),n=nR(e,n,1),e=wi(e,n,1),n=Wt(),e!==null&&(sc(e,1,n),cn(e,n));break}}e=e.return}}function $D(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Wt(),n.pingedLanes|=n.suspendedLanes&t,yt===n&&(Rt&t)===t&&(ut===4||ut===3&&(Rt&130023424)===Rt&&500>Ze()-hy?ws(n,0):cy|=t),cn(n,e)}function ER(n,e){e===0&&(n.mode&1?(e=ih,ih<<=1,!(ih&130023424)&&(ih=4194304)):e=1);var t=Wt();n=Lr(n,e),n!==null&&(sc(n,e,t),cn(n,t))}function WD(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),ER(n,t)}function GD(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(j(314))}r!==null&&r.delete(e),ER(n,t)}var TR;TR=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ln.current)tn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return tn=!1,DD(n,e,t);tn=!!(n.flags&131072)}else tn=!1,xe&&e.flags&1048576&&RC(e,ud,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Dh(n,e),n=e.pendingProps;var i=na(e,Ft.current);qo(e,t),i=iy(null,e,r,n,i,t);var s=sy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(r)?(s=!0,ad(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Z_(e),i.updater=df,e.stateNode=i,i._reactInternals=e,ug(e,r,n,t),e=dg(null,e,r,!0,s,t)):(e.tag=0,xe&&s&&G_(e),zt(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Dh(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=HD(r),n=Mn(r,n),i){case 0:e=hg(null,e,r,n,t);break e;case 1:e=CE(null,e,r,n,t);break e;case 11:e=TE(null,e,r,n,t);break e;case 14:e=SE(null,e,r,Mn(r.type,n),t);break e}throw Error(j(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mn(r,i),hg(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mn(r,i),CE(n,e,r,i,t);case 3:e:{if(oR(e),n===null)throw Error(j(387));r=e.pendingProps,s=e.memoizedState,i=s.element,NC(n,e),dd(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=oa(Error(j(423)),e),e=RE(n,e,r,t,i);break e}else if(r!==i){i=oa(Error(j(424)),e),e=RE(n,e,r,t,i);break e}else for(gn=vi(e.stateNode.containerInfo.firstChild),yn=e,xe=!0,Un=null,t=OC(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ra(),r===i){e=Mr(n,e,t);break e}zt(n,e,r,t)}e=e.child}return e;case 5:return VC(e),n===null&&og(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,tg(r,i)?o=null:s!==null&&tg(r,s)&&(e.flags|=32),sR(n,e),zt(n,e,o,t),e.child;case 6:return n===null&&og(e),null;case 13:return aR(n,e,t);case 4:return ey(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ia(e,null,r,t):zt(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mn(r,i),TE(n,e,r,i,t);case 7:return zt(n,e,e.pendingProps,t),e.child;case 8:return zt(n,e,e.pendingProps.children,t),e.child;case 12:return zt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ce(cd,r._currentValue),r._currentValue=o,s!==null)if(Gn(s.value,o)){if(s.children===i.children&&!ln.current){e=Mr(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=br(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),ag(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(j(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),ag(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}zt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,qo(e,t),i=bn(i),r=r(i),e.flags|=1,zt(n,e,r,t),e.child;case 14:return r=e.type,i=Mn(r,e.pendingProps),i=Mn(r.type,i),SE(n,e,r,i,t);case 15:return rR(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mn(r,i),Dh(n,e),e.tag=1,un(r)?(n=!0,ad(e)):n=!1,qo(e,t),xC(e,r,i),ug(e,r,i,t),dg(null,e,r,!0,n,t);case 19:return lR(n,e,t);case 22:return iR(n,e,t)}throw Error(j(156,e.tag))};function SR(n,e){return YS(n,e)}function KD(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function An(n,e,t,r){return new KD(n,e,t,r)}function my(n){return n=n.prototype,!(!n||!n.isReactComponent)}function HD(n){if(typeof n=="function")return my(n)?1:0;if(n!=null){if(n=n.$$typeof,n===O_)return 11;if(n===V_)return 14}return 2}function Ti(n,e){var t=n.alternate;return t===null?(t=An(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Lh(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")my(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Co:return Is(t.children,i,s,e);case D_:o=8,i|=8;break;case Dm:return n=An(12,t,e,i|2),n.elementType=Dm,n.lanes=s,n;case Om:return n=An(13,t,e,i),n.elementType=Om,n.lanes=s,n;case Vm:return n=An(19,t,e,i),n.elementType=Vm,n.lanes=s,n;case DS:return gf(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case bS:o=10;break e;case xS:o=9;break e;case O_:o=11;break e;case V_:o=14;break e;case si:o=16,r=null;break e}throw Error(j(130,n==null?n:typeof n,""))}return e=An(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Is(n,e,t,r){return n=An(7,n,r,e),n.lanes=t,n}function gf(n,e,t,r){return n=An(22,n,r,e),n.elementType=DS,n.lanes=t,n.stateNode={isHidden:!1},n}function om(n,e,t){return n=An(6,n,null,e),n.lanes=t,n}function am(n,e,t){return e=An(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function QD(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jp(0),this.expirationTimes=jp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function gy(n,e,t,r,i,s,o,a,l){return n=new QD(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=An(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Z_(s),n}function YD(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:So,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function CR(n){if(!n)return Ni;n=n._reactInternals;e:{if(Qs(n)!==n||n.tag!==1)throw Error(j(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(n.tag===1){var t=n.type;if(un(t))return SC(n,t,e)}return e}function RR(n,e,t,r,i,s,o,a,l){return n=gy(t,r,!0,n,i,s,o,a,l),n.context=CR(null),t=n.current,r=Wt(),i=Ei(t),s=br(r,i),s.callback=e??null,wi(t,s,i),n.current.lanes=i,sc(n,i,r),cn(n,r),n}function _f(n,e,t,r){var i=e.current,s=Wt(),o=Ei(i);return t=CR(t),e.context===null?e.context=t:e.pendingContext=t,e=br(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=wi(i,e,o),n!==null&&($n(n,i,o,s),Nh(n,i,o)),o}function wd(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function LE(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function _y(n,e){LE(n,e),(n=n.alternate)&&LE(n,e)}function JD(){return null}var AR=typeof reportError=="function"?reportError:function(n){console.error(n)};function yy(n){this._internalRoot=n}yf.prototype.render=yy.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(j(409));_f(n,e,null,null)};yf.prototype.unmount=yy.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ns(function(){_f(null,n,null,null)}),e[Vr]=null}};function yf(n){this._internalRoot=n}yf.prototype.unstable_scheduleHydration=function(n){if(n){var e=rC();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ai.length&&e!==0&&e<ai[t].priority;t++);ai.splice(t,0,n),t===0&&sC(n)}};function vy(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function vf(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ME(){}function XD(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=wd(o);s.call(c)}}var o=RR(e,r,n,0,null,!1,!1,"",ME);return n._reactRootContainer=o,n[Vr]=o.current,gu(n.nodeType===8?n.parentNode:n),Ns(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=wd(l);a.call(c)}}var l=gy(n,0,!1,null,null,!1,!1,"",ME);return n._reactRootContainer=l,n[Vr]=l.current,gu(n.nodeType===8?n.parentNode:n),Ns(function(){_f(e,l,t,r)}),l}function wf(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=wd(o);a.call(l)}}_f(e,o,n,i)}else o=XD(t,e,n,i,r);return wd(o)}tC=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=xl(e.pendingLanes);t!==0&&(F_(e,t|1),cn(e,Ze()),!(pe&6)&&(aa=Ze()+500,Wi()))}break;case 13:Ns(function(){var r=Lr(n,1);if(r!==null){var i=Wt();$n(r,n,1,i)}}),_y(n,1)}};U_=function(n){if(n.tag===13){var e=Lr(n,134217728);if(e!==null){var t=Wt();$n(e,n,134217728,t)}_y(n,134217728)}};nC=function(n){if(n.tag===13){var e=Ei(n),t=Lr(n,e);if(t!==null){var r=Wt();$n(t,n,e,r)}_y(n,e)}};rC=function(){return ve};iC=function(n,e){var t=ve;try{return ve=n,e()}finally{ve=t}};Wm=function(n,e,t){switch(e){case"input":if(Fm(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=cf(r);if(!i)throw Error(j(90));VS(r),Fm(r,i)}}}break;case"textarea":MS(n,t);break;case"select":e=t.value,e!=null&&Uo(n,!!t.multiple,e,!1)}};$S=dy;WS=Ns;var ZD={usingClientEntryPoint:!1,Events:[ac,ko,cf,zS,qS,dy]},ml={findFiberByHostInstance:fs,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},eO={bundleType:ml.bundleType,version:ml.version,rendererPackageName:ml.rendererPackageName,rendererConfig:ml.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=HS(n),n===null?null:n.stateNode},findFiberByHostInstance:ml.findFiberByHostInstance||JD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mh.isDisabled&&mh.supportsFiber)try{of=mh.inject(eO),lr=mh}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZD;Tn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vy(e))throw Error(j(200));return YD(n,e,null,t)};Tn.createRoot=function(n,e){if(!vy(n))throw Error(j(299));var t=!1,r="",i=AR;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=gy(n,1,!1,null,null,t,!1,r,i),n[Vr]=e.current,gu(n.nodeType===8?n.parentNode:n),new yy(e)};Tn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(j(188)):(n=Object.keys(n).join(","),Error(j(268,n)));return n=HS(e),n=n===null?null:n.stateNode,n};Tn.flushSync=function(n){return Ns(n)};Tn.hydrate=function(n,e,t){if(!vf(e))throw Error(j(200));return wf(null,n,e,!0,t)};Tn.hydrateRoot=function(n,e,t){if(!vy(n))throw Error(j(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=AR;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=RR(e,null,n,1,t??null,i,!1,s,o),n[Vr]=e.current,gu(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new yf(e)};Tn.render=function(n,e,t){if(!vf(e))throw Error(j(200));return wf(null,n,e,!1,t)};Tn.unmountComponentAtNode=function(n){if(!vf(n))throw Error(j(40));return n._reactRootContainer?(Ns(function(){wf(null,null,n,!1,function(){n._reactRootContainer=null,n[Vr]=null})}),!0):!1};Tn.unstable_batchedUpdates=dy;Tn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!vf(t))throw Error(j(200));if(n==null||n._reactInternals===void 0)throw Error(j(38));return wf(n,e,t,!1,r)};Tn.version="18.2.0-next-9e3b772b8-20220608";function PR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PR)}catch(n){console.error(n)}}PR(),RS.exports=Tn;var tO=RS.exports,FE=tO;bm.createRoot=FE.createRoot,bm.hydrateRoot=FE.hydrateRoot;/**
 * @remix-run/router v1.17.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cu(){return Cu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Cu.apply(this,arguments)}var fi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(fi||(fi={}));const UE="popstate";function nO(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return Sg("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Id(i)}return iO(e,t,null,n)}function ot(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function kR(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function rO(){return Math.random().toString(36).substr(2,8)}function BE(n,e){return{usr:n.state,key:n.key,idx:e}}function Sg(n,e,t,r){return t===void 0&&(t=null),Cu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?xa(e):e,{state:t,key:e&&e.key||r||rO()})}function Id(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function xa(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function iO(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=fi.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(Cu({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function d(){a=fi.Pop;let P=h(),I=P==null?null:P-c;c=P,l&&l({action:a,location:C.location,delta:I})}function p(P,I){a=fi.Push;let v=Sg(C.location,P,I);t&&t(v,P),c=h()+1;let w=BE(v,c),D=C.createHref(v);try{o.pushState(w,"",D)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;i.location.assign(D)}s&&l&&l({action:a,location:C.location,delta:1})}function _(P,I){a=fi.Replace;let v=Sg(C.location,P,I);t&&t(v,P),c=h();let w=BE(v,c),D=C.createHref(v);o.replaceState(w,"",D),s&&l&&l({action:a,location:C.location,delta:0})}function E(P){let I=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof P=="string"?P:Id(P);return v=v.replace(/ $/,"%20"),ot(I,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,I)}let C={get action(){return a},get location(){return n(i,o)},listen(P){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(UE,d),l=P,()=>{i.removeEventListener(UE,d),l=null}},createHref(P){return e(i,P)},createURL:E,encodeLocation(P){let I=E(P);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:p,replace:_,go(P){return o.go(P)}};return C}var jE;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(jE||(jE={}));function sO(n,e,t){return t===void 0&&(t="/"),oO(n,e,t,!1)}function oO(n,e,t,r){let i=typeof e=="string"?xa(e):e,s=wy(i.pathname||"/",t);if(s==null)return null;let o=NR(n);aO(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=yO(s);a=gO(o[l],c,r)}return a}function NR(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(ot(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Si([r,l.relativePath]),h=t.concat(l);s.children&&s.children.length>0&&(ot(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),NR(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:pO(c,s.index),routesMeta:h})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of bR(s.path))i(s,o,l)}),e}function bR(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=bR(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function aO(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:mO(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const lO=/^:[\w-]+$/,uO=3,cO=2,hO=1,dO=10,fO=-2,zE=n=>n==="*";function pO(n,e){let t=n.split("/"),r=t.length;return t.some(zE)&&(r+=fO),e&&(r+=cO),t.filter(i=>!zE(i)).reduce((i,s)=>i+(lO.test(s)?uO:s===""?hO:dO),r)}function mO(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function gO(n,e,t){t===void 0&&(t=!1);let{routesMeta:r}=n,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",d=qE({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),p=l.route;if(!d&&c&&t&&!r[r.length-1].route.index&&(d=qE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:Si([s,d.pathname]),pathnameBase:EO(Si([s,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(s=Si([s,d.pathnameBase]))}return o}function qE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=_O(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,h,d)=>{let{paramName:p,isOptional:_}=h;if(p==="*"){let C=a[d]||"";o=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const E=a[d];return _&&!E?c[p]=void 0:c[p]=(E||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function _O(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),kR(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function yO(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kR(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function wy(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function vO(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?xa(n):n;return{pathname:t?t.startsWith("/")?t:wO(t,e):e,search:TO(r),hash:SO(i)}}function wO(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function lm(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function IO(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function xR(n,e){let t=IO(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function DR(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=xa(n):(i=Cu({},n),ot(!i.pathname||!i.pathname.includes("?"),lm("?","pathname","search",i)),ot(!i.pathname||!i.pathname.includes("#"),lm("#","pathname","hash",i)),ot(!i.search||!i.search.includes("#"),lm("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=t;else{let d=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),d-=1;i.pathname=p.join("/")}a=d>=0?e[d]:"/"}let l=vO(i,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const Si=n=>n.join("/").replace(/\/\/+/g,"/"),EO=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),TO=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,SO=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function CO(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const OR=["post","put","patch","delete"];new Set(OR);const RO=["get",...OR];new Set(RO);/**
 * React Router v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ru(){return Ru=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ru.apply(this,arguments)}const Iy=B.createContext(null),AO=B.createContext(null),Ys=B.createContext(null),If=B.createContext(null),Gi=B.createContext({outlet:null,matches:[],isDataRoute:!1}),VR=B.createContext(null);function PO(n,e){let{relative:t}=e===void 0?{}:e;uc()||ot(!1);let{basename:r,navigator:i}=B.useContext(Ys),{hash:s,pathname:o,search:a}=MR(n,{relative:t}),l=o;return r!=="/"&&(l=o==="/"?r:Si([r,o])),i.createHref({pathname:l,search:a,hash:s})}function uc(){return B.useContext(If)!=null}function Ef(){return uc()||ot(!1),B.useContext(If).location}function LR(n){B.useContext(Ys).static||B.useLayoutEffect(n)}function Tf(){let{isDataRoute:n}=B.useContext(Gi);return n?zO():kO()}function kO(){uc()||ot(!1);let n=B.useContext(Iy),{basename:e,future:t,navigator:r}=B.useContext(Ys),{matches:i}=B.useContext(Gi),{pathname:s}=Ef(),o=JSON.stringify(xR(i,t.v7_relativeSplatPath)),a=B.useRef(!1);return LR(()=>{a.current=!0}),B.useCallback(function(c,h){if(h===void 0&&(h={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let d=DR(c,JSON.parse(o),s,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Si([e,d.pathname])),(h.replace?r.replace:r.push)(d,h.state,h)},[e,r,o,s,n])}function NO(){let{matches:n}=B.useContext(Gi),e=n[n.length-1];return e?e.params:{}}function MR(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=B.useContext(Ys),{matches:i}=B.useContext(Gi),{pathname:s}=Ef(),o=JSON.stringify(xR(i,r.v7_relativeSplatPath));return B.useMemo(()=>DR(n,JSON.parse(o),s,t==="path"),[n,o,s,t])}function bO(n,e){return xO(n,e)}function xO(n,e,t,r){uc()||ot(!1);let{navigator:i}=B.useContext(Ys),{matches:s}=B.useContext(Gi),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Ef(),h;if(e){var d;let P=typeof e=="string"?xa(e):e;l==="/"||(d=P.pathname)!=null&&d.startsWith(l)||ot(!1),h=P}else h=c;let p=h.pathname||"/",_=p;if(l!=="/"){let P=l.replace(/^\//,"").split("/");_="/"+p.replace(/^\//,"").split("/").slice(P.length).join("/")}let E=sO(n,{pathname:_}),C=MO(E&&E.map(P=>Object.assign({},P,{params:Object.assign({},a,P.params),pathname:Si([l,i.encodeLocation?i.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?l:Si([l,i.encodeLocation?i.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),s,t,r);return e&&C?B.createElement(If.Provider,{value:{location:Ru({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:fi.Pop}},C):C}function DO(){let n=jO(),e=CO(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),t?B.createElement("pre",{style:i},t):null,s)}const OO=B.createElement(DO,null);class VO extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?B.createElement(Gi.Provider,{value:this.props.routeContext},B.createElement(VR.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LO(n){let{routeContext:e,match:t,children:r}=n,i=B.useContext(Iy);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),B.createElement(Gi.Provider,{value:e},r)}function MO(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if((s=t)!=null&&s.errors)n=t.matches;else return null}let o=n,a=(i=t)==null?void 0:i.errors;if(a!=null){let h=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);h>=0||ot(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=h),d.route.id){let{loaderData:p,errors:_}=t,E=d.route.loader&&p[d.route.id]===void 0&&(!_||_[d.route.id]===void 0);if(d.route.lazy||E){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((h,d,p)=>{let _,E=!1,C=null,P=null;t&&(_=a&&d.route.id?a[d.route.id]:void 0,C=d.route.errorElement||OO,l&&(c<0&&p===0?(qO("route-fallback",!1),E=!0,P=null):c===p&&(E=!0,P=d.route.hydrateFallbackElement||null)));let I=e.concat(o.slice(0,p+1)),v=()=>{let w;return _?w=C:E?w=P:d.route.Component?w=B.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=h,B.createElement(LO,{match:d,routeContext:{outlet:h,matches:I,isDataRoute:t!=null},children:w})};return t&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?B.createElement(VO,{location:t.location,revalidation:t.revalidation,component:C,error:_,children:v(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):v()},null)}var FR=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(FR||{}),Ed=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Ed||{});function FO(n){let e=B.useContext(Iy);return e||ot(!1),e}function UO(n){let e=B.useContext(AO);return e||ot(!1),e}function BO(n){let e=B.useContext(Gi);return e||ot(!1),e}function UR(n){let e=BO(),t=e.matches[e.matches.length-1];return t.route.id||ot(!1),t.route.id}function jO(){var n;let e=B.useContext(VR),t=UO(Ed.UseRouteError),r=UR(Ed.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function zO(){let{router:n}=FO(FR.UseNavigateStable),e=UR(Ed.UseNavigateStable),t=B.useRef(!1);return LR(()=>{t.current=!0}),B.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Ru({fromRouteId:e},s)))},[n,e])}const $E={};function qO(n,e,t){!e&&!$E[n]&&($E[n]=!0)}function Mh(n){ot(!1)}function $O(n){let{basename:e="/",children:t=null,location:r,navigationType:i=fi.Pop,navigator:s,static:o=!1,future:a}=n;uc()&&ot(!1);let l=e.replace(/^\/*/,"/"),c=B.useMemo(()=>({basename:l,navigator:s,static:o,future:Ru({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=xa(r));let{pathname:h="/",search:d="",hash:p="",state:_=null,key:E="default"}=r,C=B.useMemo(()=>{let P=wy(h,l);return P==null?null:{location:{pathname:P,search:d,hash:p,state:_,key:E},navigationType:i}},[l,h,d,p,_,E,i]);return C==null?null:B.createElement(Ys.Provider,{value:c},B.createElement(If.Provider,{children:t,value:C}))}function WO(n){let{children:e,location:t}=n;return bO(Cg(e),t)}new Promise(()=>{});function Cg(n,e){e===void 0&&(e=[]);let t=[];return B.Children.forEach(n,(r,i)=>{if(!B.isValidElement(r))return;let s=[...e,i];if(r.type===B.Fragment){t.push.apply(t,Cg(r.props.children,s));return}r.type!==Mh&&ot(!1),!r.props.index||!r.props.children||ot(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Cg(r.props.children,s)),t.push(o)}),t}/**
 * React Router DOM v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rg(){return Rg=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Rg.apply(this,arguments)}function GO(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function KO(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function HO(n,e){return n.button===0&&(!e||e==="_self")&&!KO(n)}const QO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],YO="6";try{window.__reactRouterVersion=YO}catch{}const JO="startTransition",WE=Wb[JO];function XO(n){let{basename:e,children:t,future:r,window:i}=n,s=B.useRef();s.current==null&&(s.current=nO({window:i,v5Compat:!0}));let o=s.current,[a,l]=B.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},h=B.useCallback(d=>{c&&WE?WE(()=>l(d)):l(d)},[l,c]);return B.useLayoutEffect(()=>o.listen(h),[o,h]),B.createElement($O,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}const ZO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ag=B.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:h,unstable_viewTransition:d}=e,p=GO(e,QO),{basename:_}=B.useContext(Ys),E,C=!1;if(typeof c=="string"&&eV.test(c)&&(E=c,ZO))try{let w=new URL(window.location.href),D=c.startsWith("//")?new URL(w.protocol+c):new URL(c),L=wy(D.pathname,_);D.origin===w.origin&&L!=null?c=L+D.search+D.hash:C=!0}catch{}let P=PO(c,{relative:i}),I=tV(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,unstable_viewTransition:d});function v(w){r&&r(w),w.defaultPrevented||I(w)}return B.createElement("a",Rg({},p,{href:E||P,onClick:C||s?r:v,ref:t,target:l}))});var GE;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(GE||(GE={}));var KE;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(KE||(KE={}));function tV(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:o,unstable_viewTransition:a}=e===void 0?{}:e,l=Tf(),c=Ef(),h=MR(n,{relative:o});return B.useCallback(d=>{if(HO(d,t)){d.preventDefault();let p=r!==void 0?r:Id(c)===Id(h);l(n,{replace:p,state:i,preventScrollReset:s,relative:o,unstable_viewTransition:a})}},[c,l,h,r,i,t,n,s,o,a])}const nV="_controls_container_gw7ba_1",rV="_controls_gw7ba_1",iV="_create_room_form_gw7ba_16",sV="_create_room_password_gw7ba_28",oV="_connect_room_form_gw7ba_34",aV="_room_list_container_gw7ba_41",lV="_room_list_gw7ba_41",uV="_room_li_gw7ba_41",cV="_users_count_gw7ba_87",hV="_users_circles_count_gw7ba_92",dV="_overlay_gw7ba_100",Ln={controls_container:nV,controls:rV,create_room_form:iV,create_room_password:sV,connect_room_form:oV,room_list_container:aV,room_list:lV,room_li:uV,users_count:cV,users_circles_count:hV,overlay:dV};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $=function(n,e){if(!n)throw Da(e)},Da=function(n){return new Error("Firebase Database ("+BR.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},fV=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Ey={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,d=(s&3)<<4|a>>4;let p=(a&15)<<2|c>>6,_=c&63;l||(_=64,o||(p=64)),r.push(t[h],t[d],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):fV(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const d=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||c==null||d==null)throw new pV;const p=s<<2|a>>4;if(r.push(p),c!==64){const _=a<<4&240|c>>2;if(r.push(_),d!==64){const E=c<<6&192|d;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class pV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zR=function(n){const e=jR(n);return Ey.encodeByteArray(e,!0)},Td=function(n){return zR(n).replace(/\./g,"")},Sd=function(n){try{return Ey.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(n){return Au(void 0,n)}function Au(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!gV(t)||(n[t]=Au(n[t],e[t]));return n}function gV(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _V(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV=()=>_V().__FIREBASE_DEFAULTS__,vV=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wV=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Sd(n[1]);return e&&JSON.parse(e)},Sf=()=>{try{return yV()||vV()||wV()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},IV=n=>{var e,t;return(t=(e=Sf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},EV=n=>{const e=IV(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},qR=()=>{var n;return(n=Sf())===null||n===void 0?void 0:n.config},TV=n=>{var e;return(e=Sf())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Td(JSON.stringify(t)),Td(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sy(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Le())}function Cy(){var n;const e=(n=Sf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WR(){return typeof window<"u"||GR()}function GR(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function KR(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Cf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HR(){const n=Le();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function QR(){return BR.NODE_ADMIN===!0}function YR(){return!Cy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pu(){try{return typeof indexedDB=="object"}catch{return!1}}function SV(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV="FirebaseError";class Gt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=CV,Object.setPrototypeOf(this,Gt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Js.prototype.create)}}class Js{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?RV(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Gt(i,a,r)}}function RV(n,e){return n.replace(AV,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const AV=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(n){return JSON.parse(n)}function _t(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=ku(Sd(s[0])||""),t=ku(Sd(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},PV=function(n){const e=JR(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},kV=function(n){const e=JR(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function la(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Pg(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Cd(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Nu(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(HE(s)&&HE(o)){if(!Nu(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function HE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Lo(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ol(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)r[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)r[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const p=r[d-3]^r[d-8]^r[d-14]^r[d-16];r[d]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let d=0;d<80;d++){d<40?d<20?(c=a^s&(o^a),h=1518500249):(c=s^o^a,h=1859775393):d<60?(c=s&o|a&(s|o),h=2400959708):(c=s^o^a,h=3395469782);const p=(i<<5|i>>>27)+c+l+h+r[d]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function XR(n,e){const t=new bV(n,e);return t.subscribe.bind(t)}class bV{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");xV(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=um),i.error===void 0&&(i.error=um),i.complete===void 0&&(i.complete=um);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xV(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function um(){}function ZR(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,$(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Rf=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(n){return n&&n._delegate?n._delegate:n}class Hn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Ty;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LV(e))try{this.getOrInitializeService({instanceIdentifier:ss})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ss){return this.instances.has(e)}getOptions(e=ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:VV(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ss){return this.component?this.component.multipleInstances?e:ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VV(n){return n===ss?void 0:n}function LV(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new OV(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ry=[];var oe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(oe||(oe={}));const tA={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},MV=oe.INFO,FV={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},UV=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=FV[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cc{constructor(e){this.name=e,this._logLevel=MV,this._logHandler=UV,this._userLogHandler=null,Ry.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}function BV(n){Ry.forEach(e=>{e.setLogLevel(n)})}function jV(n,e){for(const t of Ry){let r=null;e&&e.level&&(r=tA[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&n({level:oe[s].toLowerCase(),message:a,args:o,type:i.name})}}}const zV=(n,e)=>e.some(t=>n instanceof t);let QE,YE;function qV(){return QE||(QE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $V(){return YE||(YE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nA=new WeakMap,kg=new WeakMap,rA=new WeakMap,cm=new WeakMap,Ay=new WeakMap;function WV(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Ci(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&nA.set(t,n)}).catch(()=>{}),Ay.set(e,n),e}function GV(n){if(kg.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});kg.set(n,e)}let Ng={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return kg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||rA.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ci(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KV(n){Ng=n(Ng)}function HV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(hm(this),e,...t);return rA.set(r,e.sort?e.sort():[e]),Ci(r)}:$V().includes(n)?function(...e){return n.apply(hm(this),e),Ci(nA.get(this))}:function(...e){return Ci(n.apply(hm(this),e))}}function QV(n){return typeof n=="function"?HV(n):(n instanceof IDBTransaction&&GV(n),zV(n,qV())?new Proxy(n,Ng):n)}function Ci(n){if(n instanceof IDBRequest)return WV(n);if(cm.has(n))return cm.get(n);const e=QV(n);return e!==n&&(cm.set(n,e),Ay.set(e,n)),e}const hm=n=>Ay.get(n);function YV(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=Ci(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ci(o.result),l.oldVersion,l.newVersion,Ci(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const JV=["get","getKey","getAll","getAllKeys","count"],XV=["put","add","delete","clear"],dm=new Map;function JE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(dm.get(e))return dm.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=XV.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||JV.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),i&&l.done]))[0]};return dm.set(e,s),s}KV(n=>({...n,get:(e,t,r)=>JE(e,t)||n.get(e,t,r),has:(e,t)=>!!JE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(eL(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function eL(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Rd="@firebase/app",bg="0.10.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs=new cc("@firebase/app"),tL="@firebase/app-compat",nL="@firebase/analytics-compat",rL="@firebase/analytics",iL="@firebase/app-check-compat",sL="@firebase/app-check",oL="@firebase/auth",aL="@firebase/auth-compat",lL="@firebase/database",uL="@firebase/database-compat",cL="@firebase/functions",hL="@firebase/functions-compat",dL="@firebase/installations",fL="@firebase/installations-compat",pL="@firebase/messaging",mL="@firebase/messaging-compat",gL="@firebase/performance",_L="@firebase/performance-compat",yL="@firebase/remote-config",vL="@firebase/remote-config-compat",wL="@firebase/storage",IL="@firebase/storage-compat",EL="@firebase/firestore",TL="@firebase/vertexai-preview",SL="@firebase/firestore-compat",CL="firebase",RL="10.12.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="[DEFAULT]",AL={[Rd]:"fire-core",[tL]:"fire-core-compat",[rL]:"fire-analytics",[nL]:"fire-analytics-compat",[sL]:"fire-app-check",[iL]:"fire-app-check-compat",[oL]:"fire-auth",[aL]:"fire-auth-compat",[lL]:"fire-rtdb",[uL]:"fire-rtdb-compat",[cL]:"fire-fn",[hL]:"fire-fn-compat",[dL]:"fire-iid",[fL]:"fire-iid-compat",[pL]:"fire-fcm",[mL]:"fire-fcm-compat",[gL]:"fire-perf",[_L]:"fire-perf-compat",[yL]:"fire-rc",[vL]:"fire-rc-compat",[wL]:"fire-gcs",[IL]:"fire-gcs-compat",[EL]:"fire-fst",[SL]:"fire-fst-compat",[TL]:"fire-vertex","fire-js":"fire-js",[CL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi=new Map,ua=new Map,ca=new Map;function bu(n,e){try{n.container.addComponent(e)}catch(t){bs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function iA(n,e){n.container.addOrOverwriteComponent(e)}function Fr(n){const e=n.name;if(ca.has(e))return bs.debug(`There were multiple attempts to register component ${e}.`),!1;ca.set(e,n);for(const t of xi.values())bu(t,n);for(const t of ua.values())bu(t,n);return!0}function Py(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function PL(n,e,t=bi){Py(n,e).clearInstance(t)}function sA(n){return n.options!==void 0}function Ge(n){return n.settings!==void 0}function kL(){ca.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Nn=new Js("app","Firebase",NL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oA=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Nn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL extends oA{constructor(e,t,r,i){const s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{const a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,vn(Rd,bg,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Ny(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Nn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r=RL;function ky(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:bi,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Nn.create("bad-app-name",{appName:String(i)});if(t||(t=qR()),!t)throw Nn.create("no-options");const s=xi.get(i);if(s){if(Nu(t,s.options)&&Nu(r,s.config))return s;throw Nn.create("duplicate-app",{appName:i})}const o=new eA(i);for(const l of ca.values())o.addComponent(l);const a=new oA(t,r,o);return xi.set(i,a),a}function xL(n,e){if(WR()&&!GR())throw Nn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;sA(n)?t=n.options:t=n;const r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const i=c=>[...c].reduce((h,d)=>Math.imul(31,h)+d.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Nn.create("finalization-registry-not-supported",{});const s=""+i(JSON.stringify(r)),o=ua.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new eA(s);for(const c of ca.values())a.addComponent(c);const l=new bL(t,e,s,a);return ua.set(s,l),l}function aA(n=bi){const e=xi.get(n);if(!e&&n===bi&&qR())return ky();if(!e)throw Nn.create("no-app",{appName:n});return e}function DL(){return Array.from(xi.values())}async function Ny(n){let e=!1;const t=n.name;xi.has(t)?(e=!0,xi.delete(t)):ua.has(t)&&n.decRefCount()<=0&&(ua.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function vn(n,e,t){var r;let i=(r=AL[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bs.warn(a.join(" "));return}Fr(new Hn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function lA(n,e){if(n!==null&&typeof n!="function")throw Nn.create("invalid-log-argument");jV(n,e)}function uA(n){BV(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL="firebase-heartbeat-database",VL=1,xu="firebase-heartbeat-store";let fm=null;function cA(){return fm||(fm=YV(OL,VL,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Nn.create("idb-open",{originalErrorMessage:n.message})})),fm}async function LL(n){try{const t=(await cA()).transaction(xu),r=await t.objectStore(xu).get(hA(n));return await t.done,r}catch(e){if(e instanceof Gt)bs.warn(e.message);else{const t=Nn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});bs.warn(t.message)}}}async function XE(n,e){try{const r=(await cA()).transaction(xu,"readwrite");await r.objectStore(xu).put(e,hA(n)),await r.done}catch(t){if(t instanceof Gt)bs.warn(t.message);else{const r=Nn.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});bs.warn(r.message)}}}function hA(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=1024,FL=30*24*60*60*1e3;class UL{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new jL(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ZE();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=FL}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ZE(),{heartbeatsToSend:r,unsentEntries:i}=BL(this._heartbeatsCache.heartbeats),s=Td(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function ZE(){return new Date().toISOString().substring(0,10)}function BL(n,e=ML){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),eT(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),eT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class jL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Pu()?SV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await LL(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return XE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return XE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function eT(n){return Td(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(n){Fr(new Hn("platform-logger",e=>new ZV(e),"PRIVATE")),Fr(new Hn("heartbeat",e=>new UL(e),"PRIVATE")),vn(Rd,bg,n),vn(Rd,bg,"esm2017"),vn("fire-js","")}zL("");const qL=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Gt,SDK_VERSION:$r,_DEFAULT_ENTRY_NAME:bi,_addComponent:bu,_addOrOverwriteComponent:iA,_apps:xi,_clearComponents:kL,_components:ca,_getProvider:Py,_isFirebaseApp:sA,_isFirebaseServerApp:Ge,_registerComponent:Fr,_removeServiceInstance:PL,_serverApps:ua,deleteApp:Ny,getApp:aA,getApps:DL,initializeApp:ky,initializeServerApp:xL,onLog:lA,registerVersion:vn,setLogLevel:uA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(e,t){this._delegate=e,this.firebase=t,bu(e,new Hn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Ny(this._delegate)))}_getService(e,t=bi){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=bi){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){bu(this._delegate,e)}_addOrOverwriteComponent(e){iA(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},tT=new Js("app-compat","Firebase",WL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:vn,setLogLevel:uA,onLog:lA,apps:null,SDK_VERSION:$r,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:qL}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(c){delete e[c]}function i(c){if(c=c||bi,!Kn(e,c))throw tT.create("no-app",{appName:c});return e[c]}i.App=n;function s(c,h={}){const d=ky(c,h);if(Kn(e,d.name))return e[d.name];const p=new n(d,t);return e[d.name]=p,p}function o(){return Object.keys(e).map(c=>e[c])}function a(c){const h=c.name,d=h.replace("-compat","");if(Fr(c)&&c.type==="PUBLIC"){const p=(_=i())=>{if(typeof _[d]!="function")throw tT.create("invalid-app-argument",{appName:h});return _[d]()};c.serviceProps!==void 0&&Au(p,c.serviceProps),t[d]=p,n.prototype[d]=function(..._){return this._getService.bind(this,h).apply(this,c.multipleInstances?_:[])}}return c.type==="PUBLIC"?t[d]:null}function l(c,h){return h==="serverAuth"?null:h}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(){const n=GL($L);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:dA,extendNamespace:e,createSubscribe:XR,ErrorFactory:Js,deepExtend:Au});function e(t){Au(n,t)}return n}const KL=dA();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT=new cc("@firebase/app-compat"),HL="@firebase/app-compat",QL="0.2.36";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(n){vn(HL,QL,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(WR()&&self.firebase!==void 0){nT.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&nT.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const et=KL;YL();var JL="firebase",XL="10.12.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */et.registerVersion(JL,XL,"app-compat");var rT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Es,fA;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,y){function S(){}S.prototype=y.prototype,T.D=y.prototype,T.prototype=new S,T.prototype.constructor=T,T.C=function(R,k,b){for(var A=Array(arguments.length-2),re=2;re<arguments.length;re++)A[re-2]=arguments[re];return y.prototype[k].apply(R,A)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,y,S){S||(S=0);var R=Array(16);if(typeof y=="string")for(var k=0;16>k;++k)R[k]=y.charCodeAt(S++)|y.charCodeAt(S++)<<8|y.charCodeAt(S++)<<16|y.charCodeAt(S++)<<24;else for(k=0;16>k;++k)R[k]=y[S++]|y[S++]<<8|y[S++]<<16|y[S++]<<24;y=T.g[0],S=T.g[1],k=T.g[2];var b=T.g[3],A=y+(b^S&(k^b))+R[0]+3614090360&4294967295;y=S+(A<<7&4294967295|A>>>25),A=b+(k^y&(S^k))+R[1]+3905402710&4294967295,b=y+(A<<12&4294967295|A>>>20),A=k+(S^b&(y^S))+R[2]+606105819&4294967295,k=b+(A<<17&4294967295|A>>>15),A=S+(y^k&(b^y))+R[3]+3250441966&4294967295,S=k+(A<<22&4294967295|A>>>10),A=y+(b^S&(k^b))+R[4]+4118548399&4294967295,y=S+(A<<7&4294967295|A>>>25),A=b+(k^y&(S^k))+R[5]+1200080426&4294967295,b=y+(A<<12&4294967295|A>>>20),A=k+(S^b&(y^S))+R[6]+2821735955&4294967295,k=b+(A<<17&4294967295|A>>>15),A=S+(y^k&(b^y))+R[7]+4249261313&4294967295,S=k+(A<<22&4294967295|A>>>10),A=y+(b^S&(k^b))+R[8]+1770035416&4294967295,y=S+(A<<7&4294967295|A>>>25),A=b+(k^y&(S^k))+R[9]+2336552879&4294967295,b=y+(A<<12&4294967295|A>>>20),A=k+(S^b&(y^S))+R[10]+4294925233&4294967295,k=b+(A<<17&4294967295|A>>>15),A=S+(y^k&(b^y))+R[11]+2304563134&4294967295,S=k+(A<<22&4294967295|A>>>10),A=y+(b^S&(k^b))+R[12]+1804603682&4294967295,y=S+(A<<7&4294967295|A>>>25),A=b+(k^y&(S^k))+R[13]+4254626195&4294967295,b=y+(A<<12&4294967295|A>>>20),A=k+(S^b&(y^S))+R[14]+2792965006&4294967295,k=b+(A<<17&4294967295|A>>>15),A=S+(y^k&(b^y))+R[15]+1236535329&4294967295,S=k+(A<<22&4294967295|A>>>10),A=y+(k^b&(S^k))+R[1]+4129170786&4294967295,y=S+(A<<5&4294967295|A>>>27),A=b+(S^k&(y^S))+R[6]+3225465664&4294967295,b=y+(A<<9&4294967295|A>>>23),A=k+(y^S&(b^y))+R[11]+643717713&4294967295,k=b+(A<<14&4294967295|A>>>18),A=S+(b^y&(k^b))+R[0]+3921069994&4294967295,S=k+(A<<20&4294967295|A>>>12),A=y+(k^b&(S^k))+R[5]+3593408605&4294967295,y=S+(A<<5&4294967295|A>>>27),A=b+(S^k&(y^S))+R[10]+38016083&4294967295,b=y+(A<<9&4294967295|A>>>23),A=k+(y^S&(b^y))+R[15]+3634488961&4294967295,k=b+(A<<14&4294967295|A>>>18),A=S+(b^y&(k^b))+R[4]+3889429448&4294967295,S=k+(A<<20&4294967295|A>>>12),A=y+(k^b&(S^k))+R[9]+568446438&4294967295,y=S+(A<<5&4294967295|A>>>27),A=b+(S^k&(y^S))+R[14]+3275163606&4294967295,b=y+(A<<9&4294967295|A>>>23),A=k+(y^S&(b^y))+R[3]+4107603335&4294967295,k=b+(A<<14&4294967295|A>>>18),A=S+(b^y&(k^b))+R[8]+1163531501&4294967295,S=k+(A<<20&4294967295|A>>>12),A=y+(k^b&(S^k))+R[13]+2850285829&4294967295,y=S+(A<<5&4294967295|A>>>27),A=b+(S^k&(y^S))+R[2]+4243563512&4294967295,b=y+(A<<9&4294967295|A>>>23),A=k+(y^S&(b^y))+R[7]+1735328473&4294967295,k=b+(A<<14&4294967295|A>>>18),A=S+(b^y&(k^b))+R[12]+2368359562&4294967295,S=k+(A<<20&4294967295|A>>>12),A=y+(S^k^b)+R[5]+4294588738&4294967295,y=S+(A<<4&4294967295|A>>>28),A=b+(y^S^k)+R[8]+2272392833&4294967295,b=y+(A<<11&4294967295|A>>>21),A=k+(b^y^S)+R[11]+1839030562&4294967295,k=b+(A<<16&4294967295|A>>>16),A=S+(k^b^y)+R[14]+4259657740&4294967295,S=k+(A<<23&4294967295|A>>>9),A=y+(S^k^b)+R[1]+2763975236&4294967295,y=S+(A<<4&4294967295|A>>>28),A=b+(y^S^k)+R[4]+1272893353&4294967295,b=y+(A<<11&4294967295|A>>>21),A=k+(b^y^S)+R[7]+4139469664&4294967295,k=b+(A<<16&4294967295|A>>>16),A=S+(k^b^y)+R[10]+3200236656&4294967295,S=k+(A<<23&4294967295|A>>>9),A=y+(S^k^b)+R[13]+681279174&4294967295,y=S+(A<<4&4294967295|A>>>28),A=b+(y^S^k)+R[0]+3936430074&4294967295,b=y+(A<<11&4294967295|A>>>21),A=k+(b^y^S)+R[3]+3572445317&4294967295,k=b+(A<<16&4294967295|A>>>16),A=S+(k^b^y)+R[6]+76029189&4294967295,S=k+(A<<23&4294967295|A>>>9),A=y+(S^k^b)+R[9]+3654602809&4294967295,y=S+(A<<4&4294967295|A>>>28),A=b+(y^S^k)+R[12]+3873151461&4294967295,b=y+(A<<11&4294967295|A>>>21),A=k+(b^y^S)+R[15]+530742520&4294967295,k=b+(A<<16&4294967295|A>>>16),A=S+(k^b^y)+R[2]+3299628645&4294967295,S=k+(A<<23&4294967295|A>>>9),A=y+(k^(S|~b))+R[0]+4096336452&4294967295,y=S+(A<<6&4294967295|A>>>26),A=b+(S^(y|~k))+R[7]+1126891415&4294967295,b=y+(A<<10&4294967295|A>>>22),A=k+(y^(b|~S))+R[14]+2878612391&4294967295,k=b+(A<<15&4294967295|A>>>17),A=S+(b^(k|~y))+R[5]+4237533241&4294967295,S=k+(A<<21&4294967295|A>>>11),A=y+(k^(S|~b))+R[12]+1700485571&4294967295,y=S+(A<<6&4294967295|A>>>26),A=b+(S^(y|~k))+R[3]+2399980690&4294967295,b=y+(A<<10&4294967295|A>>>22),A=k+(y^(b|~S))+R[10]+4293915773&4294967295,k=b+(A<<15&4294967295|A>>>17),A=S+(b^(k|~y))+R[1]+2240044497&4294967295,S=k+(A<<21&4294967295|A>>>11),A=y+(k^(S|~b))+R[8]+1873313359&4294967295,y=S+(A<<6&4294967295|A>>>26),A=b+(S^(y|~k))+R[15]+4264355552&4294967295,b=y+(A<<10&4294967295|A>>>22),A=k+(y^(b|~S))+R[6]+2734768916&4294967295,k=b+(A<<15&4294967295|A>>>17),A=S+(b^(k|~y))+R[13]+1309151649&4294967295,S=k+(A<<21&4294967295|A>>>11),A=y+(k^(S|~b))+R[4]+4149444226&4294967295,y=S+(A<<6&4294967295|A>>>26),A=b+(S^(y|~k))+R[11]+3174756917&4294967295,b=y+(A<<10&4294967295|A>>>22),A=k+(y^(b|~S))+R[2]+718787259&4294967295,k=b+(A<<15&4294967295|A>>>17),A=S+(b^(k|~y))+R[9]+3951481745&4294967295,T.g[0]=T.g[0]+y&4294967295,T.g[1]=T.g[1]+(k+(A<<21&4294967295|A>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+b&4294967295}r.prototype.u=function(T,y){y===void 0&&(y=T.length);for(var S=y-this.blockSize,R=this.B,k=this.h,b=0;b<y;){if(k==0)for(;b<=S;)i(this,T,b),b+=this.blockSize;if(typeof T=="string"){for(;b<y;)if(R[k++]=T.charCodeAt(b++),k==this.blockSize){i(this,R),k=0;break}}else for(;b<y;)if(R[k++]=T[b++],k==this.blockSize){i(this,R),k=0;break}}this.h=k,this.o+=y},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var y=1;y<T.length-8;++y)T[y]=0;var S=8*this.o;for(y=T.length-8;y<T.length;++y)T[y]=S&255,S/=256;for(this.u(T),T=Array(16),y=S=0;4>y;++y)for(var R=0;32>R;R+=8)T[S++]=this.g[y]>>>R&255;return T};function s(T,y){var S=a;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=y(T)}function o(T,y){this.h=y;for(var S=[],R=!0,k=T.length-1;0<=k;k--){var b=T[k]|0;R&&b==y||(S[k]=b,R=!1)}this.g=S}var a={};function l(T){return-128<=T&&128>T?s(T,function(y){return new o([y|0],0>y?-1:0)}):new o([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return P(c(-T));for(var y=[],S=1,R=0;T>=S;R++)y[R]=T/S|0,S*=4294967296;return new o(y,0)}function h(T,y){if(T.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(T.charAt(0)=="-")return P(h(T.substring(1),y));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(y,8)),R=d,k=0;k<T.length;k+=8){var b=Math.min(8,T.length-k),A=parseInt(T.substring(k,k+b),y);8>b?(b=c(Math.pow(y,b)),R=R.j(b).add(c(A))):(R=R.j(S),R=R.add(c(A)))}return R}var d=l(0),p=l(1),_=l(16777216);n=o.prototype,n.m=function(){if(C(this))return-P(this).m();for(var T=0,y=1,S=0;S<this.g.length;S++){var R=this.i(S);T+=(0<=R?R:4294967296+R)*y,y*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(E(this))return"0";if(C(this))return"-"+P(this).toString(T);for(var y=c(Math.pow(T,6)),S=this,R="";;){var k=D(S,y).g;S=I(S,k.j(y));var b=((0<S.g.length?S.g[0]:S.h)>>>0).toString(T);if(S=k,E(S))return b+R;for(;6>b.length;)b="0"+b;R=b+R}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function E(T){if(T.h!=0)return!1;for(var y=0;y<T.g.length;y++)if(T.g[y]!=0)return!1;return!0}function C(T){return T.h==-1}n.l=function(T){return T=I(this,T),C(T)?-1:E(T)?0:1};function P(T){for(var y=T.g.length,S=[],R=0;R<y;R++)S[R]=~T.g[R];return new o(S,~T.h).add(p)}n.abs=function(){return C(this)?P(this):this},n.add=function(T){for(var y=Math.max(this.g.length,T.g.length),S=[],R=0,k=0;k<=y;k++){var b=R+(this.i(k)&65535)+(T.i(k)&65535),A=(b>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);R=A>>>16,b&=65535,A&=65535,S[k]=A<<16|b}return new o(S,S[S.length-1]&-2147483648?-1:0)};function I(T,y){return T.add(P(y))}n.j=function(T){if(E(this)||E(T))return d;if(C(this))return C(T)?P(this).j(P(T)):P(P(this).j(T));if(C(T))return P(this.j(P(T)));if(0>this.l(_)&&0>T.l(_))return c(this.m()*T.m());for(var y=this.g.length+T.g.length,S=[],R=0;R<2*y;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(var k=0;k<T.g.length;k++){var b=this.i(R)>>>16,A=this.i(R)&65535,re=T.i(k)>>>16,Re=T.i(k)&65535;S[2*R+2*k]+=A*Re,v(S,2*R+2*k),S[2*R+2*k+1]+=b*Re,v(S,2*R+2*k+1),S[2*R+2*k+1]+=A*re,v(S,2*R+2*k+1),S[2*R+2*k+2]+=b*re,v(S,2*R+2*k+2)}for(R=0;R<y;R++)S[R]=S[2*R+1]<<16|S[2*R];for(R=y;R<2*y;R++)S[R]=0;return new o(S,0)};function v(T,y){for(;(T[y]&65535)!=T[y];)T[y+1]+=T[y]>>>16,T[y]&=65535,y++}function w(T,y){this.g=T,this.h=y}function D(T,y){if(E(y))throw Error("division by zero");if(E(T))return new w(d,d);if(C(T))return y=D(P(T),y),new w(P(y.g),P(y.h));if(C(y))return y=D(T,P(y)),new w(P(y.g),y.h);if(30<T.g.length){if(C(T)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var S=p,R=y;0>=R.l(T);)S=L(S),R=L(R);var k=M(S,1),b=M(R,1);for(R=M(R,2),S=M(S,2);!E(R);){var A=b.add(R);0>=A.l(T)&&(k=k.add(S),b=A),R=M(R,1),S=M(S,1)}return y=I(T,k.j(y)),new w(k,y)}for(k=d;0<=T.l(y);){for(S=Math.max(1,Math.floor(T.m()/y.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),b=c(S),A=b.j(y);C(A)||0<A.l(T);)S-=R,b=c(S),A=b.j(y);E(b)&&(b=p),k=k.add(b),T=I(T,A)}return new w(k,T)}n.A=function(T){return D(this,T).h},n.and=function(T){for(var y=Math.max(this.g.length,T.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)&T.i(R);return new o(S,this.h&T.h)},n.or=function(T){for(var y=Math.max(this.g.length,T.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)|T.i(R);return new o(S,this.h|T.h)},n.xor=function(T){for(var y=Math.max(this.g.length,T.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)^T.i(R);return new o(S,this.h^T.h)};function L(T){for(var y=T.g.length+1,S=[],R=0;R<y;R++)S[R]=T.i(R)<<1|T.i(R-1)>>>31;return new o(S,T.h)}function M(T,y){var S=y>>5;y%=32;for(var R=T.g.length-S,k=[],b=0;b<R;b++)k[b]=0<y?T.i(b+S)>>>y|T.i(b+S+1)<<32-y:T.i(b+S);return new o(k,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,fA=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Es=o}).apply(typeof rT<"u"?rT:typeof self<"u"?self:typeof window<"u"?window:{});var gh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var pA,mA,Vl,gA,Fh,xg,_A,yA,vA;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof gh=="object"&&gh];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var N=u[g];if(!(N in m))break e;m=m[N]}u=u[u.length-1],g=m[u],f=f(g),f!=g&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,g=!1,N={next:function(){if(!g&&m<u.length){var O=m++;return{value:f(O,u[O]),done:!1}}return g=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function c(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function h(u,f,m){return u.call.apply(u.bind,arguments)}function d(u,f,m){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,g),u.apply(f,N)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var g=m.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function E(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(g,N,O){for(var W=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)W[Ee-2]=arguments[Ee];return f.prototype[N].apply(g,W)}}function C(u){const f=u.length;if(0<f){const m=Array(f);for(let g=0;g<f;g++)m[g]=u[g];return m}return[]}function P(u,f){for(let m=1;m<arguments.length;m++){const g=arguments[m];if(l(g)){const N=u.length||0,O=g.length||0;u.length=N+O;for(let W=0;W<O;W++)u[N+W]=g[W]}else u.push(g)}}class I{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function v(u){return/^[\s\xa0]*$/.test(u)}function w(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function D(u){return D[" "](u),u}D[" "]=function(){};var L=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function M(u,f,m){for(const g in u)f.call(m,u[g],g,u)}function T(u,f){for(const m in u)f.call(void 0,u[m],m,u)}function y(u){const f={};for(const m in u)f[m]=u[m];return f}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(u,f){let m,g;for(let N=1;N<arguments.length;N++){g=arguments[N];for(m in g)u[m]=g[m];for(let O=0;O<S.length;O++)m=S[O],Object.prototype.hasOwnProperty.call(g,m)&&(u[m]=g[m])}}function k(u){var f=1;u=u.split(":");const m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function b(u){a.setTimeout(()=>{throw u},0)}function A(){var u=te;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class re{constructor(){this.h=this.g=null}add(f,m){const g=Re.get();g.set(f,m),this.h?this.h.next=g:this.g=g,this.h=g}}var Re=new I(()=>new Ut,u=>u.reset());class Ut{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let mr,H=!1,te=new re,se=()=>{const u=a.Promise.resolve(void 0);mr=()=>{u.then(Me)}};var Me=()=>{for(var u;u=A();){try{u.h.call(u.g)}catch(m){b(m)}var f=Re;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}H=!1};function Ie(){this.s=this.s,this.C=this.C}Ie.prototype.s=!1,Ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Xe(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}Xe.prototype.h=function(){this.defaultPrevented=!0};var gr=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function _r(u,f){if(Xe.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(L){e:{try{D(f.nodeName);var N=!0;break e}catch{}N=!1}N||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:yr[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&_r.aa.h.call(this)}}E(_r,Xe);var yr={2:"touch",3:"pen",4:"mouse"};_r.prototype.h=function(){_r.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Jn="closure_listenable_"+(1e6*Math.random()|0),XN=0;function ZN(u,f,m,g,N){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!g,this.ha=N,this.key=++XN,this.da=this.fa=!1}function Lc(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Mc(u){this.src=u,this.g={},this.h=0}Mc.prototype.add=function(u,f,m,g,N){var O=u.toString();u=this.g[O],u||(u=this.g[O]=[],this.h++);var W=fp(u,f,g,N);return-1<W?(f=u[W],m||(f.fa=!1)):(f=new ZN(f,this.src,O,!!g,N),f.fa=m,u.push(f)),f};function dp(u,f){var m=f.type;if(m in u.g){var g=u.g[m],N=Array.prototype.indexOf.call(g,f,void 0),O;(O=0<=N)&&Array.prototype.splice.call(g,N,1),O&&(Lc(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function fp(u,f,m,g){for(var N=0;N<u.length;++N){var O=u[N];if(!O.da&&O.listener==f&&O.capture==!!m&&O.ha==g)return N}return-1}var pp="closure_lm_"+(1e6*Math.random()|0),mp={};function Nw(u,f,m,g,N){if(g&&g.once)return xw(u,f,m,g,N);if(Array.isArray(f)){for(var O=0;O<f.length;O++)Nw(u,f[O],m,g,N);return null}return m=vp(m),u&&u[Jn]?u.K(f,m,c(g)?!!g.capture:!!g,N):bw(u,f,m,!1,g,N)}function bw(u,f,m,g,N,O){if(!f)throw Error("Invalid event type");var W=c(N)?!!N.capture:!!N,Ee=_p(u);if(Ee||(u[pp]=Ee=new Mc(u)),m=Ee.add(f,m,g,W,O),m.proxy)return m;if(g=eb(),m.proxy=g,g.src=u,g.listener=m,u.addEventListener)gr||(N=W),N===void 0&&(N=!1),u.addEventListener(f.toString(),g,N);else if(u.attachEvent)u.attachEvent(Ow(f.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return m}function eb(){function u(m){return f.call(u.src,u.listener,m)}const f=tb;return u}function xw(u,f,m,g,N){if(Array.isArray(f)){for(var O=0;O<f.length;O++)xw(u,f[O],m,g,N);return null}return m=vp(m),u&&u[Jn]?u.L(f,m,c(g)?!!g.capture:!!g,N):bw(u,f,m,!0,g,N)}function Dw(u,f,m,g,N){if(Array.isArray(f))for(var O=0;O<f.length;O++)Dw(u,f[O],m,g,N);else g=c(g)?!!g.capture:!!g,m=vp(m),u&&u[Jn]?(u=u.i,f=String(f).toString(),f in u.g&&(O=u.g[f],m=fp(O,m,g,N),-1<m&&(Lc(O[m]),Array.prototype.splice.call(O,m,1),O.length==0&&(delete u.g[f],u.h--)))):u&&(u=_p(u))&&(f=u.g[f.toString()],u=-1,f&&(u=fp(f,m,g,N)),(m=-1<u?f[u]:null)&&gp(m))}function gp(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Jn])dp(f.i,u);else{var m=u.type,g=u.proxy;f.removeEventListener?f.removeEventListener(m,g,u.capture):f.detachEvent?f.detachEvent(Ow(m),g):f.addListener&&f.removeListener&&f.removeListener(g),(m=_p(f))?(dp(m,u),m.h==0&&(m.src=null,f[pp]=null)):Lc(u)}}}function Ow(u){return u in mp?mp[u]:mp[u]="on"+u}function tb(u,f){if(u.da)u=!0;else{f=new _r(f,this);var m=u.listener,g=u.ha||u.src;u.fa&&gp(u),u=m.call(g,f)}return u}function _p(u){return u=u[pp],u instanceof Mc?u:null}var yp="__closure_events_fn_"+(1e9*Math.random()>>>0);function vp(u){return typeof u=="function"?u:(u[yp]||(u[yp]=function(f){return u.handleEvent(f)}),u[yp])}function kt(){Ie.call(this),this.i=new Mc(this),this.M=this,this.F=null}E(kt,Ie),kt.prototype[Jn]=!0,kt.prototype.removeEventListener=function(u,f,m,g){Dw(this,u,f,m,g)};function Bt(u,f){var m,g=u.F;if(g)for(m=[];g;g=g.F)m.push(g);if(u=u.M,g=f.type||f,typeof f=="string")f=new Xe(f,u);else if(f instanceof Xe)f.target=f.target||u;else{var N=f;f=new Xe(g,u),R(f,N)}if(N=!0,m)for(var O=m.length-1;0<=O;O--){var W=f.g=m[O];N=Fc(W,g,!0,f)&&N}if(W=f.g=u,N=Fc(W,g,!0,f)&&N,N=Fc(W,g,!1,f)&&N,m)for(O=0;O<m.length;O++)W=f.g=m[O],N=Fc(W,g,!1,f)&&N}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],g=0;g<m.length;g++)Lc(m[g]);delete u.g[f],u.h--}}this.F=null},kt.prototype.K=function(u,f,m,g){return this.i.add(String(u),f,!1,m,g)},kt.prototype.L=function(u,f,m,g){return this.i.add(String(u),f,!0,m,g)};function Fc(u,f,m,g){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var N=!0,O=0;O<f.length;++O){var W=f[O];if(W&&!W.da&&W.capture==m){var Ee=W.listener,Tt=W.ha||W.src;W.fa&&dp(u.i,W),N=Ee.call(Tt,g)!==!1&&N}}return N&&!g.defaultPrevented}function Vw(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function Lw(u){u.g=Vw(()=>{u.g=null,u.i&&(u.i=!1,Lw(u))},u.l);const f=u.h;u.h=null,u.m.apply(null,f)}class nb extends Ie{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Lw(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ha(u){Ie.call(this),this.h=u,this.g={}}E(Ha,Ie);var Mw=[];function Fw(u){M(u.g,function(f,m){this.g.hasOwnProperty(m)&&gp(f)},u),u.g={}}Ha.prototype.N=function(){Ha.aa.N.call(this),Fw(this)},Ha.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wp=a.JSON.stringify,rb=a.JSON.parse,ib=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Ip(){}Ip.prototype.h=null;function Uw(u){return u.h||(u.h=u.i())}function Bw(){}var Qa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ep(){Xe.call(this,"d")}E(Ep,Xe);function Tp(){Xe.call(this,"c")}E(Tp,Xe);var Xi={},jw=null;function Uc(){return jw=jw||new kt}Xi.La="serverreachability";function zw(u){Xe.call(this,Xi.La,u)}E(zw,Xe);function Ya(u){const f=Uc();Bt(f,new zw(f))}Xi.STAT_EVENT="statevent";function qw(u,f){Xe.call(this,Xi.STAT_EVENT,u),this.stat=f}E(qw,Xe);function jt(u){const f=Uc();Bt(f,new qw(f,u))}Xi.Ma="timingevent";function $w(u,f){Xe.call(this,Xi.Ma,u),this.size=f}E($w,Xe);function Ja(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function Xa(){this.g=!0}Xa.prototype.xa=function(){this.g=!1};function sb(u,f,m,g,N,O){u.info(function(){if(u.g)if(O)for(var W="",Ee=O.split("&"),Tt=0;Tt<Ee.length;Tt++){var ge=Ee[Tt].split("=");if(1<ge.length){var Nt=ge[0];ge=ge[1];var bt=Nt.split("_");W=2<=bt.length&&bt[1]=="type"?W+(Nt+"="+ge+"&"):W+(Nt+"=redacted&")}}else W=null;else W=O;return"XMLHTTP REQ ("+g+") [attempt "+N+"]: "+f+`
`+m+`
`+W})}function ob(u,f,m,g,N,O,W){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+N+"]: "+f+`
`+m+`
`+O+" "+W})}function ao(u,f,m,g){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+lb(u,m)+(g?" "+g:"")})}function ab(u,f){u.info(function(){return"TIMEOUT: "+f})}Xa.prototype.info=function(){};function lb(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var g=m[u];if(!(2>g.length)){var N=g[1];if(Array.isArray(N)&&!(1>N.length)){var O=N[0];if(O!="noop"&&O!="stop"&&O!="close")for(var W=1;W<N.length;W++)N[W]=""}}}}return wp(m)}catch{return f}}var Bc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ww={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Sp;function jc(){}E(jc,Ip),jc.prototype.g=function(){return new XMLHttpRequest},jc.prototype.i=function(){return{}},Sp=new jc;function Jr(u,f,m,g){this.j=u,this.i=f,this.l=m,this.R=g||1,this.U=new Ha(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gw}function Gw(){this.i=null,this.g="",this.h=!1}var Kw={},Cp={};function Rp(u,f,m){u.L=1,u.v=Wc(vr(f)),u.m=m,u.P=!0,Hw(u,null)}function Hw(u,f){u.F=Date.now(),zc(u),u.A=vr(u.v);var m=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),lI(m.i,"t",g),u.C=0,m=u.j.J,u.h=new Gw,u.g=RI(u.j,m?f:null,!u.m),0<u.O&&(u.M=new nb(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,g=u.ca;var N="readystatechange";Array.isArray(N)||(N&&(Mw[0]=N.toString()),N=Mw);for(var O=0;O<N.length;O++){var W=Nw(m,N[O],g||f.handleEvent,!1,f.h||f);if(!W)break;f.g[W.key]=W}f=u.H?y(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),Ya(),sb(u.i,u.u,u.A,u.l,u.R,u.m)}Jr.prototype.ca=function(u){u=u.target;const f=this.M;f&&wr(u)==3?f.j():this.Y(u)},Jr.prototype.Y=function(u){try{if(u==this.g)e:{const bt=wr(this.g);var f=this.g.Ba();const co=this.g.Z();if(!(3>bt)&&(bt!=3||this.g&&(this.h.h||this.g.oa()||mI(this.g)))){this.J||bt!=4||f==7||(f==8||0>=co?Ya(3):Ya(2)),Ap(this);var m=this.g.Z();this.X=m;t:if(Qw(this)){var g=mI(this.g);u="";var N=g.length,O=wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zi(this),Za(this);var W="";break t}this.h.i=new a.TextDecoder}for(f=0;f<N;f++)this.h.h=!0,u+=this.h.i.decode(g[f],{stream:!(O&&f==N-1)});g.length=0,this.h.g+=u,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=m==200,ob(this.i,this.u,this.A,this.l,this.R,bt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ee,Tt=this.g;if((Ee=Tt.g?Tt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Ee)){var ge=Ee;break t}}ge=null}if(m=ge)ao(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pp(this,m);else{this.o=!1,this.s=3,jt(12),Zi(this),Za(this);break e}}if(this.P){m=!0;let On;for(;!this.J&&this.C<W.length;)if(On=ub(this,W),On==Cp){bt==4&&(this.s=4,jt(14),m=!1),ao(this.i,this.l,null,"[Incomplete Response]");break}else if(On==Kw){this.s=4,jt(15),ao(this.i,this.l,W,"[Invalid Chunk]"),m=!1;break}else ao(this.i,this.l,On,null),Pp(this,On);if(Qw(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bt!=4||W.length!=0||this.h.h||(this.s=1,jt(16),m=!1),this.o=this.o&&m,!m)ao(this.i,this.l,W,"[Invalid Chunked Response]"),Zi(this),Za(this);else if(0<W.length&&!this.W){this.W=!0;var Nt=this.j;Nt.g==this&&Nt.ba&&!Nt.M&&(Nt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Op(Nt),Nt.M=!0,jt(11))}}else ao(this.i,this.l,W,null),Pp(this,W);bt==4&&Zi(this),this.o&&!this.J&&(bt==4?EI(this.j,this):(this.o=!1,zc(this)))}else Rb(this.g),m==400&&0<W.indexOf("Unknown SID")?(this.s=3,jt(12)):(this.s=0,jt(13)),Zi(this),Za(this)}}}catch{}finally{}};function Qw(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ub(u,f){var m=u.C,g=f.indexOf(`
`,m);return g==-1?Cp:(m=Number(f.substring(m,g)),isNaN(m)?Kw:(g+=1,g+m>f.length?Cp:(f=f.slice(g,g+m),u.C=g+m,f)))}Jr.prototype.cancel=function(){this.J=!0,Zi(this)};function zc(u){u.S=Date.now()+u.I,Yw(u,u.I)}function Yw(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ja(p(u.ba,u),f)}function Ap(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Jr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(ab(this.i,this.A),this.L!=2&&(Ya(),jt(17)),Zi(this),this.s=2,Za(this)):Yw(this,this.S-u)};function Za(u){u.j.G==0||u.J||EI(u.j,u)}function Zi(u){Ap(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,Fw(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function Pp(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||kp(m.h,u))){if(!u.K&&kp(m.h,u)&&m.G==3){try{var g=m.Da.g.parse(f)}catch{g=null}if(Array.isArray(g)&&g.length==3){var N=g;if(N[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)Yc(m),Hc(m);else break e;Dp(m),jt(18)}}else m.za=N[1],0<m.za-m.T&&37500>N[2]&&m.F&&m.v==0&&!m.C&&(m.C=Ja(p(m.Za,m),6e3));if(1>=Zw(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ts(m,11)}else if((u.K||m.g==u)&&Yc(m),!v(f))for(N=m.Da.g.parse(f),f=0;f<N.length;f++){let ge=N[f];if(m.T=ge[0],ge=ge[1],m.G==2)if(ge[0]=="c"){m.K=ge[1],m.ia=ge[2];const Nt=ge[3];Nt!=null&&(m.la=Nt,m.j.info("VER="+m.la));const bt=ge[4];bt!=null&&(m.Aa=bt,m.j.info("SVER="+m.Aa));const co=ge[5];co!=null&&typeof co=="number"&&0<co&&(g=1.5*co,m.L=g,m.j.info("backChannelRequestTimeoutMs_="+g)),g=m;const On=u.g;if(On){const Xc=On.g?On.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xc){var O=g.h;O.g||Xc.indexOf("spdy")==-1&&Xc.indexOf("quic")==-1&&Xc.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Np(O,O.h),O.h=null))}if(g.D){const Vp=On.g?On.g.getResponseHeader("X-HTTP-Session-Id"):null;Vp&&(g.ya=Vp,Ae(g.I,g.D,Vp))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),g=m;var W=u;if(g.qa=CI(g,g.J?g.ia:null,g.W),W.K){eI(g.h,W);var Ee=W,Tt=g.L;Tt&&(Ee.I=Tt),Ee.B&&(Ap(Ee),zc(Ee)),g.g=W}else wI(g);0<m.i.length&&Qc(m)}else ge[0]!="stop"&&ge[0]!="close"||ts(m,7);else m.G==3&&(ge[0]=="stop"||ge[0]=="close"?ge[0]=="stop"?ts(m,7):xp(m):ge[0]!="noop"&&m.l&&m.l.ta(ge),m.v=0)}}Ya(4)}catch{}}var cb=class{constructor(u,f){this.g=u,this.map=f}};function Jw(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xw(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Zw(u){return u.h?1:u.g?u.g.size:0}function kp(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function Np(u,f){u.g?u.g.add(f):u.h=f}function eI(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}Jw.prototype.cancel=function(){if(this.i=tI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function tI(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(const m of u.g.values())f=f.concat(m.D);return f}return C(u.i)}function hb(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var f=[],m=u.length,g=0;g<m;g++)f.push(u[g]);return f}f=[],m=0;for(g in u)f[m++]=u[g];return f}function db(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(const g in u)f[m++]=g;return f}}}function nI(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=db(u),g=hb(u),N=g.length,O=0;O<N;O++)f.call(void 0,g[O],m&&m[O],u)}var rI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fb(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var g=u[m].indexOf("="),N=null;if(0<=g){var O=u[m].substring(0,g);N=u[m].substring(g+1)}else O=u[m];f(O,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function es(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof es){this.h=u.h,qc(this,u.j),this.o=u.o,this.g=u.g,$c(this,u.s),this.l=u.l;var f=u.i,m=new nl;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),iI(this,m),this.m=u.m}else u&&(f=String(u).match(rI))?(this.h=!1,qc(this,f[1]||"",!0),this.o=el(f[2]||""),this.g=el(f[3]||"",!0),$c(this,f[4]),this.l=el(f[5]||"",!0),iI(this,f[6]||"",!0),this.m=el(f[7]||"")):(this.h=!1,this.i=new nl(null,this.h))}es.prototype.toString=function(){var u=[],f=this.j;f&&u.push(tl(f,sI,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(tl(f,sI,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(tl(m,m.charAt(0)=="/"?gb:mb,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",tl(m,yb)),u.join("")};function vr(u){return new es(u)}function qc(u,f,m){u.j=m?el(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function $c(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function iI(u,f,m){f instanceof nl?(u.i=f,vb(u.i,u.h)):(m||(f=tl(f,_b)),u.i=new nl(f,u.h))}function Ae(u,f,m){u.i.set(f,m)}function Wc(u){return Ae(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function el(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function tl(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,pb),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function pb(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var sI=/[#\/\?@]/g,mb=/[#\?:]/g,gb=/[#\?]/g,_b=/[#\?@]/g,yb=/#/g;function nl(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Xr(u){u.g||(u.g=new Map,u.h=0,u.i&&fb(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=nl.prototype,n.add=function(u,f){Xr(this),this.i=null,u=lo(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function oI(u,f){Xr(u),f=lo(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function aI(u,f){return Xr(u),f=lo(u,f),u.g.has(f)}n.forEach=function(u,f){Xr(this),this.g.forEach(function(m,g){m.forEach(function(N){u.call(f,N,g,this)},this)},this)},n.na=function(){Xr(this);const u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let g=0;g<f.length;g++){const N=u[g];for(let O=0;O<N.length;O++)m.push(f[g])}return m},n.V=function(u){Xr(this);let f=[];if(typeof u=="string")aI(this,u)&&(f=f.concat(this.g.get(lo(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return Xr(this),this.i=null,u=lo(this,u),aI(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function lI(u,f,m){oI(u,f),0<m.length&&(u.i=null,u.g.set(lo(u,f),C(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var g=f[m];const O=encodeURIComponent(String(g)),W=this.V(g);for(g=0;g<W.length;g++){var N=O;W[g]!==""&&(N+="="+encodeURIComponent(String(W[g]))),u.push(N)}}return this.i=u.join("&")};function lo(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function vb(u,f){f&&!u.j&&(Xr(u),u.i=null,u.g.forEach(function(m,g){var N=g.toLowerCase();g!=N&&(oI(this,g),lI(this,N,m))},u)),u.j=f}function wb(u,f){const m=new Xa;if(a.Image){const g=new Image;g.onload=_(Zr,m,"TestLoadImage: loaded",!0,f,g),g.onerror=_(Zr,m,"TestLoadImage: error",!1,f,g),g.onabort=_(Zr,m,"TestLoadImage: abort",!1,f,g),g.ontimeout=_(Zr,m,"TestLoadImage: timeout",!1,f,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else f(!1)}function Ib(u,f){const m=new Xa,g=new AbortController,N=setTimeout(()=>{g.abort(),Zr(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:g.signal}).then(O=>{clearTimeout(N),O.ok?Zr(m,"TestPingServer: ok",!0,f):Zr(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(N),Zr(m,"TestPingServer: error",!1,f)})}function Zr(u,f,m,g,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),g(m)}catch{}}function Eb(){this.g=new ib}function Tb(u,f,m){const g=m||"";try{nI(u,function(N,O){let W=N;c(N)&&(W=wp(N)),f.push(g+O+"="+encodeURIComponent(W))})}catch(N){throw f.push(g+"type="+encodeURIComponent("_badmap")),N}}function rl(u){this.l=u.Ub||null,this.j=u.eb||!1}E(rl,Ip),rl.prototype.g=function(){return new Gc(this.l,this.j)},rl.prototype.i=function(u){return function(){return u}}({});function Gc(u,f){kt.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Gc,kt),n=Gc.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,sl(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,il(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,sl(this)),this.g&&(this.readyState=3,sl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;uI(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function uI(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?il(this):sl(this),this.readyState==3&&uI(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,il(this))},n.Qa=function(u){this.g&&(this.response=u,il(this))},n.ga=function(){this.g&&il(this)};function il(u){u.readyState=4,u.l=null,u.j=null,u.v=null,sl(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function sl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Gc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function cI(u){let f="";return M(u,function(m,g){f+=g,f+=":",f+=m,f+=`\r
`}),f}function bp(u,f,m){e:{for(g in m){var g=!1;break e}g=!0}g||(m=cI(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):Ae(u,f,m))}function qe(u){kt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(qe,kt);var Sb=/^https?$/i,Cb=["POST","PUT"];n=qe.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Sp.g(),this.v=this.o?Uw(this.o):Uw(Sp),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(O){hI(this,O);return}if(u=m||"",m=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var N in g)m.set(N,g[N]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const O of g.keys())m.set(O,g.get(O));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(m.keys()).find(O=>O.toLowerCase()=="content-type"),N=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Cb,f,void 0))||g||N||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,W]of m)this.g.setRequestHeader(O,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pI(this),this.u=!0,this.g.send(u),this.u=!1}catch(O){hI(this,O)}};function hI(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,dI(u),Kc(u)}function dI(u){u.A||(u.A=!0,Bt(u,"complete"),Bt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Bt(this,"complete"),Bt(this,"abort"),Kc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kc(this,!0)),qe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?fI(this):this.bb())},n.bb=function(){fI(this)};function fI(u){if(u.h&&typeof o<"u"&&(!u.v[1]||wr(u)!=4||u.Z()!=2)){if(u.u&&wr(u)==4)Vw(u.Ea,0,u);else if(Bt(u,"readystatechange"),wr(u)==4){u.h=!1;try{const W=u.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var g;if(g=W===0){var N=String(u.D).match(rI)[1]||null;!N&&a.self&&a.self.location&&(N=a.self.location.protocol.slice(0,-1)),g=!Sb.test(N?N.toLowerCase():"")}m=g}if(m)Bt(u,"complete"),Bt(u,"success");else{u.m=6;try{var O=2<wr(u)?u.g.statusText:""}catch{O=""}u.l=O+" ["+u.Z()+"]",dI(u)}}finally{Kc(u)}}}}function Kc(u,f){if(u.g){pI(u);const m=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||Bt(u,"ready");try{m.onreadystatechange=g}catch{}}}function pI(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function wr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<wr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),rb(f)}};function mI(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Rb(u){const f={};u=(u.g&&2<=wr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if(v(u[g]))continue;var m=k(u[g]);const N=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const O=f[N]||[];f[N]=O,O.push(m)}T(f,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ol(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function gI(u){this.Aa=0,this.i=[],this.j=new Xa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ol("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ol("baseRetryDelayMs",5e3,u),this.cb=ol("retryDelaySeedMs",1e4,u),this.Wa=ol("forwardChannelMaxRetries",2,u),this.wa=ol("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Jw(u&&u.concurrentRequestLimit),this.Da=new Eb,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=gI.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,g){jt(0),this.W=u,this.H=f||{},m&&g!==void 0&&(this.H.OSID=m,this.H.OAID=g),this.F=this.X,this.I=CI(this,null,this.W),Qc(this)};function xp(u){if(_I(u),u.G==3){var f=u.U++,m=vr(u.I);if(Ae(m,"SID",u.K),Ae(m,"RID",f),Ae(m,"TYPE","terminate"),al(u,m),f=new Jr(u,u.j,f),f.L=2,f.v=Wc(vr(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=RI(f.j,null),f.g.ea(f.v)),f.F=Date.now(),zc(f)}SI(u)}function Hc(u){u.g&&(Op(u),u.g.cancel(),u.g=null)}function _I(u){Hc(u),u.u&&(a.clearTimeout(u.u),u.u=null),Yc(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Qc(u){if(!Xw(u.h)&&!u.s){u.s=!0;var f=u.Ga;mr||se(),H||(mr(),H=!0),te.add(f,u),u.B=0}}function Ab(u,f){return Zw(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ja(p(u.Ga,u,f),TI(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const N=new Jr(this,this.j,u);let O=this.o;if(this.S&&(O?(O=y(O),R(O,this.S)):O=this.S),this.m!==null||this.O||(N.H=O,O=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var g=this.i[m];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(f+=g,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=vI(this,N,f),m=vr(this.I),Ae(m,"RID",u),Ae(m,"CVER",22),this.D&&Ae(m,"X-HTTP-Session-Id",this.D),al(this,m),O&&(this.O?f="headers="+encodeURIComponent(String(cI(O)))+"&"+f:this.m&&bp(m,this.m,O)),Np(this.h,N),this.Ua&&Ae(m,"TYPE","init"),this.P?(Ae(m,"$req",f),Ae(m,"SID","null"),N.T=!0,Rp(N,m,null)):Rp(N,m,f),this.G=2}}else this.G==3&&(u?yI(this,u):this.i.length==0||Xw(this.h)||yI(this))};function yI(u,f){var m;f?m=f.l:m=u.U++;const g=vr(u.I);Ae(g,"SID",u.K),Ae(g,"RID",m),Ae(g,"AID",u.T),al(u,g),u.m&&u.o&&bp(g,u.m,u.o),m=new Jr(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=vI(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Np(u.h,m),Rp(m,g,f)}function al(u,f){u.H&&M(u.H,function(m,g){Ae(f,g,m)}),u.l&&nI({},function(m,g){Ae(f,g,m)})}function vI(u,f,m){m=Math.min(u.i.length,m);var g=u.l?p(u.l.Na,u.l,u):null;e:{var N=u.i;let O=-1;for(;;){const W=["count="+m];O==-1?0<m?(O=N[0].g,W.push("ofs="+O)):O=0:W.push("ofs="+O);let Ee=!0;for(let Tt=0;Tt<m;Tt++){let ge=N[Tt].g;const Nt=N[Tt].map;if(ge-=O,0>ge)O=Math.max(0,N[Tt].g-100),Ee=!1;else try{Tb(Nt,W,"req"+ge+"_")}catch{g&&g(Nt)}}if(Ee){g=W.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,g}function wI(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;mr||se(),H||(mr(),H=!0),te.add(f,u),u.v=0}}function Dp(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ja(p(u.Fa,u),TI(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,II(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ja(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,jt(10),Hc(this),II(this))};function Op(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function II(u){u.g=new Jr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=vr(u.qa);Ae(f,"RID","rpc"),Ae(f,"SID",u.K),Ae(f,"AID",u.T),Ae(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ae(f,"TO",u.ja),Ae(f,"TYPE","xmlhttp"),al(u,f),u.m&&u.o&&bp(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Wc(vr(f)),m.m=null,m.P=!0,Hw(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Hc(this),Dp(this),jt(19))};function Yc(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function EI(u,f){var m=null;if(u.g==f){Yc(u),Op(u),u.g=null;var g=2}else if(kp(u.h,f))m=f.D,eI(u.h,f),g=1;else return;if(u.G!=0){if(f.o)if(g==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var N=u.B;g=Uc(),Bt(g,new $w(g,m)),Qc(u)}else wI(u);else if(N=f.s,N==3||N==0&&0<f.X||!(g==1&&Ab(u,f)||g==2&&Dp(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),N){case 1:ts(u,5);break;case 4:ts(u,10);break;case 3:ts(u,6);break;default:ts(u,2)}}}function TI(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function ts(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),g=u.Xa;const N=!g;g=new es(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||qc(g,"https"),Wc(g),N?wb(g.toString(),m):Ib(g.toString(),m)}else jt(2);u.G=0,u.l&&u.l.sa(f),SI(u),_I(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),jt(2)):(this.j.info("Failed to ping google.com"),jt(1))};function SI(u){if(u.G=0,u.ka=[],u.l){const f=tI(u.h);(f.length!=0||u.i.length!=0)&&(P(u.ka,f),P(u.ka,u.i),u.h.i.length=0,C(u.i),u.i.length=0),u.l.ra()}}function CI(u,f,m){var g=m instanceof es?vr(m):new es(m);if(g.g!="")f&&(g.g=f+"."+g.g),$c(g,g.s);else{var N=a.location;g=N.protocol,f=f?f+"."+N.hostname:N.hostname,N=+N.port;var O=new es(null);g&&qc(O,g),f&&(O.g=f),N&&$c(O,N),m&&(O.l=m),g=O}return m=u.D,f=u.ya,m&&f&&Ae(g,m,f),Ae(g,"VER",u.la),al(u,g),g}function RI(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new qe(new rl({eb:m})):new qe(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function AI(){}n=AI.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Jc(){}Jc.prototype.g=function(u,f){return new dn(u,f)};function dn(u,f){kt.call(this),this.g=new gI(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!v(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!v(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new uo(this)}E(dn,kt),dn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){xp(this.g)},dn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=wp(u),u=m);f.i.push(new cb(f.Ya++,u)),f.G==3&&Qc(f)},dn.prototype.N=function(){this.g.l=null,delete this.j,xp(this.g),delete this.g,dn.aa.N.call(this)};function PI(u){Ep.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(const m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}E(PI,Ep);function kI(){Tp.call(this),this.status=1}E(kI,Tp);function uo(u){this.g=u}E(uo,AI),uo.prototype.ua=function(){Bt(this.g,"a")},uo.prototype.ta=function(u){Bt(this.g,new PI(u))},uo.prototype.sa=function(u){Bt(this.g,new kI)},uo.prototype.ra=function(){Bt(this.g,"b")},Jc.prototype.createWebChannel=Jc.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,vA=function(){return new Jc},yA=function(){return Uc()},_A=Xi,xg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bc.NO_ERROR=0,Bc.TIMEOUT=8,Bc.HTTP_ERROR=6,Fh=Bc,Ww.COMPLETE="complete",gA=Ww,Bw.EventType=Qa,Qa.OPEN="a",Qa.CLOSE="b",Qa.ERROR="c",Qa.MESSAGE="d",kt.prototype.listen=kt.prototype.K,Vl=Bw,mA=rl,qe.prototype.listenOnce=qe.prototype.L,qe.prototype.getLastError=qe.prototype.Ka,qe.prototype.getLastErrorCode=qe.prototype.Ba,qe.prototype.getStatus=qe.prototype.Z,qe.prototype.getResponseJson=qe.prototype.Oa,qe.prototype.getResponseText=qe.prototype.oa,qe.prototype.send=qe.prototype.ea,qe.prototype.setWithCredentials=qe.prototype.Ha,pA=qe}).apply(typeof gh<"u"?gh:typeof self<"u"?self:typeof window<"u"?window:{});const iT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa="10.12.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=new cc("@firebase/firestore");function vo(){return Di.logLevel}function ZL(n){Di.setLogLevel(n)}function U(n,...e){if(Di.logLevel<=oe.DEBUG){const t=e.map(by);Di.debug(`Firestore (${Oa}): ${n}`,...t)}}function tt(n,...e){if(Di.logLevel<=oe.ERROR){const t=e.map(by);Di.error(`Firestore (${Oa}): ${n}`,...t)}}function Qn(n,...e){if(Di.logLevel<=oe.WARN){const t=e.map(by);Di.warn(`Firestore (${Oa}): ${n}`,...t)}}function by(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(n="Unexpected state"){const e=`FIRESTORE (${Oa}) INTERNAL ASSERTION FAILED: `+n;throw tt(e),new Error(e)}function J(n,e){n||Q()}function eM(n,e){n||Q()}function K(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class F extends Gt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(mt.UNAUTHENTICATED))}shutdown(){}}class nM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rM{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new vt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vt)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(J(typeof r.accessToken=="string"),new wA(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string"),new mt(e)}}class iM{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class sM{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new iM(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class oM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(J(typeof t.token=="string"),this.R=t.token,new oM(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=lM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(n,e){return n<e?-1:n>e?1:0}function ha(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function EA(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ve.fromMillis(Date.now())}static fromDate(e){return Ve.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Ve(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new Ve(0,0))}static max(){return new X(new Ve(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t,r){t===void 0?t=0:t>e.length&&Q(),r===void 0?r=e.length-t:r>e.length-t&&Q(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Du.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Du?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ce extends Du{construct(e,t,r){return new ce(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new F(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ce(t)}static emptyPath(){return new ce([])}}const uM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class De extends Du{construct(e,t,r){return new De(e,t,r)}static isValidIdentifier(e){return uM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),De.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new De(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new F(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new F(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new F(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new F(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new De(t)}static emptyPath(){return new De([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.path=e}static fromPath(e){return new G(ce.fromString(e))}static fromName(e){return new G(ce.fromString(e).popFirst(5))}static empty(){return new G(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new ce(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Dg(n){return n.fields.find(e=>e.kind===2)}function os(n){return n.fields.filter(e=>e.kind!==2)}Ad.UNKNOWN_ID=-1;class Uh{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ou{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ou(0,En.min())}}function TA(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=X.fromTimestamp(r===1e9?new Ve(t+1,0):new Ve(t,r));return new En(i,G.empty(),e)}function SA(n){return new En(n.readTime,n.key,-1)}class En{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new En(X.min(),G.empty(),-1)}static max(){return new En(X.max(),G.empty(),-1)}}function xy(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=G.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class RA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ki(n){if(n.code!==V.FAILED_PRECONDITION||n.message!==CA)throw n;U("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new x((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof x?t:x.resolve(t)}catch(t){return x.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):x.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):x.reject(t)}static resolve(e){return new x((t,r)=>{t(e)})}static reject(e){return new x((t,r)=>{r(e)})}static waitFor(e){return new x((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=x.resolve(!1);for(const r of e)t=t.next(i=>i?x.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new x((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new x((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new vt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ql(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Dy(r.target.error);this.V.reject(new Ql(e,i))}}static open(e,t,r,i){try{return new Af(t,e.transaction(i,r))}catch(s){throw new Ql(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new hM(t)}}class cr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,cr.S(Le())===12.2&&tt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),ls(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Pu())return!1;if(cr.C())return!0;const e=Le(),t=cr.S(e),r=0<t&&t<10,i=AA(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(U("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new Ql(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new F(V.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new F(V.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ql(e,o))},i.onupgradeneeded=s=>{U("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{U("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Af.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),x.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(U("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function AA(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class cM{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ls(this.B.delete())}}class Ql extends F{constructor(e,t){super(V.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Hi(n){return n.name==="IndexedDbTransactionError"}class hM{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ls(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),ls(this.store.add(e))}get(e){return ls(this.store.get(e)).next(t=>(t===void 0&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),ls(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),ls(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new x((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new x((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){U("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new x((r,i)=>{t.onerror=s=>{const o=Dy(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new x((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new cM(a),c=t(a.primaryKey,a.value,l);if(c instanceof x){const h=c.catch(d=>(l.done(),x.reject(d)));r.push(h)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>x.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ls(n){return new x((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Dy(r.target.error);t(i)}})}let sT=!1;function Dy(n){const e=cr.S(Le());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new F("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return sT||(sT=!0,setTimeout(()=>{throw r},0)),r}}return n}class dM{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){U("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{U("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Hi(t)?U("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ki(t)}await this.X(6e4)})}}class fM{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let i=t,s=!0;return x.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return U("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(U("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=SA(s);xy(o,r)>0&&(r=o)}),new En(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}nn.oe=-1;function hc(n){return n==null}function Vu(n){return n===0&&1/n==-1/0}function PA(n){return typeof n=="number"&&Number.isInteger(n)&&!Vu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=oT(e)),e=pM(n.get(t),e);return oT(e)}function pM(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function oT(n){return n+""}function sr(n){const e=n.length;if(J(e>=2),e===2)return J(n.charAt(0)===""&&n.charAt(1)===""),ce.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("",s);switch((o<0||o>t)&&Q(),n.charAt(o+1)){case"":const a=n.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Q()}s=o+2}return new ce(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(n,e){return[n,Kt(e)]}function kA(n,e,t){return[n,Kt(e),t]}const mM={},gM=["prefixPath","collectionGroup","readTime","documentId"],_M=["prefixPath","collectionGroup","documentId"],yM=["collectionGroup","readTime","prefixPath","documentId"],vM=["canonicalId","targetId"],wM=["targetId","path"],IM=["path","targetId"],EM=["collectionId","parent"],TM=["indexId","uid"],SM=["uid","sequenceNumber"],CM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],RM=["indexId","uid","orderedDocumentKey"],AM=["userId","collectionPath","documentId"],PM=["userId","collectionPath","largestBatchId"],kM=["userId","collectionGroup","largestBatchId"],NA=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],NM=[...NA,"documentOverlays"],bA=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],xA=bA,DA=[...xA,"indexConfiguration","indexState","indexEntries"],bM=DA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og extends RA{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function It(n,e){const t=K(n);return cr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Zs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function OA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ze=class Vg{constructor(e,t){this.comparator=e,this.root=t||Ri.EMPTY}insert(e,t){return new Vg(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ri.BLACK,null,null))}remove(e){return new Vg(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ri.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _h(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _h(this.root,e,this.comparator,!1)}getReverseIterator(){return new _h(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _h(this.root,e,this.comparator,!0)}},_h=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ri=class Ir{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Ir.RED,this.left=i??Ir.EMPTY,this.right=s??Ir.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Ir(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ir.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ir.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ir.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ir.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}};Ri.EMPTY=null,Ri.RED=!0,Ri.BLACK=!1;Ri.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ri(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uT(this.data.getIterator())}getIteratorFrom(e){return new uT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof we)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new we(this.comparator);return t.data=e,t}}class uT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fo(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.fields=e,e.sort(De.comparator)}static empty(){return new rn([])}unionWith(e){let t=new we(De.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new rn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ha(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new VA("Invalid base64 string: "+s):s}}(e);return new ht(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ht(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const DM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ur(n){if(J(!!n),typeof n=="string"){let e=0;const t=DM.exec(n);if(J(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:We(n.seconds),nanos:We(n.nanos)}}function We(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Oi(n){return typeof n=="string"?ht.fromBase64String(n):ht.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Oy(n){const e=n.mapValue.fields.__previous_value__;return Pf(e)?Oy(e):e}function Lu(n){const e=Ur(n.mapValue.fields.__local_write_time__.timestampValue);return new Ve(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,t,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Vi{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Vi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Vi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},jh={nullValue:"NULL_VALUE"};function xs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Pf(n)?4:LA(n)?9007199254740991:10:Q()}function dr(n,e){if(n===e)return!0;const t=xs(n);if(t!==xs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Lu(n).isEqual(Lu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ur(i.timestampValue),a=Ur(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Oi(i.bytesValue).isEqual(Oi(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return We(i.geoPointValue.latitude)===We(s.geoPointValue.latitude)&&We(i.geoPointValue.longitude)===We(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return We(i.integerValue)===We(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=We(i.doubleValue),a=We(s.doubleValue);return o===a?Vu(o)===Vu(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ha(n.arrayValue.values||[],e.arrayValue.values||[],dr);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(lT(o)!==lT(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!dr(o[l],a[l])))return!1;return!0}(n,e);default:return Q()}}function Mu(n,e){return(n.values||[]).find(t=>dr(t,e))!==void 0}function Li(n,e){if(n===e)return 0;const t=xs(n),r=xs(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=We(s.integerValue||s.doubleValue),l=We(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return cT(n.timestampValue,e.timestampValue);case 4:return cT(Lu(n),Lu(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Oi(s),l=Oi(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=ne(a[c],l[c]);if(h!==0)return h}return ne(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ne(We(s.latitude),We(o.latitude));return a!==0?a:ne(We(s.longitude),We(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){const h=Li(a[c],l[c]);if(h)return h}return ne(a.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===pi.mapValue&&o===pi.mapValue)return 0;if(s===pi.mapValue)return 1;if(o===pi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const p=ne(l[d],h[d]);if(p!==0)return p;const _=Li(a[l[d]],c[h[d]]);if(_!==0)return _}return ne(l.length,h.length)}(n.mapValue,e.mapValue);default:throw Q()}}function cT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);const t=Ur(n),r=Ur(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function da(n){return Lg(n)}function Lg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ur(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Oi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return G.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Lg(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Lg(t.fields[o])}`;return i+"}"}(n.mapValue):Q()}function Ds(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Mg(n){return!!n&&"integerValue"in n}function Fu(n){return!!n&&"arrayValue"in n}function hT(n){return!!n&&"nullValue"in n}function dT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function zh(n){return!!n&&"mapValue"in n}function Yl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Zs(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Yl(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Yl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function LA(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function VM(n){return"nullValue"in n?jh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ds(Vi.empty(),G.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Q()}function LM(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ds(Vi.empty(),G.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?pi:Q()}function fT(n,e){const t=Li(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function pT(n,e){const t=Li(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.value=e}static empty(){return new Ct({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!zh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yl(t)}setAll(e){let t=De.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Yl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());zh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];zh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Zs(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ct(Yl(this.value))}}function MA(n){const e=[];return Zs(n.fields,(t,r)=>{const i=new De([t]);if(zh(r)){const s=MA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ne(e,0,X.min(),X.min(),X.min(),Ct.empty(),0)}static newFoundDocument(e,t,r,i){return new Ne(e,1,t,X.min(),r,i,0)}static newNoDocument(e,t){return new Ne(e,2,t,X.min(),X.min(),Ct.empty(),0)}static newUnknownDocument(e,t){return new Ne(e,3,t,X.min(),X.min(),Ct.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ct.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ct.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ne&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ne(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t){this.position=e,this.inclusive=t}}function mT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),t.key):r=Li(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function gT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,t="asc"){this.field=e,this.dir=t}}function MM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{}class he extends FA{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new FM(e,t,r):t==="array-contains"?new jM(e,r):t==="in"?new $A(e,r):t==="not-in"?new zM(e,r):t==="array-contains-any"?new qM(e,r):new he(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new UM(e,r):new BM(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Li(t,this.value)):t!==null&&xs(this.value)===xs(t)&&this.matchesComparison(Li(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ye extends FA{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ye(e,t)}matches(e){return fa(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fa(n){return n.op==="and"}function Fg(n){return n.op==="or"}function Vy(n){return UA(n)&&fa(n)}function UA(n){for(const e of n.filters)if(e instanceof ye)return!1;return!0}function Ug(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+da(n.value);if(Vy(n))return n.filters.map(e=>Ug(e)).join(",");{const e=n.filters.map(t=>Ug(t)).join(",");return`${n.op}(${e})`}}function BA(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&dr(r.value,i.value)}(n,e):n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&BA(o,i.filters[a]),!0):!1}(n,e):void Q()}function jA(n,e){const t=n.filters.concat(e);return ye.create(t,n.op)}function zA(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${da(t.value)}`}(n):n instanceof ye?function(t){return t.op.toString()+" {"+t.getFilters().map(zA).join(" ,")+"}"}(n):"Filter"}class FM extends he{constructor(e,t,r){super(e,t,r),this.key=G.fromName(r.referenceValue)}matches(e){const t=G.comparator(e.key,this.key);return this.matchesComparison(t)}}class UM extends he{constructor(e,t){super(e,"in",t),this.keys=qA("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class BM extends he{constructor(e,t){super(e,"not-in",t),this.keys=qA("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function qA(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>G.fromName(r.referenceValue))}class jM extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Fu(t)&&Mu(t.arrayValue,this.value)}}class $A extends he{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Mu(this.value.arrayValue,t)}}class zM extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Mu(this.value.arrayValue,t)}}class qM extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Fu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Mu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Bg(n,e=null,t=[],r=[],i=null,s=null,o=null){return new $M(n,e,t,r,i,s,o)}function Os(n){const e=K(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ug(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),hc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>da(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>da(r)).join(",")),e.ue=t}return e.ue}function dc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!MM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!BA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gT(n.startAt,e.startAt)&&gT(n.endAt,e.endAt)}function Pd(n){return G.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function kd(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function _T(n,e,t){let r=jh,i=!0;for(const s of kd(n,e)){let o=jh,a=!0;switch(s.op){case"<":case"<=":o=VM(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=jh}fT({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];fT({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function yT(n,e,t){let r=pi,i=!0;for(const s of kd(n,e)){let o=pi,a=!0;switch(s.op){case">=":case">":o=LM(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=pi}pT({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];pT({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function WA(n,e,t,r,i,s,o,a){return new Wr(n,e,t,r,i,s,o,a)}function Va(n){return new Wr(n)}function vT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ly(n){return n.collectionGroup!==null}function Wo(n){const e=K(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new we(De.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Uu(s,r))}),t.has(De.keyField().canonicalString())||e.ce.push(new Uu(De.keyField(),r))}return e.ce}function Ht(n){const e=K(n);return e.le||(e.le=WM(e,Wo(n))),e.le}function WM(n,e){if(n.limitType==="F")return Bg(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Uu(i.field,s)});const t=n.endAt?new Mi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Mi(n.startAt.position,n.startAt.inclusive):null;return Bg(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jg(n,e){const t=n.filters.concat([e]);return new Wr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Nd(n,e,t){return new Wr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function fc(n,e){return dc(Ht(n),Ht(e))&&n.limitType===e.limitType}function GA(n){return`${Os(Ht(n))}|lt:${n.limitType}`}function wo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>zA(i)).join(", ")}]`),hc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>da(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>da(i)).join(",")),`Target(${r})`}(Ht(n))}; limitType=${n.limitType})`}function pc(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Wo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=mT(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Wo(r),i)||r.endAt&&!function(o,a,l){const c=mT(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Wo(r),i))}(n,e)}function KA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function HA(n){return(e,t)=>{let r=!1;for(const i of Wo(n)){const s=GM(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function GM(n,e,t){const r=n.field.isKeyField()?G.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Li(l,c):Q()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zs(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return OA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=new ze(G.comparator);function sn(){return KM}const QA=new ze(G.comparator);function Ll(...n){let e=QA;for(const t of n)e=e.insert(t.key,t);return e}function YA(n){let e=QA;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function or(){return Jl()}function JA(){return Jl()}function Jl(){return new Qi(n=>n.toString(),(n,e)=>n.isEqual(e))}const HM=new ze(G.comparator),QM=new we(G.comparator);function ie(...n){let e=QM;for(const t of n)e=e.add(t);return e}const YM=new we(ne);function My(){return YM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vu(e)?"-0":e}}function ZA(n){return{integerValue:""+n}}function eP(n,e){return PA(e)?ZA(e):XA(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(){this._=void 0}}function JM(n,e,t){return n instanceof pa?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Pf(s)&&(s=Oy(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Vs?nP(n,e):n instanceof Ls?rP(n,e):function(i,s){const o=tP(i,s),a=wT(o)+wT(i.Pe);return Mg(o)&&Mg(i.Pe)?ZA(a):XA(i.serializer,a)}(n,e)}function XM(n,e,t){return n instanceof Vs?nP(n,e):n instanceof Ls?rP(n,e):t}function tP(n,e){return n instanceof ma?function(r){return Mg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class pa extends kf{}class Vs extends kf{constructor(e){super(),this.elements=e}}function nP(n,e){const t=iP(e);for(const r of n.elements)t.some(i=>dr(i,r))||t.push(r);return{arrayValue:{values:t}}}class Ls extends kf{constructor(e){super(),this.elements=e}}function rP(n,e){let t=iP(e);for(const r of n.elements)t=t.filter(i=>!dr(i,r));return{arrayValue:{values:t}}}class ma extends kf{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function wT(n){return We(n.integerValue||n.doubleValue)}function iP(n){return Fu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t){this.field=e,this.transform=t}}function ZM(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Vs&&i instanceof Vs||r instanceof Ls&&i instanceof Ls?ha(r.elements,i.elements,dr):r instanceof ma&&i instanceof ma?dr(r.Pe,i.Pe):r instanceof pa&&i instanceof pa}(n.transform,e.transform)}class e2{constructor(e,t){this.version=e,this.transformResults=t}}class Oe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Nf{}function sP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ma(n.key,Oe.none()):new La(n.key,n.data,Oe.none());{const t=n.data,r=Ct.empty();let i=new we(De.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gr(n.key,r,new rn(i.toArray()),Oe.none())}}function t2(n,e,t){n instanceof La?function(i,s,o){const a=i.value.clone(),l=ET(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Gr?function(i,s,o){if(!qh(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=ET(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(oP(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Xl(n,e,t,r){return n instanceof La?function(s,o,a,l){if(!qh(s.precondition,o))return a;const c=s.value.clone(),h=TT(s.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Gr?function(s,o,a,l){if(!qh(s.precondition,o))return a;const c=TT(s.fieldTransforms,l,o),h=o.data;return h.setAll(oP(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(n,e,t,r):function(s,o,a){return qh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function n2(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=tP(r.transform,i||null);s!=null&&(t===null&&(t=Ct.empty()),t.set(r.field,s))}return t||null}function IT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ha(r,i,(s,o)=>ZM(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class La extends Nf{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Gr extends Nf{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function oP(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function ET(n,e,t){const r=new Map;J(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,XM(o,a,t[i]))}return r}function TT(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,JM(s,o,e))}return r}class Ma extends Nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Fy extends Nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&t2(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Xl(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Xl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=JA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=sP(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&ha(this.mutations,e.mutations,(t,r)=>IT(t,r))&&ha(this.baseMutations,e.baseMutations,(t,r)=>IT(t,r))}}class By{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){J(e.mutations.length===r.length);let i=function(){return HM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new By(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt,fe;function aP(n){switch(n){default:return Q();case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0}}function lP(n){if(n===void 0)return tt("GRPC error has no .code"),V.UNKNOWN;switch(n){case rt.OK:return V.OK;case rt.CANCELLED:return V.CANCELLED;case rt.UNKNOWN:return V.UNKNOWN;case rt.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case rt.INTERNAL:return V.INTERNAL;case rt.UNAVAILABLE:return V.UNAVAILABLE;case rt.UNAUTHENTICATED:return V.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case rt.NOT_FOUND:return V.NOT_FOUND;case rt.ALREADY_EXISTS:return V.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return V.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case rt.ABORTED:return V.ABORTED;case rt.OUT_OF_RANGE:return V.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return V.UNIMPLEMENTED;case rt.DATA_LOSS:return V.DATA_LOSS;default:return Q()}}(fe=rt||(rt={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=new Es([4294967295,4294967295],0);function ST(n){const e=uP().encode(n),t=new fA;return t.update(e),new Uint8Array(t.digest())}function CT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Es([t,r],0),new Es([i,s],0)]}class zy{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ml(`Invalid padding: ${t}`);if(r<0)throw new Ml(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ml(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ml(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Es.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Es.fromNumber(r)));return i.compare(i2)===1&&(i=new Es([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=ST(e),[r,i]=CT(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new zy(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=ST(e),[r,i]=CT(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ml extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,_c.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new gc(X.min(),i,new ze(ne),sn(),ie())}}class _c{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new _c(r,t,ie(),ie(),ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class cP{constructor(e,t){this.targetId=e,this.me=t}}class hP{constructor(e,t,r=ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class RT{constructor(){this.fe=0,this.ge=PT(),this.pe=ht.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ie(),t=ie(),r=ie();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Q()}}),new _c(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=PT()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,J(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class s2{constructor(e){this.Le=e,this.Be=new Map,this.ke=sn(),this.qe=AT(),this.Qe=new ze(ne)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(Pd(s))if(r===0){const o=new G(s.path);this.Ue(t,o,Ne.newNoDocument(o,X.min()))}else J(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Oi(r).toUint8Array()}catch(l){if(l instanceof VA)return Qn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new zy(o,i,s)}catch(l){return Qn(l instanceof Ml?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&Pd(a.target)){const l=new G(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ne.newNoDocument(l,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ie();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new gc(e,t,this.Qe,this.ke,r);return this.ke=sn(),this.qe=AT(),this.Qe=new ze(ne),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new RT,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new we(ne),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new RT),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function AT(){return new ze(G.comparator)}function PT(){return new ze(G.comparator)}const o2=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),a2=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),l2=(()=>({and:"AND",or:"OR"}))();class u2{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zg(n,e){return n.useProto3Json||hc(e)?e:{value:e}}function ga(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function c2(n,e){return ga(n,e.toTimestamp())}function nt(n){return J(!!n),X.fromTimestamp(function(t){const r=Ur(t);return new Ve(r.seconds,r.nanos)}(n))}function qy(n,e){return qg(n,e).canonicalString()}function qg(n,e){const t=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function fP(n){const e=ce.fromString(n);return J(TP(e)),e}function Bu(n,e){return qy(n.databaseId,e.path)}function hr(n,e){const t=fP(e);if(t.get(1)!==n.databaseId.projectId)throw new F(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new G(gP(t))}function pP(n,e){return qy(n.databaseId,e)}function mP(n){const e=fP(n);return e.length===4?ce.emptyPath():gP(e)}function $g(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function gP(n){return J(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function kT(n,e,t){return{name:Bu(n,e),fields:t.value.mapValue.fields}}function _P(n,e,t){const r=hr(n,e.name),i=nt(e.updateTime),s=e.createTime?nt(e.createTime):X.min(),o=new Ct({mapValue:{fields:e.fields}}),a=Ne.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function h2(n,e){return"found"in e?function(r,i){J(!!i.found),i.found.name,i.found.updateTime;const s=hr(r,i.found.name),o=nt(i.found.updateTime),a=i.found.createTime?nt(i.found.createTime):X.min(),l=new Ct({mapValue:{fields:i.found.fields}});return Ne.newFoundDocument(s,o,a,l)}(n,e):"missing"in e?function(r,i){J(!!i.missing),J(!!i.readTime);const s=hr(r,i.missing),o=nt(i.readTime);return Ne.newNoDocument(s,o)}(n,e):Q()}function d2(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?(J(h===void 0||typeof h=="string"),ht.fromBase64String(h||"")):(J(h===void 0||h instanceof Buffer||h instanceof Uint8Array),ht.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?V.UNKNOWN:lP(c.code);return new F(h,c.message||"")}(o);t=new hP(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=hr(n,r.document.name),s=nt(r.document.updateTime),o=r.document.createTime?nt(r.document.createTime):X.min(),a=new Ct({mapValue:{fields:r.document.fields}}),l=Ne.newFoundDocument(i,s,o,a),c=r.targetIds||[],h=r.removedTargetIds||[];t=new $h(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=hr(n,r.document),s=r.readTime?nt(r.readTime):X.min(),o=Ne.newNoDocument(i,s),a=r.removedTargetIds||[];t=new $h([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=hr(n,r.document),s=r.removedTargetIds||[];t=new $h([],s,i,null)}else{if(!("filter"in e))return Q();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new r2(i,s),a=r.targetId;t=new cP(a,o)}}return t}function ju(n,e){let t;if(e instanceof La)t={update:kT(n,e.key,e.value)};else if(e instanceof Ma)t={delete:Bu(n,e.key)};else if(e instanceof Gr)t={update:kT(n,e.key,e.data),updateMask:y2(e.fieldMask)};else{if(!(e instanceof Fy))return Q();t={verify:Bu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof pa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Vs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ls)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ma)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Q()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:c2(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Q()}(n,e.precondition)),t}function Wg(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Oe.updateTime(nt(s.updateTime)):s.exists!==void 0?Oe.exists(s.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)J(a.setToServerValue==="REQUEST_TIME"),l=new pa;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Vs(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new Ls(h)}else"increment"in a?l=new ma(o,a.increment):Q();const c=De.fromServerFormat(a.fieldPath);return new mc(c,l)}(n,i)):[];if(e.update){e.update.name;const i=hr(n,e.update.name),s=new Ct({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new rn(c.map(h=>De.fromServerFormat(h)))}(e.updateMask);return new Gr(i,s,o,t,r)}return new La(i,s,t,r)}if(e.delete){const i=hr(n,e.delete);return new Ma(i,t)}if(e.verify){const i=hr(n,e.verify);return new Fy(i,t)}return Q()}function f2(n,e){return n&&n.length>0?(J(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?nt(i.updateTime):nt(s);return o.isEqual(X.min())&&(o=nt(s)),new e2(o,i.transformResults||[])}(t,e))):[]}function yP(n,e){return{documents:[pP(n,e.path)]}}function vP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=pP(n,i);const s=function(c){if(c.length!==0)return EP(ye.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(p){return{field:Io(p.field),direction:m2(p.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=zg(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:i}}function wP(n){let e=mP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){J(r===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(d){const p=IP(d);return p instanceof ye&&Vy(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(p=>function(E){return new Uu(Eo(E.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(d){let p;return p=typeof d=="object"?d.value:d,hc(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(d){const p=!!d.before,_=d.values||[];return new Mi(_,p)}(t.startAt));let c=null;return t.endAt&&(c=function(d){const p=!d.before,_=d.values||[];return new Mi(_,p)}(t.endAt)),WA(e,i,o,s,a,"F",l,c)}function p2(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IP(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Eo(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Eo(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Eo(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Eo(t.unaryFilter.field);return he.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}(n):n.fieldFilter!==void 0?function(t){return he.create(Eo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ye.create(t.compositeFilter.filters.map(r=>IP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Q()}}(t.compositeFilter.op))}(n):Q()}function m2(n){return o2[n]}function g2(n){return a2[n]}function _2(n){return l2[n]}function Io(n){return{fieldPath:n.canonicalString()}}function Eo(n){return De.fromServerFormat(n.fieldPath)}function EP(n){return n instanceof he?function(t){if(t.op==="=="){if(dT(t.value))return{unaryFilter:{field:Io(t.field),op:"IS_NAN"}};if(hT(t.value))return{unaryFilter:{field:Io(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dT(t.value))return{unaryFilter:{field:Io(t.field),op:"IS_NOT_NAN"}};if(hT(t.value))return{unaryFilter:{field:Io(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Io(t.field),op:g2(t.op),value:t.value}}}(n):n instanceof ye?function(t){const r=t.getFilters().map(i=>EP(i));return r.length===1?r[0]:{compositeFilter:{op:_2(t.op),filters:r}}}(n):Q()}function y2(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function TP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t,r,i,s=X.min(),o=X.min(),a=ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Rr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e){this.ct=e}}function v2(n,e){let t;if(e.document)t=_P(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=G.fromSegments(e.noDocument.path),i=Fs(e.noDocument.readTime);t=Ne.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const r=G.fromSegments(e.unknownDocument.path),i=Fs(e.unknownDocument.version);t=Ne.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ve(i[0],i[1]);return X.fromTimestamp(s)}(e.readTime)),t}function NT(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:bd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Bu(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ga(s,o.version.toTimestamp()),createTime:ga(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ms(e.version)};else{if(!e.isUnknownDocument())return Q();r.unknownDocument={path:t.path.toArray(),version:Ms(e.version)}}return r}function bd(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ms(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Fs(n){const e=new Ve(n.seconds,n.nanoseconds);return X.fromTimestamp(e)}function us(n,e){const t=(e.baseMutations||[]).map(s=>Wg(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Wg(n.ct,s)),i=Ve.fromMillis(e.localWriteTimeMs);return new Uy(e.batchId,i,t,r)}function Fl(n){const e=Fs(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Fs(n.lastLimboFreeSnapshotVersion):X.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return J(s.documents.length===1),Ht(Va(mP(s.documents[0])))}(n.query):function(s){return Ht(wP(s))}(n.query),new Rr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ht.fromBase64String(n.resumeToken))}function CP(n,e){const t=Ms(e.snapshotVersion),r=Ms(e.lastLimboFreeSnapshotVersion);let i;i=Pd(e.target)?yP(n.ct,e.target):vP(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Os(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function $y(n){const e=wP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Nd(e,e.limit,"L"):e}function pm(n,e){return new jy(e.largestBatchId,Wg(n.ct,e.overlayMutation))}function bT(n,e){const t=e.path.lastSegment();return[n,Kt(e.path.popLast()),t]}function xT(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ms(r.readTime),documentKey:Kt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{getBundleMetadata(e,t){return DT(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Fs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return DT(e).put(function(i){return{bundleId:i.id,createTime:Ms(nt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return OT(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:$y(s.bundledQuery),readTime:Fs(s.readTime)}}(r)})}saveNamedQuery(e,t){return OT(e).put(function(i){return{name:i.name,readTime:Ms(nt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function DT(n){return It(n,"bundles")}function OT(n){return It(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new bf(e,r)}getOverlay(e,t){return gl(e).get(bT(this.userId,t)).next(r=>r?pm(this.serializer,r):null)}getOverlays(e,t){const r=or();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new jy(t,o);i.push(this.ht(e,a))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(Kt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(gl(e).j("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,t,r){const i=or(),s=Kt(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return gl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=pm(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=or();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,h)=>{const d=pm(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):h.done()}).next(()=>s)}ht(e,t){return gl(e).put(function(i,s,o){const[a,l,c]=bT(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ju(i.ct,o.mutation)}}(this.serializer,this.userId,t))}}function gl(n){return It(n,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(We(e.integerValue));else if("doubleValue"in e){const r=We(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Vu(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Ur(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Oi(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?LA(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Q()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const r=e.fields||{};this.Et(t,55);for(const i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){const r=e.values||[];this.Et(t,50);for(const i of r)this.It(i,t)}gt(e,t){this.Et(t,37),G.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}cs.bt=new cs;function I2(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function VT(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=I2(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}class E2{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{const i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{const i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){const t=this.Bt(e),r=VT(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){const t=this.Bt(e),r=VT(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){const t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class T2{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}}class S2{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class _l{constructor(){this.Gt=new E2,this.zt=new T2(this.Gt),this.jt=new S2(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new hs(this.indexId,this.documentKey,this.arrayValue,r)}}function ti(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=LT(n.arrayValue,e.arrayValue),t!==0?t:(t=LT(n.directionalValue,e.directionalValue),t!==0?t:G.comparator(n.documentKey,e.documentKey)))}function LT(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e){this.Yt=new we((t,r)=>De.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(J(e.collectionGroup===this.collectionId),this.en)return!1;const t=Dg(e);if(t!==void 0&&!this.nn(t))return!1;const r=os(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){const a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.rn(a,l)||!this.sn(this.Zt[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new we(De.comparator);const t=[];for(const r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Uh(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Uh(r.field,0))}for(const r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Uh(r.field,r.dir==="asc"?0:1)));return new Ad(Ad.UNKNOWN_ID,this.collectionId,t,Ou.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RP(n){var e,t;if(J(n instanceof he||n instanceof ye),n instanceof he){if(n instanceof $A){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>he.create(n.field,"==",s)))||[];return ye.create(i,"or")}return n}const r=n.filters.map(i=>RP(i));return ye.create(r,n.op)}function C2(n){if(n.getFilters().length===0)return[];const e=Hg(RP(n));return J(AP(e)),Gg(e)||Kg(e)?[e]:e.getFilters()}function Gg(n){return n instanceof he}function Kg(n){return n instanceof ye&&Vy(n)}function AP(n){return Gg(n)||Kg(n)||function(t){if(t instanceof ye&&Fg(t)){for(const r of t.getFilters())if(!Gg(r)&&!Kg(r))return!1;return!0}return!1}(n)}function Hg(n){if(J(n instanceof he||n instanceof ye),n instanceof he)return n;if(n.filters.length===1)return Hg(n.filters[0]);const e=n.filters.map(r=>Hg(r));let t=ye.create(e,n.op);return t=xd(t),AP(t)?t:(J(t instanceof ye),J(fa(t)),J(t.filters.length>1),t.filters.reduce((r,i)=>Wy(r,i)))}function Wy(n,e){let t;return J(n instanceof he||n instanceof ye),J(e instanceof he||e instanceof ye),t=n instanceof he?e instanceof he?function(i,s){return ye.create([i,s],"and")}(n,e):FT(n,e):e instanceof he?FT(e,n):function(i,s){if(J(i.filters.length>0&&s.filters.length>0),fa(i)&&fa(s))return jA(i,s.getFilters());const o=Fg(i)?i:s,a=Fg(i)?s:i,l=o.filters.map(c=>Wy(c,a));return ye.create(l,"or")}(n,e),xd(t)}function FT(n,e){if(fa(e))return jA(e,n.getFilters());{const t=e.filters.map(r=>Wy(n,r));return ye.create(t,"or")}}function xd(n){if(J(n instanceof he||n instanceof ye),n instanceof he)return n;const e=n.getFilters();if(e.length===1)return xd(e[0]);if(UA(n))return n;const t=e.map(i=>xd(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof ye&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ye.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(){this._n=new Gy}addToCollectionParentIndex(e,t){return this._n.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(En.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(En.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}}class Gy{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new we(ce.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new we(ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new Uint8Array(0);class A2{constructor(e,t){this.databaseId=t,this.an=new Gy,this.un=new Qi(r=>Os(r),(r,i)=>dc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});const s={collectionId:r,parent:Kt(i)};return UT(e).put(s)}return x.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[EA(t),""],!1,!0);return UT(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(sr(o.parent))}return r})}addFieldIndex(e,t){const r=yl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=mo(e);return s.next(a=>{o.put(xT(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=yl(e),i=mo(e),s=po(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=yl(e),r=po(e),i=mo(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return x.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new MT(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=po(e);let i=!0;const s=new Map;return x.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ie();const a=[];return x.forEach(s,(l,c)=>{U("IndexedDbIndexManager",`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(l)} to execute ${Os(t)}`);const h=function(w,D){const L=Dg(D);if(L===void 0)return null;for(const M of kd(w,L.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(c,l),d=function(w,D){const L=new Map;for(const M of os(D))for(const T of kd(w,M.fieldPath))switch(T.op){case"==":case"in":L.set(M.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return L.set(M.fieldPath.canonicalString(),T.value),Array.from(L.values())}return null}(c,l),p=function(w,D){const L=[];let M=!0;for(const T of os(D)){const y=T.kind===0?_T(w,T.fieldPath,w.startAt):yT(w,T.fieldPath,w.startAt);L.push(y.value),M&&(M=y.inclusive)}return new Mi(L,M)}(c,l),_=function(w,D){const L=[];let M=!0;for(const T of os(D)){const y=T.kind===0?yT(w,T.fieldPath,w.endAt):_T(w,T.fieldPath,w.endAt);L.push(y.value),M&&(M=y.inclusive)}return new Mi(L,M)}(c,l),E=this.hn(l,c,p),C=this.hn(l,c,_),P=this.Pn(l,c,d),I=this.In(l.indexId,h,E,p.inclusive,C,_.inclusive,P);return x.forEach(I,v=>r.G(v,t.limit).next(w=>{w.forEach(D=>{const L=G.fromSegments(D.documentKey);o.has(L)||(o=o.add(L),a.push(L))})}))}).next(()=>a)}return x.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=C2(ye.create(e.filters,"and")).map(r=>Bg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let d=0;d<l;++d){const p=t?this.Tn(t[d/c]):yh,_=this.En(e,p,r[d%c],i),E=this.dn(e,p,s[d%c],o),C=a.map(P=>this.En(e,p,P,!0));h.push(...this.createRange(_,E,C))}return h}En(e,t,r,i){const s=new hs(e,G.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){const s=new hs(e,G.empty(),t,r);return i?s.Jt():s}ln(e,t){const r=new MT(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.cn(t);return x.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new we(De.comparator),h=!1;for(const d of l.filters)for(const p of d.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?h=!0:c=c.add(p.field));for(const d of l.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){const r=new _l;for(const i of os(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Ht(i.kind);cs.bt.Pt(s,o)}return r.Wt()}Tn(e){const t=new _l;return cs.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const r=new _l;return cs.bt.Pt(Ds(this.databaseId,t),r.Ht(function(s){const o=os(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new _l);let s=0;for(const o of os(e)){const a=r[s++];for(const l of i)if(this.Vn(t,o.fieldPath)&&Fu(a))i=this.mn(i,o,a);else{const c=l.Ht(o.kind);cs.bt.Pt(a,c)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new _l;l.seed(a.Wt()),cs.bt.Pt(o,l.Ht(t.kind)),s.push(l)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=yl(e),i=mo(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{const o=[];return x.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(h,d){const p=d?new Ou(d.sequenceNumber,new En(Fs(d.readTime),new G(sr(d.documentKey)),d.largestBatchId)):Ou.empty(),_=h.fields.map(([E,C])=>new Uh(De.fromServerFormat(E),C));return new Ad(h.indexId,h.collectionGroup,_,p)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=yl(e),s=mo(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>x.forEach(a,l=>s.put(xT(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return x.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),x.forEach(a,l=>this.pn(e,i,l).next(c=>{const h=this.yn(s,l);return c.isEqual(h)?x.resolve():this.wn(e,s,l,c,h)}))))})}Sn(e,t,r,i){return po(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return po(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){const i=po(e);let s=new we(ti);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new hs(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new we(ti);const i=this.An(t,e);if(i==null)return r;const s=Dg(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Fu(o))for(const a of o.arrayValue.values||[])r=r.add(new hs(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new hs(t.indexId,e.key,yh,i));return r}wn(e,t,r,i,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,c,h,d,p){const _=l.getIterator(),E=c.getIterator();let C=fo(_),P=fo(E);for(;C||P;){let I=!1,v=!1;if(C&&P){const w=h(C,P);w<0?v=!0:w>0&&(I=!0)}else C!=null?v=!0:I=!0;I?(d(P),P=fo(E)):v?(p(C),C=fo(_)):(C=fo(_),P=fo(E))}}(i,s,ti,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),x.waitFor(o)}gn(e){let t=1;return mo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ti(o,a)).filter((o,a,l)=>!a||ti(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=ti(o,e),l=ti(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&l<0)i.push(o),i.push(o.Jt());else if(l>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,yh,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,yh,[]];s.push(IDBKeyRange.bound(a,l))}return s}Dn(e,t){return ti(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(BT)}getMinOffset(e,t){return x.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||Q())).next(BT)}}function UT(n){return It(n,"collectionParents")}function po(n){return It(n,"indexEntries")}function yl(n){return It(n,"indexConfiguration")}function mo(n){return It(n,"indexState")}function BT(n){J(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;xy(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new En(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Xt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Xt(e,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(h,d,p)=>(a++,p.delete()));s.push(l.next(()=>{J(a===1)}));const c=[];for(const h of t.mutations){const d=kA(e,h.key.path,t.batchId);s.push(i.delete(d)),c.push(h.key)}return x.waitFor(s).next(()=>c)}function Dd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Q();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xt.DEFAULT_COLLECTION_PERCENTILE=10,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xt.DEFAULT=new Xt(41943040,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xt.DISABLED=new Xt(-1,0,0);class xf{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){J(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new xf(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ni(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=To(e),o=ni(e);return o.add({}).next(a=>{J(typeof a=="number");const l=new Uy(a,t,r,i),c=function(_,E,C){const P=C.baseMutations.map(v=>ju(_.ct,v)),I=C.mutations.map(v=>ju(_.ct,v));return{userId:E,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:P,mutations:I}}(this.serializer,this.userId,l),h=[];let d=new we((p,_)=>ne(p.canonicalString(),_.canonicalString()));for(const p of i){const _=kA(this.userId,p.key.path,a);d=d.add(p.key.path.popLast()),h.push(o.put(c)),h.push(s.put(_,mM))}return d.forEach(p=>{h.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=l.keys()}),x.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return ni(e).get(t).next(r=>r?(J(r.userId===this.userId),us(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?x.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return ni(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(J(a.batchId>=r),s=us(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ni(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ni(e).U("userMutationsIndex",t).next(r=>r.map(i=>us(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Bh(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return To(e).J({range:i},(o,a,l)=>{const[c,h,d]=o,p=sr(h);if(c===this.userId&&t.path.isEqual(p))return ni(e).get(d).next(_=>{if(!_)throw Q();J(_.userId===this.userId),s.push(us(this.serializer,_))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new we(ne);const i=[];return t.forEach(s=>{const o=Bh(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=To(e).J({range:a},(c,h,d)=>{const[p,_,E]=c,C=sr(_);p===this.userId&&s.path.isEqual(C)?r=r.add(E):d.done()});i.push(l)}),x.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Bh(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new we(ne);return To(e).J({range:o},(l,c,h)=>{const[d,p,_]=l,E=sr(p);d===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(_)):h.done()}).next(()=>this.Fn(e,a))}Fn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(ni(e).get(s).next(o=>{if(o===null)throw Q();J(o.userId===this.userId),r.push(us(this.serializer,o))}))}),x.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return PP(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),x.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return To(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=sr(s[1]);i.push(l)}else a.done()}).next(()=>{J(i.length===0)})})}containsKey(e,t){return kP(e,this.userId,t)}xn(e){return NP(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function kP(n,e,t){const r=Bh(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return To(n).J({range:s,H:!0},(a,l,c)=>{const[h,d,p]=a;h===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function ni(n){return It(n,"mutations")}function To(n){return It(n,"documentMutations")}function NP(n){return It(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Us(0)}static Ln(){return new Us(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new Us(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>X.fromTimestamp(new Ve(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>go(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(J(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return go(e).J((o,a)=>{const l=Fl(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>x.waitFor(s)).next(()=>i)}forEachTarget(e,t){return go(e).J((r,i)=>{const s=Fl(i);t(s)})}Bn(e){return zT(e).get("targetGlobalKey").next(t=>(J(t!==null),t))}kn(e,t){return zT(e).put("targetGlobalKey",t)}qn(e,t){return go(e).put(CP(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Os(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return go(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=Fl(a);dc(t,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=ui(e);return t.forEach(o=>{const a=Kt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),x.waitFor(i)}removeMatchingKeys(e,t,r){const i=ui(e);return x.forEach(t,s=>{const o=Kt(s.path);return x.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=ui(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ui(e);let s=ie();return i.J({range:r,H:!0},(o,a,l)=>{const c=sr(o[1]),h=new G(c);s=s.add(h)}).next(()=>s)}containsKey(e,t){const r=Kt(t.path),i=IDBKeyRange.bound([r],[EA(r)],!1,!0);let s=0;return ui(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,t){return go(e).get(t).next(r=>r?Fl(r):null)}}function go(n){return It(n,"targets")}function zT(n){return It(n,"targetGlobal")}function ui(n){return It(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT([n,e],[t,r]){const i=ne(n,t);return i===0?ne(e,r):i}class k2{constructor(e){this.Kn=e,this.buffer=new we(qT),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();qT(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class N2{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hi(t)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ki(t)}await this.zn(3e5)})}}class b2{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return x.resolve(nn.oe);const r=new k2(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(jT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jT):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,t))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),vo()<=oe.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function x2(n,e){return new b2(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e,t){this.db=e,this.garbageCollector=x2(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return vh(e,r)}removeReference(e,t,r){return vh(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return vh(e,t)}er(e,t){return function(i,s){let o=!1;return NP(i).Y(a=>kP(i,a,s).next(l=>(l&&(o=!0),x.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Xn(e,(o,a)=>{if(a<=t){const l=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,X.min()),ui(e).delete(function(d){return[0,Kt(d.path)]}(o))))});i.push(l)}}).next(()=>x.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return vh(e,t)}Xn(e,t){const r=ui(e);let i,s=nn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==nn.oe&&t(new G(sr(i)),s),s=c,i=l):s=nn.oe}).next(()=>{s!==nn.oe&&t(new G(sr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vh(n,e){return ui(n).put(function(r,i){return{targetId:0,path:Kt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(){this.changes=new Qi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ne.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ns(e).put(r)}removeEntry(e,t,r){return ns(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],bd(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Ne.newInvalidDocument(t);return ns(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(vl(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Ne.newInvalidDocument(t)};return ns(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(vl(t))},(i,s)=>{r={document:this.nr(t,s),size:Dd(s)}}).next(()=>r)}getEntries(e,t){let r=sn();return this.ir(e,t,(i,s)=>{const o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=sn(),i=new ze(G.comparator);return this.ir(e,t,(s,o)=>{const a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Dd(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return x.resolve();let i=new we(GT);t.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(vl(i.first()),vl(i.last())),o=i.getIterator();let a=o.getNext();return ns(e).J({index:"documentKeyIndex",range:s},(l,c,h)=>{const d=G.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&GT(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?h.$(vl(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),bd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ns(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let h=sn();for(const d of c){const p=this.nr(G.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);p.isFoundDocument()&&(pc(t,p)||i.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(e,t,r,i){let s=sn();const o=WT(t,r),a=WT(t,En.max());return ns(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,h)=>{const d=this.nr(G.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new V2(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return $T(e).get("remoteDocumentGlobalKey").next(t=>(J(!!t),t))}tr(e,t){return $T(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const r=v2(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return Ne.newInvalidDocument(e)}}function xP(n){return new O2(n)}class V2 extends bP{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Qi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new we((s,o)=>ne(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=NT(this.ar.serializer,o);i=i.add(s.path.popLast());const c=Dd(l);r+=c-a.size,t.push(this.ar.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=NT(this.ar.serializer,o.convertToNoDocument(X.min()));t.push(this.ar.addEntry(e,s,l))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),x.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function $T(n){return It(n,"remoteDocumentGlobal")}function ns(n){return It(n,"remoteDocumentsV14")}function vl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function WT(n,e){const t=e.documentKey.path.toArray();return[n,bd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function GT(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Xl(r.mutation,i,rn.empty(),Ve.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ie()){const i=or();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ll();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=or();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ie()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=sn();const o=Jl(),a=function(){return Jl()}();return t.forEach((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof Gr)?s=s.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Xl(h.mutation,c,h.mutation.getFieldMask(),Ve.now())):o.set(c.key,rn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var d;return a.set(c,new L2(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Jl();let i=new ze((o,a)=>o-a),s=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||rn.empty();h=a.applyToLocalView(c,h),r.set(l,h);const d=(i.get(a.batchId)||ie()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,d=JA();h.forEach(p=>{if(!s.has(p)){const _=sP(t.get(p),r.get(p));_!==null&&d.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ly(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(or());let a=-1,l=s;return o.next(c=>x.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(h)?x.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,ie())).next(h=>({batchId:a,changes:YA(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(r=>{let i=Ll();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Ll();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,l=>{const c=function(d,p){return new Wr(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,Ne.newInvalidDocument(h)))});let a=Ll();return o.forEach((l,c)=>{const h=s.get(l);h!==void 0&&Xl(h.mutation,c,rn.empty(),Ve.now()),pc(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return x.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:nt(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:$y(i.bundledQuery),readTime:nt(i.readTime)}}(t)),x.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(){this.overlays=new ze(G.comparator),this.hr=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){const r=or();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){const i=or(),s=t.length+1,o=new G(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ze((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=or(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=or(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new jy(t,r));let s=this.hr.get(t);s===void 0&&(s=ie(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(){this.Pr=new we(ft.Ir),this.Tr=new we(ft.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const r=new ft(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new ft(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){const t=new G(new ce([])),r=new ft(t,e),i=new ft(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new G(new ce([])),r=new ft(t,e),i=new ft(t,e+1);let s=ie();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new ft(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ft{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return G.comparator(e.key,t.key)||ne(e.pr,t.pr)}static Er(e,t){return ne(e.pr,t.pr)||G.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new we(ft.Ir)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Uy(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.wr=this.wr.add(new ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.br(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ft(t,0),i=new ft(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{const a=this.Sr(o.pr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new we(ne);return t.forEach(i=>{const s=new ft(i,0),o=new ft(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),x.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new ft(new G(s),0);let a=new we(ne);return this.wr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.pr)),!0)},o),x.resolve(this.Dr(a))}Dr(e){const t=[];return e.forEach(r=>{const i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){J(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return x.forEach(t.mutations,i=>{const s=new ft(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){const r=new ft(t,0),i=this.wr.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e){this.vr=e,this.docs=function(){return new ze(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():Ne.newInvalidDocument(t))}getEntries(e,t){let r=sn();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ne.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=sn();const o=t.path,a=new G(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||xy(SA(h),r)<=0||(i.has(h.key)||pc(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Q()}Fr(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new j2(this)}getSize(e){return x.resolve(this.size)}}class j2 extends bP{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.persistence=e,this.Mr=new Qi(t=>Os(t),dc),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ky,this.targetCount=0,this.Lr=Us.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),x.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Us(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.qn(t),x.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){const r=this.Mr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),x.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Nr.gr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Nr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t){this.Br={},this.overlays={},this.kr=new nn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new z2(this),this.indexManager=new R2,this.remoteDocumentCache=function(i){return new B2(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new SP(t),this.$r=new M2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new F2,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new U2(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);const i=new q2(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return x.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class q2 extends RA{constructor(e){super(),this.currentSequenceNumber=e}}class Df{constructor(e){this.persistence=e,this.zr=new Ky,this.jr=null}static Hr(e){return new Df(e)}get Jr(){if(this.jr)return this.jr;throw Q()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),x.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Jr,r=>{const i=G.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,X.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return x.or([()=>x.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e){this.serializer=e}O(e,t,r,i){const s=new Af("createOrUpgrade",t);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",aT,{unique:!0}),l.createObjectStore("documentMutations")}(e),KT(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),KT(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",aT,{unique:!0});const d=c.store("mutations"),p=h.map(_=>d.put(_));return x.waitFor(p)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:AM});c.createIndex("collectionPathOverlayIndex",PM,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",kM,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:gM});c.createIndex("documentKeyIndex",_M),c.createIndex("collectionGroupIndex",yM)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:TM}).createIndex("sequenceNumberIndex",SM,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:CM}).createIndex("documentKeyIndex",RM,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Dd(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>x.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>x.forEach(a,l=>{J(l.userId===s.userId);const c=us(this.serializer,l);return PP(e,s.userId,c).next(()=>{})}))}))}ti(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new ce(o),c=function(d){return[0,Kt(d)]}(l);s.push(t.get(c).next(h=>h?x.resolve():(d=>t.put({targetId:0,path:Kt(d),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>x.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:EM});const r=t.store("collectionParents"),i=new Gy,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Kt(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new ce(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],c)=>{const h=sr(a);return s(h.popLast())}))}ri(e){const t=e.store("targets");return t.J((r,i)=>{const s=Fl(i),o=CP(this.serializer,s);return t.put(o)})}ii(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=t.store("remoteDocumentsV14"),l=function(d){return d.document?new G(ce.fromString(d.document.name).popFirst(5)):d.noDocument?G.fromSegments(d.noDocument.path):d.unknownDocument?G.fromSegments(d.unknownDocument.path):Q()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>x.waitFor(i))}si(e,t){const r=t.store("mutations"),i=xP(this.serializer),s=new OP(Df.Hr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let h=(c=a.get(l.userId))!==null&&c!==void 0?c:ie();us(this.serializer,l).keys().forEach(d=>h=h.add(d)),a.set(l.userId,h)}),x.forEach(a,(l,c)=>{const h=new mt(c),d=bf.lt(this.serializer,h),p=s.getIndexManager(h),_=xf.lt(h,this.serializer,p,s.referenceDelegate);return new DP(i,_,d,p).recalculateAndSaveOverlaysForDocumentKeys(new Og(t,nn.oe),l).next()})})}}function KT(n){n.createObjectStore("targetDocuments",{keyPath:wM}).createIndex("documentTargetsIndex",IM,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",vM,{unique:!0}),n.createObjectStore("targetGlobal")}const mm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Hy{constructor(e,t,r,i,s,o,a,l,c,h,d=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=h,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!Hy.D())throw new F(V.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new D2(this,i),this.Ti=t+"main",this.serializer=new SP(l),this.Ei=new cr(this.Ti,this.ui,new $2(this.serializer)),this.Qr=new P2(this.referenceDelegate,this.serializer),this.remoteDocumentCache=xP(this.serializer),this.$r=new w2,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,h===!1&&tt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new F(V.FAILED_PRECONDITION,mm);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new nn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(async()=>{this.started&&await this.Ai()}))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>wh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Hi(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return wl(e).get("owner").next(t=>x.resolve(this.Si(t)))}bi(e){return wh(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=It(t,"clientMetadata");return r.U().next(i=>{const s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?x.resolve(!0):wl(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new F(V.FAILED_PRECONDITION,mm);return!1}}return!(!this.networkEnabled||!this.inForeground)||wh(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Og(e,nn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>wh(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return xf.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new A2(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return bf.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(l){return l===16?bM:l===15?DA:l===14?xA:l===13?bA:l===12?NM:l===11?NA:void Q()}(this.ui);let o;return this.Ei.runTransaction(e,i,s,a=>(o=new Og(a,this.kr?this.kr.next():nn.oe),t==="readwrite-primary"?this.gi(o).next(l=>!!l||this.pi(o)).next(l=>{if(!l)throw tt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new F(V.FAILED_PRECONDITION,CA);return r(o)}).next(l=>this.wi(o).next(()=>l)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return wl(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new F(V.FAILED_PRECONDITION,mm)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wl(e).put("owner",t)}static D(){return cr.D()}yi(e){const t=wl(e);return t.get("owner").next(r=>this.Si(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Ci(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(tt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;YR()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){tt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function wl(n){return It(n,"owner")}function wh(n){return It(n,"clientMetadata")}function Qy(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ie(),i=ie();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Yy(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return YR()?8:AA(Le())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new W2;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(vo()<=oe.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",wo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),x.resolve()):(vo()<=oe.DEBUG&&U("QueryEngine","Query:",wo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(vo()<=oe.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",wo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ht(t))):x.resolve())}ji(e,t){if(vT(t))return x.resolve(null);let r=Ht(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Nd(t,null,"F"),r=Ht(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ie(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Zi(t,a);return this.Xi(t,c,o,l.readTime)?this.ji(e,Nd(t,null,"F")):this.es(e,c,t,l)}))})))}Hi(e,t,r,i){return vT(t)||i.isEqual(X.min())?x.resolve(null):this.zi.getDocuments(e,r).next(s=>{const o=this.Zi(t,s);return this.Xi(t,o,r,i)?x.resolve(null):(vo()<=oe.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wo(t)),this.es(e,o,t,TA(i,-1)).next(a=>a))})}Zi(e,t){let r=new we(HA(e));return t.forEach((i,s)=>{pc(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return vo()<=oe.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",wo(t)),this.zi.getDocumentsMatchingQuery(e,t,En.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new ze(ne),this.rs=new Qi(s=>Os(s),dc),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new DP(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}}function LP(n,e,t,r){return new G2(n,e,t,r)}async function MP(n,e){const t=K(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ie();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})}function K2(n,e){const t=K(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const d=c.batch,p=d.keys();let _=x.resolve();return p.forEach(E=>{_=_.next(()=>h.getEntry(l,E)).next(C=>{const P=c.docVersions.get(E);J(P!==null),C.version.compareTo(P)<0&&(d.applyToRemoteDocument(C,c),C.isValidDocument()&&(C.setReadTime(c.commitVersion),h.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ie();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function FP(n){const e=K(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function H2(n,e){const t=K(n),r=e.snapshotVersion;let i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;const a=[];e.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,h.removedDocuments,d).next(()=>t.Qr.addMatchingKeys(s,h.addedDocuments,d)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?_=_.withResumeToken(ht.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(d,_),function(C,P,I){return C.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(p,_,h)&&a.push(t.Qr.updateTargetData(s,_))});let l=sn(),c=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(UP(s,o,e.documentUpdates).next(h=>{l=h.cs,c=h.ls})),!r.isEqual(X.min())){const h=t.Qr.getLastRemoteSnapshotVersion(s).next(d=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.ns=i,s))}function UP(n,e,t){let r=ie(),i=ie();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=sn();return t.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(X.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):U("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{cs:o,ls:i}})}function Q2(n,e){const t=K(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function _a(n,e){const t=K(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new Rr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}async function ya(n,e,t){const r=K(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Hi(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)}function Od(n,e,t){const r=K(n);let i=X.min(),s=ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=K(l),p=d.rs.get(h);return p!==void 0?x.resolve(d.ns.get(p)):d.Qr.getTargetData(c,h)}(r,o,Ht(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:X.min(),t?s:ie())).next(a=>(zP(r,KA(e),a),{documents:a,hs:s})))}function BP(n,e){const t=K(n),r=K(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function jP(n,e){const t=K(n),r=t.ss.get(e)||X.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,TA(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(zP(t,e,i),i))}function zP(n,e,t){let r=n.ss.get(e)||X.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}async function Y2(n,e,t,r){const i=K(n);let s=ie(),o=sn();for(const c of t){const h=e.Ps(c.metadata.name);c.document&&(s=s.add(h));const d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(h,d)}const a=i.os.newChangeBuffer({trackRemovals:!0}),l=await _a(i,function(h){return Ht(Va(ce.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>UP(c,a,o).next(h=>(a.apply(c),h)).next(h=>i.Qr.removeMatchingKeysForTargetId(c,l.targetId).next(()=>i.Qr.addMatchingKeys(c,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,h.cs,h.ls)).next(()=>h.cs)))}async function J2(n,e,t=ie()){const r=await _a(n,Ht($y(e.bundledQuery))),i=K(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=nt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.$r.saveNamedQuery(s,e);const a=r.withResumeToken(ht.EMPTY_BYTE_STRING,o);return i.ns=i.ns.insert(a.targetId,a),i.Qr.updateTargetData(s,a).next(()=>i.Qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.$r.saveNamedQuery(s,e))})}function HT(n,e){return`firestore_clients_${n}_${e}`}function QT(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function gm(n,e){return`firestore_targets_${n}_${e}`}class Vd{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new F(i.error.code,i.error.message))),o?new Vd(e,t,i.state,s):(tt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zl{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new F(r.error.code,r.error.message))),s?new Zl(e,r.state,i):(tt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ld{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=My();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=PA(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Ld(e,s):(tt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Jy{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Jy(t.clientId,t.onlineState):(tt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Qg{constructor(){this.activeTargetIds=My()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _m{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new ze(ne),this.started=!1,this.ys=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=HT(this.persistenceKey,this.Vs),this.Ss=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Qg),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Fs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Vs)continue;const i=this.getItem(HT(this.persistenceKey,r));if(i){const s=Ld.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const r=this.xs(t);r&&this.Os(r)}for(const r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(gm(this.persistenceKey,e));if(r){const i=Zl.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(gm(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(U("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void tt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){const r=this.$s(t.key);return this.Us(r,null)}{const r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){const r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){const r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){const r=function(s){let o=nn.oe;if(s!=null)try{const a=JSON.parse(s);J(typeof a=="number"),o=a}catch(a){tt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==nn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){const r=this.Js(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)})}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){const i=new Vd(this.currentUser,e,t,r),s=QT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){const t=QT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){const i=gm(this.persistenceKey,e),s=new Zl(e,t,r);this.setItem(i,s.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const r=this.$s(e);return Ld.Es(r,t)}Gs(e,t){const r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Vd.Es(new mt(s),i,t)}js(e,t){const r=this.Cs.exec(e),i=Number(r[1]);return Zl.Es(i,t)}xs(e){return Jy.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=My();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class qP{constructor(){this.no=new Qg,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Qg,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{io(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ih=null;function ym(){return Ih===null?Ih=function(){return 268435456+Math.round(2147483648*Math.random())}():Ih++,"0x"+Ih.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ot="WebChannelConnection";class tF extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){const a=ym(),l=this.vo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(c,s,o),this.Mo(t,l,c,i).then(h=>(U("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Qn("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",i),h})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oa}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){const i=Z2[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){const s=ym();return new Promise((o,a)=>{const l=new pA;l.setWithCredentials(!0),l.listenOnce(gA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Fh.NO_ERROR:const h=l.getResponseJson();U(Ot,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Fh.TIMEOUT:U(Ot,`RPC '${e}' ${s} timed out`),a(new F(V.DEADLINE_EXCEEDED,"Request time out"));break;case Fh.HTTP_ERROR:const d=l.getStatus();if(U(Ot,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const _=p==null?void 0:p.error;if(_&&_.status&&_.message){const E=function(P){const I=P.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(I)>=0?I:V.UNKNOWN}(_.status);a(new F(E,_.message))}else a(new F(V.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new F(V.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{U(Ot,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);U(Ot,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",c,r,15)})}Oo(e,t,r){const i=ym(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=vA(),a=yA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new mA({})),this.Fo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");U(Ot,`Creating RPC '${e}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);let p=!1,_=!1;const E=new eF({lo:P=>{_?U(Ot,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(p||(U(Ot,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),U(Ot,`RPC '${e}' stream ${i} sending:`,P),d.send(P))},ho:()=>d.close()}),C=(P,I,v)=>{P.listen(I,w=>{try{v(w)}catch(D){setTimeout(()=>{throw D},0)}})};return C(d,Vl.EventType.OPEN,()=>{_||(U(Ot,`RPC '${e}' stream ${i} transport opened.`),E.mo())}),C(d,Vl.EventType.CLOSE,()=>{_||(_=!0,U(Ot,`RPC '${e}' stream ${i} transport closed`),E.po())}),C(d,Vl.EventType.ERROR,P=>{_||(_=!0,Qn(Ot,`RPC '${e}' stream ${i} transport errored:`,P),E.po(new F(V.UNAVAILABLE,"The operation could not be completed")))}),C(d,Vl.EventType.MESSAGE,P=>{var I;if(!_){const v=P.data[0];J(!!v);const w=v,D=w.error||((I=w[0])===null||I===void 0?void 0:I.error);if(D){U(Ot,`RPC '${e}' stream ${i} received error:`,D);const L=D.status;let M=function(S){const R=rt[S];if(R!==void 0)return lP(R)}(L),T=D.message;M===void 0&&(M=V.INTERNAL,T="Unknown error status: "+L+" with message "+D.message),_=!0,E.po(new F(M,T)),d.close()}else U(Ot,`RPC '${e}' stream ${i} received:`,v),E.yo(v)}}),C(a,_A.STAT_EVENT,P=>{P.stat===xg.PROXY?U(Ot,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===xg.NOPROXY&&U(Ot,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.fo()},0),E}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(){return typeof window<"u"?window:null}function Wh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yc(n){return new u2(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,t,r,i,s,o,a,l){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Xy(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(e,t){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===V.RESOURCE_EXHAUSTED?(tt(t.toString()),tt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ao(t)}__(){}auth(){this.state=1;const e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{const i=new F(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){const r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nF extends WP{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();const t=d2(this.serializer,e),r=function(s){if(!("targetChange"in s))return X.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?X.min():o.readTime?nt(o.readTime):X.min()}(e);return this.listener.h_(t,r)}P_(e){const t={};t.database=$g(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=Pd(l)?{documents:yP(s,l)}:{query:vP(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=dP(s,o.resumeToken);const c=zg(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(X.min())>0){a.readTime=ga(s,o.snapshotVersion.toTimestamp());const c=zg(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=p2(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){const t={};t.database=$g(this.serializer),t.removeTarget=e,this.i_(t)}}class rF extends WP{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(J(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();const t=f2(e.writeResults,e.commitTime),r=nt(e.commitTime);return this.listener.A_(r,t)}return J(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const e={};e.database=$g(this.serializer),this.i_(e)}d_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>ju(this.serializer,r))};this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new F(V.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,qg(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(V.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,qg(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(V.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class sF{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(tt(t),this.y_=!1):U("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(async()=>{Yi(this)&&(U("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=K(l);c.M_.add(4),await Fa(c),c.N_.set("Unknown"),c.M_.delete(4),await vc(c)}(this))})}),this.N_=new sF(r,i)}}async function vc(n){if(Yi(n))for(const e of n.x_)await e(!0)}async function Fa(n){for(const e of n.x_)await e(!1)}function Of(n,e){const t=K(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),tv(t)?ev(t):Ba(t).Xo()&&Zy(t,e))}function va(n,e){const t=K(n),r=Ba(t);t.F_.delete(e),r.Xo()&&GP(t,e),t.F_.size===0&&(r.Xo()?r.n_():Yi(t)&&t.N_.set("Unknown"))}function Zy(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ba(n).P_(e)}function GP(n,e){n.L_.xe(e),Ba(n).I_(e)}function ev(n){n.L_=new s2({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ba(n).start(),n.N_.w_()}function tv(n){return Yi(n)&&!Ba(n).Zo()&&n.F_.size>0}function Yi(n){return K(n).M_.size===0}function KP(n){n.L_=void 0}async function aF(n){n.N_.set("Online")}async function lF(n){n.F_.forEach((e,t)=>{Zy(n,e)})}async function uF(n,e){KP(n),tv(n)?(n.N_.D_(e),ev(n)):n.N_.set("Unknown")}async function cF(n,e,t){if(n.N_.set("Online"),e instanceof hP&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.F_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Md(n,r)}else if(e instanceof $h?n.L_.Ke(e):e instanceof cP?n.L_.He(e):n.L_.We(e),!t.isEqual(X.min()))try{const r=await FP(n.localStore);t.compareTo(r)>=0&&await function(s,o){const a=s.L_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.F_.get(c);h&&s.F_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=s.F_.get(l);if(!h)return;s.F_.set(l,h.withResumeToken(ht.EMPTY_BYTE_STRING,h.snapshotVersion)),GP(s,l);const d=new Rr(h.target,l,c,h.sequenceNumber);Zy(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){U("RemoteStore","Failed to raise snapshot:",r),await Md(n,r)}}async function Md(n,e,t){if(!Hi(e))throw e;n.M_.add(1),await Fa(n),n.N_.set("Offline"),t||(t=()=>FP(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{U("RemoteStore","Retrying IndexedDB access"),await t(),n.M_.delete(1),await vc(n)})}function HP(n,e){return e().catch(t=>Md(n,t,e))}async function Ua(n){const e=K(n),t=Fi(e);let r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;hF(e);)try{const i=await Q2(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,dF(e,i)}catch(i){await Md(e,i)}QP(e)&&YP(e)}function hF(n){return Yi(n)&&n.v_.length<10}function dF(n,e){n.v_.push(e);const t=Fi(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function QP(n){return Yi(n)&&!Fi(n).Zo()&&n.v_.length>0}function YP(n){Fi(n).start()}async function fF(n){Fi(n).V_()}async function pF(n){const e=Fi(n);for(const t of n.v_)e.d_(t.mutations)}async function mF(n,e,t){const r=n.v_.shift(),i=By.from(r,e,t);await HP(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Ua(n)}async function gF(n,e){e&&Fi(n).E_&&await async function(r,i){if(function(o){return aP(o)&&o!==V.ABORTED}(i.code)){const s=r.v_.shift();Fi(r).t_(),await HP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ua(r)}}(n,e),QP(n)&&YP(n)}async function JT(n,e){const t=K(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");const r=Yi(t);t.M_.add(3),await Fa(t),r&&t.N_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),await vc(t)}async function Yg(n,e){const t=K(n);e?(t.M_.delete(2),await vc(t)):e||(t.M_.add(2),await Fa(t),t.N_.set("Unknown"))}function Ba(n){return n.B_||(n.B_=function(t,r,i){const s=K(t);return s.f_(),new nF(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:aF.bind(null,n),To:lF.bind(null,n),Ao:uF.bind(null,n),h_:cF.bind(null,n)}),n.x_.push(async e=>{e?(n.B_.t_(),tv(n)?ev(n):n.N_.set("Unknown")):(await n.B_.stop(),KP(n))})),n.B_}function Fi(n){return n.k_||(n.k_=function(t,r,i){const s=K(t);return s.f_(),new rF(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:fF.bind(null,n),Ao:gF.bind(null,n),R_:pF.bind(null,n),A_:mF.bind(null,n)}),n.x_.push(async e=>{e?(n.k_.t_(),await Ua(n)):(await n.k_.stop(),n.v_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))})),n.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new nv(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ja(n,e){if(tt("AsyncQueue",`${e}: ${n}`),Hi(n))return new F(V.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.comparator=e?(t,r)=>e(t,r)||G.comparator(t.key,r.key):(t,r)=>G.comparator(t.key,r.key),this.keyedMap=Ll(),this.sortedSet=new ze(this.comparator)}static emptySet(e){return new Go(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Go)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Go;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(){this.q_=new ze(G.comparator)}track(e){const t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):Q():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}}class wa{constructor(e,t,r,i,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new wa(e,t,Go.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class yF{constructor(){this.queries=new Qi(e=>GA(e),fc),this.onlineState="Unknown",this.z_=new Set}}async function rv(n,e){const t=K(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new _F,r=e.G_()?0:1);try{switch(r){case 0:s.K_=await t.onListen(i,!0);break;case 1:s.K_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=ja(o,`Initialization of query '${wo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&sv(t)}async function iv(n,e){const t=K(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function vF(n,e){const t=K(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&sv(t)}function wF(n,e,t){const r=K(n),i=r.queries.get(e);if(i)for(const s of i.U_)s.onError(t);r.queries.delete(e)}function sv(n){n.z_.forEach(e=>{e.next()})}var Jg,ZT;(ZT=Jg||(Jg={})).J_="default",ZT.Cache="cache";class ov{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new wa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;const r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=wa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Jg.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e){this.serializer=e}Ps(e){return hr(this.serializer,e)}Is(e){return e.metadata.exists?_P(this.serializer,e.document,!1):Ne.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return nt(e)}}class EF{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=JP(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;const r=ce.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){const t=new Map,r=new e0(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Ps(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||ie()).add(s);t.set(o,a)}}return t}async complete(){const e=await Y2(this.localStore,new e0(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(const r of this.queries)await J2(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}}}function JP(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e){this.key=e}}class ZP{constructor(e){this.key=e}}class e1{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ie(),this.mutatedKeys=ie(),this.Ia=HA(e),this.Ta=new Go(this.Ia)}get Ea(){return this.la}da(e,t){const r=t?t.Aa:new XT,i=t?t.Ta:this.Ta;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,d)=>{const p=i.get(h),_=pc(this.query,d)?d:null,E=!!p&&this.mutatedKeys.has(p.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let P=!1;p&&_?p.data.isEqual(_.data)?E!==C&&(r.track({type:3,doc:_}),P=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),P=!0,(l&&this.Ia(_,l)>0||c&&this.Ia(_,c)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),P=!0):p&&!_&&(r.track({type:1,doc:p}),P=!0,(l||c)&&(a=!0)),P&&(_?(o=o.add(_),s=C?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const o=e.Aa.Q_();o.sort((h,d)=>function(_,E){const C=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return C(_)-C(E)}(h.type,d.type)||this.Ia(h.doc,d.doc)),this.Va(r),i=i!=null&&i;const a=t&&!i?this.ma():[],l=this.Pa.size===0&&this.current&&!i?1:0,c=l!==this.ha;return this.ha=l,o.length!==0||c?{snapshot:new wa(this.query,e.Ta,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new XT,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=ie(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});const t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new ZP(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new XP(r))}),t}pa(e){this.la=e.hs,this.Pa=ie();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return wa.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class TF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class SF{constructor(e){this.key=e,this.wa=!1}}class CF{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Qi(a=>GA(a),fc),this.Da=new Map,this.Ca=new Set,this.va=new ze(G.comparator),this.Fa=new Map,this.Ma=new Ky,this.xa={},this.Oa=new Map,this.Na=Us.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function RF(n,e,t=!0){const r=Vf(n);let i;const s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=await t1(r,e,t,!0),i}async function AF(n,e){const t=Vf(n);await t1(t,e,!0,!1)}async function t1(n,e,t,r){const i=await _a(n.localStore,Ht(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return r&&(a=await av(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Of(n.remoteStore,i),a}async function av(n,e,t,r,i){n.Ba=(d,p,_)=>async function(C,P,I,v){let w=P.view.da(I);w.Xi&&(w=await Od(C.localStore,P.query,!1).then(({documents:T})=>P.view.da(T,w)));const D=v&&v.targetChanges.get(P.targetId),L=v&&v.targetMismatches.get(P.targetId)!=null,M=P.view.applyChanges(w,C.isPrimaryClient,D,L);return Xg(C,P.targetId,M.fa),M.snapshot}(n,d,p,_);const s=await Od(n.localStore,e,!0),o=new e1(e,s.hs),a=o.da(s.documents),l=_c.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,l);Xg(n,t,c.fa);const h=new TF(e,t,o);return n.ba.set(e,h),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),c.snapshot}async function PF(n,e,t){const r=K(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!fc(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ya(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&va(r.remoteStore,i.targetId),Ia(r,i.targetId)}).catch(Ki)):(Ia(r,i.targetId),await ya(r.localStore,i.targetId,!0))}async function kF(n,e){const t=K(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),va(t.remoteStore,r.targetId))}async function NF(n,e,t){const r=hv(n);try{const i=await function(o,a){const l=K(o),c=Ve.now(),h=a.reduce((_,E)=>_.add(E.key),ie());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=sn(),C=ie();return l.os.getEntries(_,h).next(P=>{E=P,E.forEach((I,v)=>{v.isValidDocument()||(C=C.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,E)).next(P=>{d=P;const I=[];for(const v of a){const w=n2(v,d.get(v.key).overlayedDocument);w!=null&&I.push(new Gr(v.key,w,MA(w.value.mapValue),Oe.exists(!0)))}return l.mutationQueue.addMutationBatch(_,c,I,a)}).next(P=>{p=P;const I=P.applyToLocalDocumentSet(d,C);return l.documentOverlayCache.saveOverlays(_,P.batchId,I)})}).then(()=>({batchId:p.batchId,changes:YA(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.xa[o.currentUser.toKey()];c||(c=new ze(ne)),c=c.insert(a,l),o.xa[o.currentUser.toKey()]=c}(r,i.batchId,t),await Kr(r,i.changes),await Ua(r.remoteStore)}catch(i){const s=ja(i,"Failed to persist write");t.reject(s)}}async function n1(n,e){const t=K(n);try{const r=await H2(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Fa.get(s);o&&(J(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?J(o.wa):i.removedDocuments.size>0&&(J(o.wa),o.wa=!1))}),await Kr(t,r,e)}catch(r){await Ki(r)}}function t0(n,e,t){const r=K(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.ba.forEach((s,o)=>{const a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=K(o);l.onlineState=a;let c=!1;l.queries.forEach((h,d)=>{for(const p of d.U_)p.j_(a)&&(c=!0)}),c&&sv(l)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function bF(n,e,t){const r=K(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Fa.get(e),s=i&&i.key;if(s){let o=new ze(G.comparator);o=o.insert(s,Ne.newNoDocument(s,X.min()));const a=ie().add(s),l=new gc(X.min(),new Map,new ze(ne),o,a);await n1(r,l),r.va=r.va.remove(s),r.Fa.delete(e),cv(r)}else await ya(r.localStore,e,!1).then(()=>Ia(r,e,t)).catch(Ki)}async function xF(n,e){const t=K(n),r=e.batch.batchId;try{const i=await K2(t.localStore,e);uv(t,r,null),lv(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Kr(t,i)}catch(i){await Ki(i)}}async function DF(n,e,t){const r=K(n);try{const i=await function(o,a){const l=K(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(J(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,e);uv(r,e,t),lv(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Kr(r,i)}catch(i){await Ki(i)}}async function OF(n,e){const t=K(n);Yi(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=K(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();const i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){const i=ja(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function lv(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function uv(n,e,t){const r=K(n);let i=r.xa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Ia(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||r1(n,r)})}function r1(n,e){n.Ca.delete(e.path.canonicalString());const t=n.va.get(e);t!==null&&(va(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),cv(n))}function Xg(n,e,t){for(const r of t)r instanceof XP?(n.Ma.addReference(r.key,e),VF(n,r)):r instanceof ZP?(U("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||r1(n,r.key)):Q()}function VF(n,e){const t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(U("SyncEngine","New document in limbo: "+t),n.Ca.add(r),cv(n))}function cv(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){const e=n.Ca.values().next().value;n.Ca.delete(e);const t=new G(ce.fromString(e)),r=n.Na.next();n.Fa.set(r,new SF(t)),n.va=n.va.insert(t,r),Of(n.remoteStore,new Rr(Ht(Va(t.path)),r,"TargetPurposeLimboResolution",nn.oe))}}async function Kr(n,e,t){const r=K(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,l)=>{o.push(r.Ba(l,e,t).then(c=>{var h;if((c||t)&&r.isPrimaryClient){const d=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){i.push(c);const d=Yy.Ki(l.targetId,c);s.push(d)}}))}),await Promise.all(o),r.Sa.h_(i),await async function(l,c){const h=K(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>x.forEach(c,p=>x.forEach(p.qi,_=>h.persistence.referenceDelegate.addReference(d,p.targetId,_)).next(()=>x.forEach(p.Qi,_=>h.persistence.referenceDelegate.removeReference(d,p.targetId,_)))))}catch(d){if(!Hi(d))throw d;U("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const p=d.targetId;if(!d.fromCache){const _=h.ns.get(p),E=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(E);h.ns=h.ns.insert(p,C)}}}(r.localStore,s))}async function LF(n,e){const t=K(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());const r=await MP(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(l=>{l.reject(new F(V.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Kr(t,r.us)}}function MF(n,e){const t=K(n),r=t.Fa.get(e);if(r&&r.wa)return ie().add(r.key);{let i=ie();const s=t.Da.get(e);if(!s)return i;for(const o of s){const a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}async function FF(n,e){const t=K(n),r=await Od(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&Xg(t,e.targetId,i.fa),i}async function UF(n,e){const t=K(n);return jP(t.localStore,e).then(r=>Kr(t,r))}async function BF(n,e,t,r){const i=K(n),s=await function(a,l){const c=K(a),h=K(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>h.vn(d,l).next(p=>p?c.localDocuments.getDocuments(d,p):x.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Ua(i.remoteStore):t==="acknowledged"||t==="rejected"?(uv(i,e,r||null),lv(i,e),function(a,l){K(K(a).mutationQueue).Mn(l)}(i.localStore,e)):Q(),await Kr(i,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)}async function jF(n,e){const t=K(n);if(Vf(t),hv(t),e===!0&&t.La!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await n0(t,r.toArray());t.La=!0,await Yg(t.remoteStore,!0);for(const s of i)Of(t.remoteStore,s)}else if(e===!1&&t.La!==!1){const r=[];let i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ia(t,o),ya(t.localStore,o,!0))),va(t.remoteStore,o)}),await i,await n0(t,r),function(o){const a=K(o);a.Fa.forEach((l,c)=>{va(a.remoteStore,c)}),a.Ma.mr(),a.Fa=new Map,a.va=new ze(G.comparator)}(t),t.La=!1,await Yg(t.remoteStore,!1)}}async function n0(n,e,t){const r=K(n),i=[],s=[];for(const o of e){let a;const l=r.Da.get(o);if(l&&l.length!==0){a=await _a(r.localStore,Ht(l[0]));for(const c of l){const h=r.ba.get(c),d=await FF(r,h);d.snapshot&&s.push(d.snapshot)}}else{const c=await BP(r.localStore,o);a=await _a(r.localStore,c),await av(r,i1(c),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i}function i1(n){return WA(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function zF(n){return function(t){return K(K(t).persistence).Bi()}(K(n).localStore)}async function qF(n,e,t,r){const i=K(n);if(i.La)return void U("SyncEngine","Ignoring unexpected query state notification.");const s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await jP(i.localStore,KA(s[0])),a=gc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",ht.EMPTY_BYTE_STRING);await Kr(i,o,a);break}case"rejected":await ya(i.localStore,e,!0),Ia(i,e,r);break;default:Q()}}async function $F(n,e,t){const r=Vf(n);if(r.La){for(const i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){U("SyncEngine","Adding an already active target "+i);continue}const s=await BP(r.localStore,i),o=await _a(r.localStore,s);await av(r,i1(s),o.targetId,!1,o.resumeToken),Of(r.remoteStore,o)}for(const i of t)r.Da.has(i)&&await ya(r.localStore,i,!1).then(()=>{va(r.remoteStore,i),Ia(r,i)}).catch(Ki)}}function Vf(n){const e=K(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=n1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bF.bind(null,e),e.Sa.h_=vF.bind(null,e.eventManager),e.Sa.ka=wF.bind(null,e.eventManager),e}function hv(n){const e=K(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DF.bind(null,e),e}function WF(n,e,t){const r=K(n);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(_,E){const C=K(_),P=nt(E.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",I=>C.$r.getBundleMetadata(I,E.id)).then(I=>!!I&&I.createTime.compareTo(P)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(JP(l));const c=new EF(l,s.localStore,o.serializer);let h=await o.qa();for(;h;){const p=await c._a(h);p&&a._updateProgress(p),h=await o.qa()}const d=await c.complete();return await Kr(s,d.ca,void 0),await function(_,E){const C=K(_);return C.persistence.runTransaction("Save bundle","readwrite",P=>C.$r.saveBundleMetadata(P,E))}(s.localStore,l),a._completeWith(d.progress),Promise.resolve(d.ua)}catch(l){return Qn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Zg{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=yc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return LP(this.persistence,new VP,e.initialUser,this.serializer)}createPersistence(e){return new OP(Df.Hr,this.serializer)}createSharedClientState(e){return new qP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class s1 extends Zg{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Qa.initialize(this,e),await hv(this.Qa.syncEngine),await Ua(this.Qa.remoteStore),await this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return LP(this.persistence,new VP,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new N2(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new fM(t,this.persistence);return new dM(e.asyncQueue,r)}createPersistence(e){const t=Qy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new Hy(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,$P(),Wh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new qP}}class GF extends s1{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Qa.syncEngine;this.sharedClientState instanceof _m&&(this.sharedClientState.syncEngine={Zs:BF.bind(null,t),Xs:qF.bind(null,t),eo:$F.bind(null,t),Bi:zF.bind(null,t),Ys:UF.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi(async r=>{await jF(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=$P();if(!_m.D(t))throw new F(V.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Qy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new _m(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class dv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>t0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LF.bind(null,this.syncEngine),await Yg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new yF}()}createDatastore(e){const t=yc(e.databaseInfo.databaseId),r=function(s){return new tF(s)}(e.databaseInfo);return function(s,o,a,l){return new iF(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new oF(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>t0(this.syncEngine,t,0),function(){return YT.D()?new YT:new X2}())}createSyncEngine(e,t){return function(i,s,o,a,l,c,h){const d=new CF(i,s,o,a,l,c);return h&&(d.La=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(r){const i=K(r);U("RemoteStore","RemoteStore shutting down."),i.M_.add(5),await Fa(i),i.O_.shutdown(),i.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):tt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new vt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}async getMetadata(){return this.metadata.promise}async qa(){return await this.getMetadata(),this.Ga()}async Ga(){const e=await this.za();if(e===null)return null;const t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);const i=await this.Ha(r);return new IF(JSON.parse(i),e.length+r)}Ja(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async za(){for(;this.Ja()<0&&!await this.Ya(););if(this.buffer.length===0)return null;const e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ha(e){for(;this.buffer.length<e;)await this.Ya()&&this.ja("Reached the end of bundle when more is expected.");const t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ya(){const e=await this.Ua.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new F(V.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=K(i),a={documents:s.map(d=>Bu(o.serializer,d))},l=await o.xo("BatchGetDocuments",o.serializer.databaseId,ce.emptyPath(),a,s.length),c=new Map;l.forEach(d=>{const p=h2(o.serializer,d);c.set(p.key.toString(),p)});const h=[];return s.forEach(d=>{const p=c.get(d.toString());J(!!p),h.push(p)}),h}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ma(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=G.fromPath(r);this.mutations.push(new Fy(i,this.precondition(i)))}),await async function(r,i){const s=K(r),o={writes:i.map(a=>ju(s.serializer,a))};await s.Co("Commit",s.serializer.databaseId,ce.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Q();t=X.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new F(V.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(X.min())?Oe.exists(!1):Oe.updateTime(t):Oe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(X.min()))throw new F(V.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(t)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new Xy(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(async()=>{const e=new HF(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})})}tu(e){try{const t=this.updateFunction(e);return!hc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!aP(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=mt.UNAUTHENTICATED,this.clientId=IA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{U("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(U("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(V.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ja(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Gh(n,e){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await MP(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function e_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await fv(n);U("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>JT(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>JT(e.remoteStore,i)),n._onlineComponents=e}function o1(n){return n.name==="FirebaseError"?n.code===V.FAILED_PRECONDITION||n.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function fv(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{await Gh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!o1(t))throw t;Qn("Error using user provided cache. Falling back to memory cache: "+t),await Gh(n,new Zg)}}else U("FirestoreClient","Using default OfflineComponentProvider"),await Gh(n,new Zg);return n._offlineComponents}async function Mf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),await e_(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),await e_(n,new dv))),n._onlineComponents}function a1(n){return fv(n).then(e=>e.persistence)}function pv(n){return fv(n).then(e=>e.localStore)}function l1(n){return Mf(n).then(e=>e.remoteStore)}function mv(n){return Mf(n).then(e=>e.syncEngine)}function JF(n){return Mf(n).then(e=>e.datastore)}async function Ea(n){const e=await Mf(n),t=e.eventManager;return t.onListen=RF.bind(null,e.syncEngine),t.onUnlisten=PF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=AF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=kF.bind(null,e.syncEngine),t}function XF(n){return n.asyncQueue.enqueue(async()=>{const e=await a1(n),t=await l1(n);return e.setNetworkEnabled(!0),function(i){const s=K(i);return s.M_.delete(0),vc(s)}(t)})}function ZF(n){return n.asyncQueue.enqueue(async()=>{const e=await a1(n),t=await l1(n);return e.setNetworkEnabled(!1),async function(i){const s=K(i);s.M_.add(0),await Fa(s),s.N_.set("Offline")}(t)})}function eU(n,e){const t=new vt;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(c,h){const d=K(c);return d.persistence.runTransaction("read document","readonly",p=>d.localDocuments.getDocument(p,h))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new F(V.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=ja(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await pv(n),e,t)),t.promise}function u1(n,e,t={}){const r=new vt;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const h=new Lf({next:p=>{o.enqueueAndForget(()=>iv(s,d));const _=p.docs.has(a);!_&&p.fromCache?c.reject(new F(V.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&l&&l.source==="server"?c.reject(new F(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new ov(Va(a.path),h,{includeMetadataChanges:!0,ra:!0});return rv(s,d)}(await Ea(n),n.asyncQueue,e,t,r)),r.promise}function tU(n,e){const t=new vt;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await Od(i,s,!0),l=new e1(s,a.hs),c=l.da(a.documents),h=l.applyChanges(c,!1);o.resolve(h.snapshot)}catch(a){const l=ja(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await pv(n),e,t)),t.promise}function c1(n,e,t={}){const r=new vt;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const h=new Lf({next:p=>{o.enqueueAndForget(()=>iv(s,d)),p.fromCache&&l.source==="server"?c.reject(new F(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new ov(a,h,{includeMetadataChanges:!0,ra:!0});return rv(s,d)}(await Ea(n),n.asyncQueue,e,t,r)),r.promise}function nU(n,e){const t=new Lf(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){K(i).z_.add(s),s.next()}(await Ea(n),t)),()=>{t.$a(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){K(i).z_.delete(s)}(await Ea(n),t))}}function rU(n,e,t,r){const i=function(o,a){let l;return l=typeof o=="string"?uP().encode(o):o,function(h,d){return new KF(h,d)}(function(h,d){if(h instanceof Uint8Array)return r0(h,d);if(h instanceof ArrayBuffer)return r0(new Uint8Array(h),d);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,yc(e));n.asyncQueue.enqueueAndForget(async()=>{WF(await mv(n),i,r)})}function iU(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=K(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(await pv(n),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(n,e,t){if(!t)throw new F(V.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function d1(n,e,t,r){if(e===!0&&r===!0)throw new F(V.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function s0(n){if(!G.isDocumentKey(n))throw new F(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function o0(n){if(G.isDocumentKey(n))throw new F(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ff(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Q()}function me(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ff(n);throw new F(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function f1(n,e){if(e<=0)throw new F(V.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}d1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=h1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wc{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new a0({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new a0(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new tM;switch(r.type){case"firstParty":return new sM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=i0.get(t);r&&(U("ComponentProvider","Removing Datastore"),i0.delete(t),r.terminate())}(this),Promise.resolve()}}function sU(n,e,t,r={}){var i;const s=(n=me(n,wc))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Qn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=mt.MOCK_USER;else{a=$R(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new F(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new mt(c)}n._authCredentials=new nM(new wA(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qt=class p1{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new p1(this.firestore,e,this._query)}},Be=class m1{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ai(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new m1(this.firestore,e,this._key)}},Ai=class g1 extends Qt{constructor(e,t,r){super(e,t,Va(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new G(e))}withConverter(e){return new g1(this.firestore,e,this._path)}};function _1(n,e,...t){if(n=Z(n),gv("collection","path",e),n instanceof wc){const r=ce.fromString(e,...t);return o0(r),new Ai(n,null,r)}{if(!(n instanceof Be||n instanceof Ai))throw new F(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ce.fromString(e,...t));return o0(r),new Ai(n.firestore,null,r)}}function oU(n,e){if(n=me(n,wc),gv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new F(V.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qt(n,null,function(r){return new Wr(ce.emptyPath(),r)}(e))}function Fd(n,e,...t){if(n=Z(n),arguments.length===1&&(e=IA.newId()),gv("doc","path",e),n instanceof wc){const r=ce.fromString(e,...t);return s0(r),new Be(n,null,new G(r))}{if(!(n instanceof Be||n instanceof Ai))throw new F(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ce.fromString(e,...t));return s0(r),new Be(n.firestore,n instanceof Ai?n.converter:null,new G(r))}}function y1(n,e){return n=Z(n),e=Z(e),(n instanceof Be||n instanceof Ai)&&(e instanceof Be||e instanceof Ai)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function v1(n,e){return n=Z(n),e=Z(e),n instanceof Qt&&e instanceof Qt&&n.firestore===e.firestore&&fc(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Xy(this,"async_queue_retry"),this.hu=()=>{const t=Wh();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};const e=Wh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=Wh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const t=new vt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Hi(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(e){const t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw tt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const i=nv.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&Q()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}function t_(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class lU{constructor(){this._progressObserver={},this._taskCompletionResolver=new vt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU=-1;let He=class extends wc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new aU}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||w1(this),this._firestoreClient.terminate()}};function Et(n){return n._firestoreClient||w1(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function w1(n){var e,t,r;const i=n._freezeSettings(),s=function(a,l,c,h){return new OM(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h1(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new YF(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function cU(n,e){E1(n=me(n,He));const t=Et(n);if(t._uninitializedComponentsProvider)throw new F(V.FAILED_PRECONDITION,"SDK cache is already specified.");Qn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new dv;return I1(t,i,new s1(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function hU(n){E1(n=me(n,He));const e=Et(n);if(e._uninitializedComponentsProvider)throw new F(V.FAILED_PRECONDITION,"SDK cache is already specified.");Qn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new dv;return I1(e,r,new GF(r,t.cacheSizeBytes))}function I1(n,e,t){const r=new vt;return n.asyncQueue.enqueue(async()=>{try{await Gh(n,t),await e_(n,e),r.resolve()}catch(i){const s=i;if(!o1(s))throw s;Qn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function dU(n){if(n._initialized&&!n._terminated)throw new F(V.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new vt;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!cr.D())return Promise.resolve();const i=r+"main";await cr.delete(i)}(Qy(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function fU(n){return function(t){const r=new vt;return t.asyncQueue.enqueueAndForget(async()=>OF(await mv(t),r)),r.promise}(Et(n=me(n,He)))}function pU(n){return XF(Et(n=me(n,He)))}function mU(n){return ZF(Et(n=me(n,He)))}function gU(n,e){const t=Et(n=me(n,He)),r=new lU;return rU(t,n._databaseId,e,r),r}function _U(n,e){return iU(Et(n=me(n,He)),e).then(t=>t?new Qt(n,null,t.query):null)}function E1(n){if(n._initialized||n._terminated)throw new F(V.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fr(ht.fromBase64String(e))}catch(t){throw new F(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new fr(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ui=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new De(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eo=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yU=/^__.*__$/;class vU{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new La(e,this.data,t,this.fieldTransforms)}}class T1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function S1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class Bf{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new Bf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Ud(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(S1(this.fu)&&yU.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class wU{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yc(e)}Fu(e,t,r,i=!1){return new Bf({fu:e,methodName:t,vu:r,path:De.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function to(n){const e=n._freezeSettings(),t=yc(n._databaseId);return new wU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jf(n,e,t,r,i,s={}){const o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);Tv("Data must be an object, but it was:",o,r);const a=A1(r,o);let l,c;if(s.merge)l=new rn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=n_(e,d,t);if(!o.contains(p))throw new F(V.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);k1(h,p)||h.push(p)}l=new rn(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new vU(new Ct(a),l,c)}class Ic extends eo{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ic}}function C1(n,e,t){return new Bf({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class _v extends eo{_toFieldTransform(e){return new mc(e.path,new pa)}isEqual(e){return e instanceof _v}}class yv extends eo{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=C1(this,e,!0),r=this.Mu.map(s=>no(s,t)),i=new Vs(r);return new mc(e.path,i)}isEqual(e){return e instanceof yv&&Nu(this.Mu,e.Mu)}}class vv extends eo{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=C1(this,e,!0),r=this.Mu.map(s=>no(s,t)),i=new Ls(r);return new mc(e.path,i)}isEqual(e){return e instanceof vv&&Nu(this.Mu,e.Mu)}}class wv extends eo{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){const t=new ma(e.serializer,eP(e.serializer,this.xu));return new mc(e.path,t)}isEqual(e){return e instanceof wv&&this.xu===e.xu}}function Iv(n,e,t,r){const i=n.Fu(1,e,t);Tv("Data must be an object, but it was:",i,r);const s=[],o=Ct.empty();Zs(r,(l,c)=>{const h=Sv(e,l,t);c=Z(c);const d=i.Su(h);if(c instanceof Ic)s.push(h);else{const p=no(c,d);p!=null&&(s.push(h),o.set(h,p))}});const a=new rn(s);return new T1(o,a,i.fieldTransforms)}function Ev(n,e,t,r,i,s){const o=n.Fu(1,e,t),a=[n_(e,r,t)],l=[i];if(s.length%2!=0)throw new F(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(n_(e,s[p])),l.push(s[p+1]);const c=[],h=Ct.empty();for(let p=a.length-1;p>=0;--p)if(!k1(c,a[p])){const _=a[p];let E=l[p];E=Z(E);const C=o.Su(_);if(E instanceof Ic)c.push(_);else{const P=no(E,C);P!=null&&(c.push(_),h.set(_,P))}}const d=new rn(c);return new T1(h,d,o.fieldTransforms)}function R1(n,e,t,r=!1){return no(t,n.Fu(r?4:3,e))}function no(n,e){if(P1(n=Z(n)))return Tv("Unsupported field value:",e,n),A1(n,e);if(n instanceof eo)return function(r,i){if(!S1(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=no(a,i.bu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Z(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return eP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ve.fromDate(r);return{timestampValue:ga(i.serializer,s)}}if(r instanceof Ve){const s=new Ve(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ga(i.serializer,s)}}if(r instanceof Uf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof fr)return{bytesValue:dP(i.serializer,r._byteString)};if(r instanceof Be){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:qy(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${Ff(r)}`)}(n,e)}function A1(n,e){const t={};return OA(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zs(n,(r,i)=>{const s=no(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function P1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ve||n instanceof Uf||n instanceof fr||n instanceof Be||n instanceof eo)}function Tv(n,e,t){if(!P1(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=Ff(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function n_(n,e,t){if((e=Z(e))instanceof Ui)return e._internalPath;if(typeof e=="string")return Sv(n,e);throw Ud("Field path arguments must be of type string or ",n,!1,void 0,t)}const IU=new RegExp("[~\\*/\\[\\]]");function Sv(n,e,t){if(e.search(IU)>=0)throw Ud(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ui(...e.split("."))._internalPath}catch{throw Ud(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ud(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new F(V.INVALID_ARGUMENT,a+n+l)}function k1(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new EU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(zf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class EU extends zu{data(){return super.data()}}function zf(n,e){return typeof e=="string"?Sv(n,e):e instanceof Ui?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cv{}class Ec extends Cv{}function ri(n,e,...t){let r=[];e instanceof Cv&&r.push(e),r=r.concat(t),function(s){const o=s.filter(l=>l instanceof Rv).length,a=s.filter(l=>l instanceof qf).length;if(o>1||o>0&&a>0)throw new F(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class qf extends Ec{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new qf(e,t,r)}_apply(e){const t=this._parse(e);return x1(e._query,t),new Qt(e.firestore,e.converter,jg(e._query,t))}_parse(e){const t=to(e.firestore);return function(s,o,a,l,c,h,d){let p;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new F(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){u0(d,h);const _=[];for(const E of d)_.push(l0(l,s,E));p={arrayValue:{values:_}}}else p=l0(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||u0(d,h),p=R1(a,o,d,h==="in"||h==="not-in");return he.create(c,h,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function TU(n,e,t){const r=e,i=zf("where",n);return qf._create(i,r,t)}class Rv extends Cv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Rv(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ye.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)x1(o,l),o=jg(o,l)}(e._query,t),new Qt(e.firestore,e.converter,jg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Av extends Ec{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Av(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new F(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new F(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Uu(s,o)}(e._query,this._field,this._direction);return new Qt(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Wr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function SU(n,e="asc"){const t=e,r=zf("orderBy",n);return Av._create(r,t)}class $f extends Ec{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new $f(e,t,r)}_apply(e){return new Qt(e.firestore,e.converter,Nd(e._query,this._limit,this._limitType))}}function CU(n){return f1("limit",n),$f._create("limit",n,"F")}function RU(n){return f1("limitToLast",n),$f._create("limitToLast",n,"L")}class Wf extends Ec{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Wf(e,t,r)}_apply(e){const t=b1(e,this.type,this._docOrFields,this._inclusive);return new Qt(e.firestore,e.converter,function(i,s){return new Wr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function AU(...n){return Wf._create("startAt",n,!0)}function PU(...n){return Wf._create("startAfter",n,!1)}class Gf extends Ec{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Gf(e,t,r)}_apply(e){const t=b1(e,this.type,this._docOrFields,this._inclusive);return new Qt(e.firestore,e.converter,function(i,s){return new Wr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function kU(...n){return Gf._create("endBefore",n,!1)}function NU(...n){return Gf._create("endAt",n,!0)}function b1(n,e,t,r){if(t[0]=Z(t[0]),t[0]instanceof zu)return function(s,o,a,l,c){if(!l)throw new F(V.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const d of Wo(s))if(d.field.isKeyField())h.push(Ds(o,l.key));else{const p=l.data.field(d.field);if(Pf(p))throw new F(V.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const _=d.field.canonicalString();throw new F(V.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}h.push(p)}return new Mi(h,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=to(n.firestore);return function(o,a,l,c,h,d){const p=o.explicitOrderBy;if(h.length>p.length)throw new F(V.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let E=0;E<h.length;E++){const C=h[E];if(p[E].field.isKeyField()){if(typeof C!="string")throw new F(V.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof C}`);if(!Ly(o)&&C.indexOf("/")!==-1)throw new F(V.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${C}' contains a slash.`);const P=o.path.child(ce.fromString(C));if(!G.isDocumentKey(P))throw new F(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const I=new G(P);_.push(Ds(a,I))}else{const P=R1(l,c,C);_.push(P)}}return new Mi(_,d)}(n._query,n.firestore._databaseId,i,e,t,r)}}function l0(n,e,t){if(typeof(t=Z(t))=="string"){if(t==="")throw new F(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ly(e)&&t.indexOf("/")!==-1)throw new F(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ce.fromString(t));if(!G.isDocumentKey(r))throw new F(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ds(n,new G(r))}if(t instanceof Be)return Ds(n,t._key);throw new F(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ff(t)}.`)}function u0(n,e){if(!Array.isArray(n)||n.length===0)throw new F(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x1(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Pv{convertValue(e,t="none"){switch(xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return We(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Zs(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Uf(We(e.latitude),We(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Oy(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Lu(e));default:return null}}convertTimestamp(e){const t=Ur(e);return new Ve(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ce.fromString(e);J(TP(r));const i=new Vi(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(t)||tt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class bU extends Pv{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Br=class extends zu{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new eu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(zf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},eu=class extends Br{data(e={}){return super.data(e)}},Bi=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new gs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new eu(this._firestore,this._userDataWriter,r.key,r,new gs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new eu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new gs(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new eu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new gs(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:xU(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function xU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}function D1(n,e){return n instanceof Br&&e instanceof Br?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Bi&&e instanceof Bi&&n._firestore===e._firestore&&v1(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(n){n=me(n,Be);const e=me(n.firestore,He);return u1(Et(e),n._key).then(t=>kv(e,n,t))}class ro extends Pv{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}}function OU(n){n=me(n,Be);const e=me(n.firestore,He),t=Et(e),r=new ro(e);return eU(t,n._key).then(i=>new Br(e,r,n._key,i,new gs(i!==null&&i.hasLocalMutations,!0),n.converter))}function VU(n){n=me(n,Be);const e=me(n.firestore,He);return u1(Et(e),n._key,{source:"server"}).then(t=>kv(e,n,t))}function LU(n){n=me(n,Qt);const e=me(n.firestore,He),t=Et(e),r=new ro(e);return N1(n._query),c1(t,n._query).then(i=>new Bi(e,r,n,i))}function MU(n){n=me(n,Qt);const e=me(n.firestore,He),t=Et(e),r=new ro(e);return tU(t,n._query).then(i=>new Bi(e,r,n,i))}function FU(n){n=me(n,Qt);const e=me(n.firestore,He),t=Et(e),r=new ro(e);return c1(t,n._query,{source:"server"}).then(i=>new Bi(e,r,n,i))}function c0(n,e,t){n=me(n,Be);const r=me(n.firestore,He),i=Kf(n.converter,e,t);return Tc(r,[jf(to(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Oe.none())])}function h0(n,e,t,...r){n=me(n,Be);const i=me(n.firestore,He),s=to(i);let o;return o=typeof(e=Z(e))=="string"||e instanceof Ui?Ev(s,"updateDoc",n._key,e,t,r):Iv(s,"updateDoc",n._key,e),Tc(i,[o.toMutation(n._key,Oe.exists(!0))])}function UU(n){return Tc(me(n.firestore,He),[new Ma(n._key,Oe.none())])}function BU(n,e){const t=me(n.firestore,He),r=Fd(n),i=Kf(n.converter,e);return Tc(t,[jf(to(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function O1(n,...e){var t,r,i;n=Z(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||t_(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(t_(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let l,c,h;if(n instanceof Be)c=me(n.firestore,He),h=Va(n._key.path),l={next:d=>{e[o]&&e[o](kv(c,n,d))},error:e[o+1],complete:e[o+2]};else{const d=me(n,Qt);c=me(d.firestore,He),h=d._query;const p=new ro(c);l={next:_=>{e[o]&&e[o](new Bi(c,p,d,_))},error:e[o+1],complete:e[o+2]},N1(n._query)}return function(p,_,E,C){const P=new Lf(C),I=new ov(_,P,E);return p.asyncQueue.enqueueAndForget(async()=>rv(await Ea(p),I)),()=>{P.$a(),p.asyncQueue.enqueueAndForget(async()=>iv(await Ea(p),I))}}(Et(c),h,a,l)}function jU(n,e){return nU(Et(n=me(n,He)),t_(e)?e:{next:e})}function Tc(n,e){return function(r,i){const s=new vt;return r.asyncQueue.enqueueAndForget(async()=>NF(await mv(r),i,s)),s.promise}(Et(n),e)}function kv(n,e,t){const r=t.docs.get(e._key),i=new ro(n);return new Br(n,i,e._key,r,new gs(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qU=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=to(e)}set(e,t,r){this._verifyNotCommitted();const i=ci(e,this._firestore),s=Kf(i.converter,t,r),o=jf(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Oe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=ci(e,this._firestore);let o;return o=typeof(t=Z(t))=="string"||t instanceof Ui?Ev(this._dataReader,"WriteBatch.update",s._key,t,r,i):Iv(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ci(e,this._firestore);return this._mutations=this._mutations.concat(new Ma(t._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new F(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ci(n,e){if((n=Z(n)).firestore!==e)throw new F(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $U=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=to(t)}get(t){const r=ci(t,this._firestore),i=new bU(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Q();const o=s[0];if(o.isFoundDocument())return new zu(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new zu(this._firestore,i,r._key,null,r.converter);throw Q()})}set(t,r,i){const s=ci(t,this._firestore),o=Kf(s.converter,r,i),a=jf(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=ci(t,this._firestore);let a;return a=typeof(r=Z(r))=="string"||r instanceof Ui?Ev(this._dataReader,"Transaction.update",o._key,r,i,s):Iv(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=ci(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ci(e,this._firestore),r=new ro(this._firestore);return super.get(e).then(i=>new Br(this._firestore,r,t._key,i._document,new gs(!1,!1),t.converter))}};function WU(n,e,t){n=me(n,He);const r=Object.assign(Object.assign({},zU),t);return function(s){if(s.maxAttempts<1)throw new F(V.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new vt;return s.asyncQueue.enqueueAndForget(async()=>{const c=await JF(s);new QF(s.asyncQueue,c,a,o,l).Xa()}),l.promise}(Et(n),i=>e(new $U(n,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(){return new Ic("deleteField")}function KU(){return new _v("serverTimestamp")}function HU(...n){return new yv("arrayUnion",n)}function QU(...n){return new vv("arrayRemove",n)}function YU(n){return new wv("increment",n)}(function(e,t=!0){(function(i){Oa=i})($r),Fr(new Hn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new He(new rM(r.getProvider("auth-internal")),new aM(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new F(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vi(c.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),vn(iT,"4.6.4",e),vn(iT,"4.6.4","esm2017")})();const JU="@firebase/firestore-compat",XU="0.3.33";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new F("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(){if(typeof Uint8Array>"u")throw new F("unimplemented","Uint8Arrays are not available in this environment.")}function f0(){if(!xM())throw new F("unimplemented","Blobs are unavailable in Firestore in this environment.")}class qu{constructor(e){this._delegate=e}static fromBase64String(e){return f0(),new qu(fr.fromBase64String(e))}static fromUint8Array(e){return d0(),new qu(fr.fromUint8Array(e))}toBase64(){return f0(),this._delegate.toBase64()}toUint8Array(){return d0(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(n){return ZU(n,["next","error","complete"])}function ZU(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{enableIndexedDbPersistence(e,t){return cU(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return hU(e._delegate)}clearIndexedDbPersistence(e){return dU(e._delegate)}}class V1{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Vi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Qn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sU(this._delegate,e,t,r)}enableNetwork(){return pU(this._delegate)}disableNetwork(){return mU(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,d1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return fU(this._delegate)}onSnapshotsInSync(e){return jU(this._delegate,e)}get app(){if(!this._appCompat)throw new F("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ta(this,_1(this._delegate,e))}catch(t){throw $t(t,"collection()","Firestore.collection()")}}doc(e){try{return new Pn(this,Fd(this._delegate,e))}catch(t){throw $t(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new qt(this,oU(this._delegate,e))}catch(t){throw $t(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return WU(this._delegate,t=>e(new L1(this,t)))}batch(){return Et(this._delegate),new M1(new qU(this._delegate,e=>Tc(this._delegate,e)))}loadBundle(e){return gU(this._delegate,e)}namedQuery(e){return _U(this._delegate,e).then(t=>t?new qt(this,t):null)}}class Hf extends Pv{constructor(e){super(),this.firestore=e}convertBytes(e){return new qu(new fr(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Pn.forKey(t,this.firestore,null)}}function t4(n){ZL(n)}class L1{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Hf(e)}get(e){const t=_s(e);return this._delegate.get(t).then(r=>new $u(this._firestore,new Br(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=_s(e);return r?(Nv("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=_s(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=_s(e);return this._delegate.delete(t),this}}class M1{constructor(e){this._delegate=e}set(e,t,r){const i=_s(e);return r?(Nv("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=_s(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=_s(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Bs{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new eu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Wu(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Bs.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Bs(e,new Hf(e),t),i.set(t,s)),s}}Bs.INSTANCES=new WeakMap;class Pn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Hf(e)}static forPath(e,t,r){if(e.length%2!==0)throw new F("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Pn(t,new Be(t._delegate,r,new G(e)))}static forKey(e,t,r){return new Pn(t,new Be(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ta(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ta(this.firestore,_1(this._delegate,e))}catch(t){throw $t(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Z(e),e instanceof Be?y1(this._delegate,e):!1}set(e,t){t=Nv("DocumentReference.set",t);try{return t?c0(this._delegate,e,t):c0(this._delegate,e)}catch(r){throw $t(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?h0(this._delegate,e):h0(this._delegate,e,t,...r)}catch(i){throw $t(i,"updateDoc()","DocumentReference.update()")}}delete(){return UU(this._delegate)}onSnapshot(...e){const t=F1(e),r=U1(e,i=>new $u(this.firestore,new Br(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return O1(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=OU(this._delegate):(e==null?void 0:e.source)==="server"?t=VU(this._delegate):t=DU(this._delegate),t.then(r=>new $u(this.firestore,new Br(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Pn(this.firestore,e?this._delegate.withConverter(Bs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function $t(n,e,t){return n.message=n.message.replace(e,t),n}function F1(n){for(const e of n)if(typeof e=="object"&&!r_(e))return e;return{}}function U1(n,e){var t,r;let i;return r_(n[0])?i=n[0]:r_(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class $u{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Pn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return D1(this._delegate,e._delegate)}}class Wu extends $u{data(e){const t=this._delegate.data(e);return this._delegate._converter||eM(t!==void 0),t}}class qt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Hf(e)}where(e,t,r){try{return new qt(this.firestore,ri(this._delegate,TU(e,t,r)))}catch(i){throw $t(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new qt(this.firestore,ri(this._delegate,SU(e,t)))}catch(r){throw $t(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new qt(this.firestore,ri(this._delegate,CU(e)))}catch(t){throw $t(t,"limit()","Query.limit()")}}limitToLast(e){try{return new qt(this.firestore,ri(this._delegate,RU(e)))}catch(t){throw $t(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new qt(this.firestore,ri(this._delegate,AU(...e)))}catch(t){throw $t(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new qt(this.firestore,ri(this._delegate,PU(...e)))}catch(t){throw $t(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new qt(this.firestore,ri(this._delegate,kU(...e)))}catch(t){throw $t(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new qt(this.firestore,ri(this._delegate,NU(...e)))}catch(t){throw $t(t,"endAt()","Query.endAt()")}}isEqual(e){return v1(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=MU(this._delegate):(e==null?void 0:e.source)==="server"?t=FU(this._delegate):t=LU(this._delegate),t.then(r=>new i_(this.firestore,new Bi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=F1(e),r=U1(e,i=>new i_(this.firestore,new Bi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return O1(this._delegate,t,r)}withConverter(e){return new qt(this.firestore,e?this._delegate.withConverter(Bs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class n4{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Wu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class i_{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new qt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Wu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new n4(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Wu(this._firestore,r))})}isEqual(e){return D1(this._delegate,e._delegate)}}class Ta extends qt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Pn(this.firestore,e):null}doc(e){try{return e===void 0?new Pn(this.firestore,Fd(this._delegate)):new Pn(this.firestore,Fd(this._delegate,e))}catch(t){throw $t(t,"doc()","CollectionReference.doc()")}}add(e){return BU(this._delegate,e).then(t=>new Pn(this.firestore,t))}isEqual(e){return y1(this._delegate,e._delegate)}withConverter(e){return new Ta(this.firestore,e?this._delegate.withConverter(Bs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function _s(n){return me(n,Be)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(...e){this._delegate=new Ui(...e)}static documentId(){return new bv(De.keyField().canonicalString())}isEqual(e){return e=Z(e),e instanceof Ui?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this._delegate=e}static serverTimestamp(){const e=KU();return e._methodName="FieldValue.serverTimestamp",new ds(e)}static delete(){const e=GU();return e._methodName="FieldValue.delete",new ds(e)}static arrayUnion(...e){const t=HU(...e);return t._methodName="FieldValue.arrayUnion",new ds(t)}static arrayRemove(...e){const t=QU(...e);return t._methodName="FieldValue.arrayRemove",new ds(t)}static increment(e){const t=YU(e);return t._methodName="FieldValue.increment",new ds(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4={Firestore:V1,GeoPoint:Uf,Timestamp:Ve,Blob:qu,Transaction:L1,WriteBatch:M1,DocumentReference:Pn,DocumentSnapshot:$u,Query:qt,QueryDocumentSnapshot:Wu,QuerySnapshot:i_,CollectionReference:Ta,FieldPath:bv,FieldValue:ds,setLogLevel:t4,CACHE_SIZE_UNLIMITED:uU};function i4(n,e){n.INTERNAL.registerComponent(new Hn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},r4)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(n){i4(n,(e,t)=>new V1(e,t,new e4)),n.registerVersion(JU,XU)}s4(et);function xv(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}const Il={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},_o={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o4(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function B1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const a4=o4,l4=B1,j1=new Js("auth","Firebase",B1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd=new cc("@firebase/auth");function u4(n,...e){Bd.logLevel<=oe.WARN&&Bd.warn(`Auth (${$r}): ${n}`,...e)}function Kh(n,...e){Bd.logLevel<=oe.ERROR&&Bd.error(`Auth (${$r}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(n,...e){throw Ov(n,...e)}function ct(n,...e){return Ov(n,...e)}function Dv(n,e,t){const r=Object.assign(Object.assign({},l4()),{[e]:t});return new Js("auth","Firebase",r).create(e,{appName:n.name})}function wt(n){return Dv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function za(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pt(n,"argument-error"),Dv(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ov(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return j1.create(n,...e)}function z(n,e,...t){if(!n)throw Ov(e,...t)}function ar(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Kh(e),new Error(e)}function Yn(n,e){n||ar(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Vv(){return p0()==="http:"||p0()==="https:"}function p0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Vv()||KR()||"connection"in navigator)?navigator.onLine:!0}function h4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yn(t>e,"Short delay should be less than long delay!"),this.isMobile=Sy()||Cf()}get(){return c4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(n,e){Yn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ar("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ar("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ar("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=new Sc(3e4,6e4);function Ye(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Je(n,e,t,r,i={}){return q1(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Xs(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode),z1.fetch()($1(n,n.config.apiHost,t,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function q1(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},d4),e);try{const i=new m4(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ul(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ul(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ul(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ul(n,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Dv(n,h,c);Pt(n,h)}}catch(i){if(i instanceof Gt)throw i;Pt(n,"network-request-failed",{message:String(i)})}}async function Hr(n,e,t,r,i={}){const s=await Je(n,e,t,r,i);return"mfaPendingCredential"in s&&Pt(n,"multi-factor-auth-required",{_serverResponse:s}),s}function $1(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Lv(n.config,i):`${n.config.apiScheme}://${i}`}function p4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class m4{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ct(this.auth,"network-request-failed")),f4.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ul(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=ct(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(n){return n!==void 0&&n.getResponse!==void 0}function g0(n){return n!==void 0&&n.enterprise!==void 0}class g4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return p4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _4(n){return(await Je(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function y4(n,e){return Je(n,"GET","/v2/recaptchaConfig",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v4(n,e){return Je(n,"POST","/v1/accounts:delete",e)}async function w4(n,e){return Je(n,"POST","/v1/accounts:update",e)}async function W1(n,e){return Je(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function I4(n,e=!1){const t=Z(n),r=await t.getIdToken(e),i=Qf(r);z(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:tu(vm(i.auth_time)),issuedAtTime:tu(vm(i.iat)),expirationTime:tu(vm(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function vm(n){return Number(n)*1e3}function Qf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Kh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Sd(t);return i?JSON.parse(i):(Kh("Failed to decode base64 JWT payload"),null)}catch(i){return Kh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function _0(n){const e=Qf(n);return z(e,"internal-error"),z(typeof e.exp<"u","internal-error"),z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Gt&&E4(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function E4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tu(this.lastLoginAt),this.creationTime=tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ku(n){var e;const t=n.auth,r=await n.getIdToken(),i=await jr(n,W1(t,{idToken:r}));z(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?G1(s.providerUserInfo):[],a=C4(n.providerData,o),l=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),h=l?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new s_(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function S4(n){const e=Z(n);await Ku(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function C4(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function G1(n){return n.map(e=>{var{providerId:t}=e,r=xv(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R4(n,e){const t=await q1(n,{},async()=>{const r=Xs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=$1(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",z1.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function A4(n,e){return Je(n,"POST","/v2/accounts:revokeToken",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){z(e.idToken,"internal-error"),z(typeof e.idToken<"u","internal-error"),z(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){z(e.length!==0,"internal-error");const t=_0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await R4(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Ko;return r&&(z(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(z(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(z(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ko,this.toJSON())}_performRefresh(){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(n,e){z(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ar{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=xv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new T4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new s_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await jr(this,this.stsTokenManager.getToken(this.auth,e));return z(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return I4(this,e)}reload(){return S4(this)}_assign(e){this!==e&&(z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ar(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Ku(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ge(this.auth.app))return Promise.reject(wt(this.auth));const e=await this.getIdToken();return await jr(this,v4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,l,c,h;const d=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,C=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,I=(c=t.createdAt)!==null&&c!==void 0?c:void 0,v=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:w,emailVerified:D,isAnonymous:L,providerData:M,stsTokenManager:T}=t;z(w&&T,e,"internal-error");const y=Ko.fromJSON(this.name,T);z(typeof w=="string",e,"internal-error"),ii(d,e.name),ii(p,e.name),z(typeof D=="boolean",e,"internal-error"),z(typeof L=="boolean",e,"internal-error"),ii(_,e.name),ii(E,e.name),ii(C,e.name),ii(P,e.name),ii(I,e.name),ii(v,e.name);const S=new Ar({uid:w,auth:e,email:p,emailVerified:D,displayName:d,isAnonymous:L,photoURL:E,phoneNumber:_,tenantId:C,stsTokenManager:y,createdAt:I,lastLoginAt:v});return M&&Array.isArray(M)&&(S.providerData=M.map(R=>Object.assign({},R))),P&&(S._redirectEventId=P),S}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ko;i.updateFromServerResponse(t);const s=new Ar({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ku(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];z(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?G1(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ko;a.updateFromIdToken(r);const l=new Ar({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new s_(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0=new Map;function _n(n){Yn(n instanceof Function,"Expected a class definition");let e=y0.get(n);return e?(Yn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,y0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}K1.type="NONE";const Sa=K1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(n,e,t){return`firebase:${n}:${e}:${t}`}class Ho{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Ts(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ts("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ar._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ho(_n(Sa),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||_n(Sa);const o=Ts(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const h=await c._get(o);if(h){const d=Ar._fromJSON(e,h);c!==s&&(a=d),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ho(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Ho(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Y1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(H1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(J1(e))return"Blackberry";if(X1(e))return"Webos";if(Mv(e))return"Safari";if((e.includes("chrome/")||Q1(e))&&!e.includes("edge/"))return"Chrome";if(Cc(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function H1(n=Le()){return/firefox\//i.test(n)}function Mv(n=Le()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q1(n=Le()){return/crios\//i.test(n)}function Y1(n=Le()){return/iemobile/i.test(n)}function Cc(n=Le()){return/android/i.test(n)}function J1(n=Le()){return/blackberry/i.test(n)}function X1(n=Le()){return/webos/i.test(n)}function qa(n=Le()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function P4(n=Le()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function k4(n=Le()){var e;return qa(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function N4(){return HR()&&document.documentMode===10}function Z1(n=Le()){return qa(n)||Cc(n)||X1(n)||J1(n)||/windows phone/i.test(n)||Y1(n)}function b4(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek(n,e=[]){let t;switch(n){case"Browser":t=v0(Le());break;case"Worker":t=`${v0(Le())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$r}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4(n,e={}){return Je(n,"GET","/v2/passwordPolicy",Ye(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4=6;class V4{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:O4,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new w0(this),this.idTokenSubscription=new w0(this),this.beforeStateQueue=new x4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=j1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_n(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Ho.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await W1(this,{idToken:e}),r=await Ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ge(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ku(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=h4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ge(this.app))return Promise.reject(wt(this));const t=e?Z(e):null;return t&&z(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ge(this.app)?Promise.reject(wt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ge(this.app)?Promise.reject(wt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_n(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await D4(this),t=new V4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Js("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await A4(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_n(e)||this._popupRedirectResolver;z(t,this,"argument-error"),this.redirectPersistenceManager=await Ho.create(this,[_n(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(z(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ek(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&u4(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Qe(n){return Z(n)}class w0{constructor(e){this.auth=e,this.observer=null,this.addObserver=XR(t=>this.observer=t)}get next(){return z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function M4(n){Rc=n}function Fv(n){return Rc.loadJS(n)}function F4(){return Rc.recaptchaV2Script}function U4(){return Rc.recaptchaEnterpriseScript}function B4(){return Rc.gapiScript}function tk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const j4="recaptcha-enterprise",z4="NO_RECAPTCHA";class q4{constructor(e){this.type=j4,this.auth=Qe(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{y4(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new g4(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;g0(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(z4)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&g0(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=U4();l.length!==0&&(l+=a),Fv(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function I0(n,e,t,r=!1){const i=new q4(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Hu(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await I0(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await I0(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}function $4(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(_n);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function W4(n,e,t){const r=Qe(n);z(r._canInitEmulator,r,"emulator-config-failed"),z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=nk(e),{host:o,port:a}=G4(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||K4()}function nk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function G4(n){const e=nk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:E0(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:E0(o)}}}function E0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function K4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ar("not implemented")}_getIdTokenResponse(e){return ar("not implemented")}_linkToIdToken(e,t){return ar("not implemented")}_getReauthenticationResolver(e){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rk(n,e){return Je(n,"POST","/v1/accounts:resetPassword",Ye(n,e))}async function H4(n,e){return Je(n,"POST","/v1/accounts:update",e)}async function Q4(n,e){return Je(n,"POST","/v1/accounts:signUp",e)}async function Y4(n,e){return Je(n,"POST","/v1/accounts:update",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(n,e){return Hr(n,"POST","/v1/accounts:signInWithPassword",Ye(n,e))}async function Yf(n,e){return Je(n,"POST","/v1/accounts:sendOobCode",Ye(n,e))}async function X4(n,e){return Yf(n,e)}async function Z4(n,e){return Yf(n,e)}async function eB(n,e){return Yf(n,e)}async function tB(n,e){return Yf(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nB(n,e){return Hr(n,"POST","/v1/accounts:signInWithEmailLink",Ye(n,e))}async function rB(n,e){return Hr(n,"POST","/v1/accounts:signInWithEmailLink",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu extends $a{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Qu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Qu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hu(e,t,"signInWithPassword",J4);case"emailLink":return nB(e,{email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hu(e,r,"signUpPassword",Q4);case"emailLink":return rB(e,{idToken:t,email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xr(n,e){return Hr(n,"POST","/v1/accounts:signInWithIdp",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iB="http://localhost";class pr extends $a{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=xv(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new pr(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return xr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,xr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,xr(e,t)}buildRequest(){const e={requestUri:iB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xs(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sB(n,e){return Je(n,"POST","/v1/accounts:sendVerificationCode",Ye(n,e))}async function oB(n,e){return Hr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ye(n,e))}async function aB(n,e){const t=await Hr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ye(n,e));if(t.temporaryProof)throw Ul(n,"account-exists-with-different-credential",t);return t}const lB={USER_NOT_FOUND:"user-not-found"};async function uB(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Hr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ye(n,t),lB)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends $a{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ss({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ss({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return oB(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return aB(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return uB(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Ss({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cB(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hB(n){const e=Lo(Ol(n)).link,t=e?Lo(Ol(e)).deep_link_id:null,r=Lo(Ol(n)).deep_link_id;return(r?Lo(Ol(r)).link:null)||r||t||e||n}class Jf{constructor(e){var t,r,i,s,o,a;const l=Lo(Ol(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,d=cB((i=l.mode)!==null&&i!==void 0?i:null);z(c&&h&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=h,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=hB(e);try{return new Jf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(){this.providerId=Ji.PROVIDER_ID}static credential(e,t){return Qu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Jf.parseLink(t);return z(r,"argument-error"),Qu._fromEmailAndCode(e,r.code,r.tenantId)}}Ji.PROVIDER_ID="password";Ji.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ji.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa extends Qr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qo extends Wa{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return z("providerId"in t&&"signInMethod"in t,"argument-error"),pr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return z(e.idToken||e.accessToken,"argument-error"),pr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Qo.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Qo.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new Qo(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends Wa{constructor(){super("facebook.com")}static credential(e){return pr._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tr.credential(e.oauthAccessToken)}catch{return null}}}tr.FACEBOOK_SIGN_IN_METHOD="facebook.com";tr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends Wa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pr._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return nr.credential(t,r)}catch{return null}}}nr.GOOGLE_SIGN_IN_METHOD="google.com";nr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends Wa{constructor(){super("github.com")}static credential(e){return pr._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rr.credential(e.oauthAccessToken)}catch{return null}}}rr.GITHUB_SIGN_IN_METHOD="github.com";rr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB="http://localhost";class Ca extends $a{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return xr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,xr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,xr(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Ca(r,s)}static _create(e,t){return new Ca(e,t)}buildRequest(){return{requestUri:dB,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB="saml.";class jd extends Qr{constructor(e){z(e.startsWith(fB),"argument-error"),super(e)}static credentialFromResult(e){return jd.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return jd.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Ca.fromJSON(e);return z(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Ca._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends Wa{constructor(){super("twitter.com")}static credential(e,t){return pr._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ir.credential(t,r)}catch{return null}}}ir.TWITTER_SIGN_IN_METHOD="twitter.com";ir.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ik(n,e){return Hr(n,"POST","/v1/accounts:signUp",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Ar._fromIdTokenResponse(e,r,i),o=T0(r);return new Dn({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=T0(r);return new Dn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function T0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pB(n){var e;if(Ge(n.app))return Promise.reject(wt(n));const t=Qe(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Dn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await ik(t,{returnSecureToken:!0}),i=await Dn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd extends Gt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zd.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new zd(e,t,r,i)}}function sk(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zd._fromErrorAndOperation(n,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mB(n,e){const t=Z(n);await Xf(!0,t,e);const{providerUserInfo:r}=await w4(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=ok(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Uv(n,e,t=!1){const r=await jr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Dn._forOperation(n,"link",r)}async function Xf(n,e,t){await Ku(e);const r=ok(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";z(r.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ak(n,e,t=!1){const{auth:r}=n;if(Ge(r.app))return Promise.reject(wt(r));const i="reauthenticate";try{const s=await jr(n,sk(r,i,e,n),t);z(s.idToken,r,"internal-error");const o=Qf(s.idToken);z(o,r,"internal-error");const{sub:a}=o;return z(n.uid===a,r,"user-mismatch"),Dn._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Pt(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lk(n,e,t=!1){if(Ge(n.app))return Promise.reject(wt(n));const r="signIn",i=await sk(n,r,e),s=await Dn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Zf(n,e){return lk(Qe(n),e)}async function uk(n,e){const t=Z(n);return await Xf(!1,t,e.providerId),Uv(t,e)}async function ck(n,e){return ak(Z(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gB(n,e){return Hr(n,"POST","/v1/accounts:signInWithCustomToken",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _B(n,e){if(Ge(n.app))return Promise.reject(wt(n));const t=Qe(n),r=await gB(t,{token:e,returnSecureToken:!0}),i=await Dn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Bv._fromServerResponse(e,t):"totpInfo"in t?jv._fromServerResponse(e,t):Pt(e,"internal-error")}}class Bv extends Ac{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Bv(t)}}class jv extends Ac{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new jv(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(n,e,t){var r;z(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),z(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(z(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(z(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zv(n){const e=Qe(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function yB(n,e,t){const r=Qe(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&ep(r,i,t),await Hu(r,i,"getOobCode",Z4)}async function vB(n,e,t){await rk(Z(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&zv(n),r})}async function wB(n,e){await Y4(Z(n),{oobCode:e})}async function hk(n,e){const t=Z(n),r=await rk(t,{oobCode:e}),i=r.requestType;switch(z(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":z(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":z(r.mfaInfo,t,"internal-error");default:z(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Ac._fromServerResponse(Qe(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function IB(n,e){const{data:t}=await hk(Z(n),e);return t.email}async function EB(n,e,t){if(Ge(n.app))return Promise.reject(wt(n));const r=Qe(n),o=await Hu(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ik).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&zv(n),l}),a=await Dn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function TB(n,e,t){return Ge(n.app)?Promise.reject(wt(n)):Zf(Z(n),Ji.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&zv(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SB(n,e,t){const r=Qe(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){z(a.handleCodeInApp,r,"argument-error"),a&&ep(r,o,a)}s(i,t),await Hu(r,i,"getOobCode",eB)}function CB(n,e){const t=Jf.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function RB(n,e,t){if(Ge(n.app))return Promise.reject(wt(n));const r=Z(n),i=Ji.credentialWithLink(e,t||Gu());return z(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Zf(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(n,e){return Je(n,"POST","/v1/accounts:createAuthUri",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PB(n,e){const t=Vv()?Gu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await AB(Z(n),r);return i||[]}async function kB(n,e){const t=Z(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&ep(t.auth,i,e);const{email:s}=await X4(t.auth,i);s!==n.email&&await n.reload()}async function NB(n,e,t){const r=Z(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&ep(r.auth,s,t);const{email:o}=await tB(r.auth,s);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bB(n,e){return Je(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xB(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Z(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await jr(r,bB(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function DB(n,e){const t=Z(n);return Ge(t.auth.app)?Promise.reject(wt(t.auth)):dk(t,e,null)}function OB(n,e){return dk(Z(n),null,e)}async function dk(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const o=await jr(n,H4(r,s));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(n){var e,t;if(!n)return null;const{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const o=(t=(e=Qf(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new Yo(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new LB(s,i);case"github.com":return new MB(s,i);case"google.com":return new FB(s,i);case"twitter.com":return new UB(s,i,n.screenName||null);case"custom":case"anonymous":return new Yo(s,null);default:return new Yo(s,r,i)}}class Yo{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class fk extends Yo{constructor(e,t,r,i){super(e,t,r),this.username=i}}class LB extends Yo{constructor(e,t){super(e,"facebook.com",t)}}class MB extends fk{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class FB extends Yo{constructor(e,t){super(e,"google.com",t)}}class UB extends fk{constructor(e,t,r){super(e,"twitter.com",t,r)}}function BB(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:VB(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new ys("enroll",e,t)}static _fromMfaPendingCredential(e){return new ys("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return ys._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return ys._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Qe(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Ac._fromServerResponse(r,a));z(i.mfaPendingCredential,r,"internal-error");const o=ys._fromMfaPendingCredential(i.mfaPendingCredential);return new qv(o,s,async a=>{const l=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const c=Object.assign(Object.assign({},i),{idToken:l.idToken,refreshToken:l.refreshToken});switch(t.operationType){case"signIn":const h=await Dn._fromIdTokenResponse(r,t.operationType,c);return await r._updateCurrentUser(h.user),h;case"reauthenticate":return z(t.user,r,"internal-error"),Dn._forOperation(t.user,t.operationType,c);default:Pt(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function jB(n,e){var t;const r=Z(n),i=e;return z(e.customData.operationType,r,"argument-error"),z((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),qv._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(n,e){return Je(n,"POST","/v2/accounts/mfaEnrollment:start",Ye(n,e))}function qB(n,e){return Je(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ye(n,e))}function $B(n,e){return Je(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ye(n,e))}class $v{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Ac._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new $v(e)}async getSession(){return ys._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await jr(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await jr(this.user,$B(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const wm=new WeakMap;function WB(n){const e=Z(n);return wm.has(e)||wm.set(e,$v._fromUser(e)),wm.get(e)}const qd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qd,"1"),this.storage.removeItem(qd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GB(){const n=Le();return Mv(n)||qa(n)}const KB=1e3,HB=10;class mk extends pk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=GB()&&b4(),this.fallbackToPolling=Z1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);N4()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,HB):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},KB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}mk.type="LOCAL";const Wv=mk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk extends pk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}gk.type="SESSION";const js=gk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new tp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(t.origin,s)),l=await QB(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=Pc("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(d){const p=d;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(){return window}function JB(n){it().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(){return typeof it().WorkerGlobalScope<"u"&&typeof it().importScripts=="function"}async function XB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZB(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function ej(){return Gv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k="firebaseLocalStorageDb",tj=1,$d="firebaseLocalStorage",yk="fbase_key";class kc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function np(n,e){return n.transaction([$d],e?"readwrite":"readonly").objectStore($d)}function nj(){const n=indexedDB.deleteDatabase(_k);return new kc(n).toPromise()}function o_(){const n=indexedDB.open(_k,tj);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore($d,{keyPath:yk})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains($d)?e(r):(r.close(),await nj(),e(await o_()))})})}async function S0(n,e,t){const r=np(n,!0).put({[yk]:e,value:t});return new kc(r).toPromise()}async function rj(n,e){const t=np(n,!1).get(e),r=await new kc(t).toPromise();return r===void 0?null:r.value}function C0(n,e){const t=np(n,!0).delete(e);return new kc(t).toPromise()}const ij=800,sj=3;class vk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await o_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>sj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Gv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tp._getInstance(ej()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await XB(),!this.activeServiceWorker)return;this.sender=new YB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await o_();return await S0(e,qd,"1"),await C0(e,qd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>S0(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>rj(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>C0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=np(i,!1).getAll();return new kc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ij)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vk.type="LOCAL";const Yu=vk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(n,e){return Je(n,"POST","/v2/accounts/mfaSignIn:start",Ye(n,e))}function aj(n,e){return Je(n,"POST","/v2/accounts/mfaSignIn:finalize",Ye(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=500,uj=6e4,Eh=1e12;class cj{constructor(e){this.auth=e,this.counter=Eh,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new hj(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Eh;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Eh;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Eh;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class hj{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;z(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=dj(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},uj)},lj))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function dj(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im=tk("rcb"),fj=new Sc(3e4,6e4);class pj{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=it().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return z(mj(t),e,"argument-error"),this.shouldResolveImmediately(t)&&m0(it().grecaptcha)?Promise.resolve(it().grecaptcha):new Promise((r,i)=>{const s=it().setTimeout(()=>{i(ct(e,"network-request-failed"))},fj.get());it()[Im]=()=>{it().clearTimeout(s),delete it()[Im];const a=it().grecaptcha;if(!a||!m0(a)){i(ct(e,"internal-error"));return}const l=a.render;a.render=(c,h)=>{const d=l(c,h);return this.counter++,d},this.hostLanguage=t,r(a)};const o=`${F4()}?${Xs({onload:Im,render:"explicit",hl:t})}`;Fv(o).catch(()=>{clearTimeout(s),i(ct(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=it().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function mj(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class gj{async load(e){return new cj(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="recaptcha",_j={theme:"light",type:"image"};let yj=class{constructor(e,t,r=Object.assign({},_j)){this.parameters=r,this.type=wk,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Qe(e),this.isInvisible=this.parameters.size==="invisible",z(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;z(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new gj:new pj,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){z(!this.parameters.sitekey,this.auth,"argument-error"),z(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),z(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=it()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){z(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){z(Vv()&&!Gv(),this.auth,"internal-error"),await vj(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await _4(this.auth);z(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return z(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function vj(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ss._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function wj(n,e,t){if(Ge(n.app))return Promise.reject(wt(n));const r=Qe(n),i=await rp(r,e,Z(t));return new Kv(i,s=>Zf(r,s))}async function Ij(n,e,t){const r=Z(n);await Xf(!1,r,"phone");const i=await rp(r.auth,e,Z(t));return new Kv(i,s=>uk(r,s))}async function Ej(n,e,t){const r=Z(n);if(Ge(r.auth.app))return Promise.reject(wt(r.auth));const i=await rp(r.auth,e,Z(t));return new Kv(i,s=>ck(r,s))}async function rp(n,e,t){var r;const i=await t.verify();try{z(typeof i=="string",n,"argument-error"),z(t.type===wk,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s)return z(o.type==="enroll",n,"internal-error"),(await zB(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{z(o.type==="signin",n,"internal-error");const a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return z(a,n,"missing-multi-factor-info"),(await oj(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await sB(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}}async function Tj(n,e){const t=Z(n);if(Ge(t.auth.app))return Promise.reject(wt(t.auth));await Uv(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zs=class Hh{constructor(e){this.providerId=Hh.PROVIDER_ID,this.auth=Qe(e)}verifyPhoneNumber(e,t){return rp(this.auth,e,Z(t))}static credential(e,t){return Ss._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Hh.credentialFromTaggedObject(t)}static credentialFromError(e){return Hh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Ss._fromTokenResponse(t,r):null}};zs.PROVIDER_ID="phone";zs.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(n,e){return e?_n(e):(z(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv extends $a{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return xr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return xr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Sj(n){return lk(n.auth,new Hv(n),n.bypassAuthState)}function Cj(n){const{auth:e,user:t}=n;return z(t,e,"internal-error"),ak(t,new Hv(n),n.bypassAuthState)}async function Rj(n){const{auth:e,user:t}=n;return z(t,e,"internal-error"),Uv(t,new Hv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Sj;case"linkViaPopup":case"linkViaRedirect":return Rj;case"reauthViaPopup":case"reauthViaRedirect":return Cj;default:Pt(this.auth,"internal-error")}}resolve(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=new Sc(2e3,1e4);async function Pj(n,e,t){if(Ge(n.app))return Promise.reject(ct(n,"operation-not-supported-in-this-environment"));const r=Qe(n);za(n,e,Qr);const i=io(r,t);return new Pr(r,"signInViaPopup",e,i).executeNotNull()}async function kj(n,e,t){const r=Z(n);if(Ge(r.auth.app))return Promise.reject(ct(r.auth,"operation-not-supported-in-this-environment"));za(r.auth,e,Qr);const i=io(r.auth,t);return new Pr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function Nj(n,e,t){const r=Z(n);za(r.auth,e,Qr);const i=io(r.auth,t);return new Pr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class Pr extends Ik{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Pr.currentPopupAction&&Pr.currentPopupAction.cancel(),Pr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return z(e,this.auth,"internal-error"),e}async onExecution(){Yn(this.filter.length===1,"Popup operations only handle one event");const e=Pc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ct(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ct(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ct(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Aj.get())};e()}}Pr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj="pendingRedirect",nu=new Map;class xj extends Ik{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=nu.get(this.auth._key());if(!e){try{const r=await Dj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}nu.set(this.auth._key(),e)}return this.bypassAuthState||nu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Dj(n,e){const t=Tk(e),r=Ek(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function Qv(n,e){return Ek(n)._set(Tk(e),"true")}function Oj(){nu.clear()}function Yv(n,e){nu.set(n._key(),e)}function Ek(n){return _n(n._redirectPersistence)}function Tk(n){return Ts(bj,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(n,e,t){return Lj(n,e,t)}async function Lj(n,e,t){if(Ge(n.app))return Promise.reject(wt(n));const r=Qe(n);za(n,e,Qr),await r._initializationPromise;const i=io(r,t);return await Qv(i,r),i._openRedirect(r,e,"signInViaRedirect")}function Mj(n,e,t){return Fj(n,e,t)}async function Fj(n,e,t){const r=Z(n);if(za(r.auth,e,Qr),Ge(r.auth.app))return Promise.reject(wt(r.auth));await r.auth._initializationPromise;const i=io(r.auth,t);await Qv(i,r.auth);const s=await Sk(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function Uj(n,e,t){return Bj(n,e,t)}async function Bj(n,e,t){const r=Z(n);za(r.auth,e,Qr),await r.auth._initializationPromise;const i=io(r.auth,t);await Xf(!1,r,e.providerId),await Qv(i,r.auth);const s=await Sk(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function jj(n,e){return await Qe(n)._initializationPromise,ip(n,e,!1)}async function ip(n,e,t=!1){if(Ge(n.app))return Promise.reject(wt(n));const r=Qe(n),i=io(r,e),o=await new xj(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function Sk(n){const e=Pc(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=10*60*1e3;class Ck{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Rk(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ct(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zj&&this.cachedEventUids.clear(),this.cachedEventUids.has(R0(e))}saveEventToCache(e){this.cachedEventUids.add(R0(e)),this.lastProcessedEventTime=Date.now()}}function R0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Rk({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rk(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak(n,e={}){return Je(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wj=/^https?/;async function Gj(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Ak(n);for(const t of e)try{if(Kj(t))return}catch{}Pt(n,"unauthorized-domain")}function Kj(n){const e=Gu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Wj.test(t))return!1;if($j.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj=new Sc(3e4,6e4);function A0(){const n=it().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Qj(n){return new Promise((e,t)=>{var r,i,s;function o(){A0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{A0(),t(ct(n,"network-request-failed"))},timeout:Hj.get()})}if(!((i=(r=it().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=it().gapi)===null||s===void 0)&&s.load)o();else{const a=tk("iframefcb");return it()[a]=()=>{gapi.load?o():t(ct(n,"network-request-failed"))},Fv(`${B4()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Qh=null,e})}let Qh=null;function Yj(n){return Qh=Qh||Qj(n),Qh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=new Sc(5e3,15e3),Xj="__/auth/iframe",Zj="emulator/auth/iframe",ez={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nz(n){const e=n.config;z(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Lv(e,Zj):`https://${n.config.authDomain}/${Xj}`,r={apiKey:e.apiKey,appName:n.name,v:$r},i=tz.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Xs(r).slice(1)}`}async function rz(n){const e=await Yj(n),t=it().gapi;return z(t,n,"internal-error"),e.open({where:document.body,url:nz(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ez,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=ct(n,"network-request-failed"),a=it().setTimeout(()=>{s(o)},Jj.get());function l(){it().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sz=500,oz=600,az="_blank",lz="http://localhost";class P0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function uz(n,e,t,r=sz,i=oz){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},iz),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Le().toLowerCase();t&&(a=Q1(c)?az:t),H1(c)&&(e=e||lz,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[_,E])=>`${p}${_}=${E},`,"");if(k4(c)&&a!=="_self")return cz(e||"",a),new P0(null);const d=window.open(e||"",a,h);z(d,n,"popup-blocked");try{d.focus()}catch{}return new P0(d)}function cz(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz="__/auth/handler",dz="emulator/auth/handler",fz=encodeURIComponent("fac");async function a_(n,e,t,r,i,s){z(n.config.authDomain,n,"auth-domain-config-required"),z(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:$r,eventId:i};if(e instanceof Qr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Pg(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries(s||{}))o[h]=d}if(e instanceof Wa){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${fz}=${encodeURIComponent(l)}`:"";return`${pz(n)}?${Xs(a).slice(1)}${c}`}function pz({config:n}){return n.emulator?Lv(n,dz):`https://${n.authDomain}/${hz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Em="webStorageSupport";class mz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=js,this._completeRedirectFn=ip,this._overrideRedirectResult=Yv}async _openPopup(e,t,r,i){var s;Yn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await a_(e,t,r,Gu(),i);return uz(e,o,Pc())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await a_(e,t,r,Gu(),i);return JB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Yn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await rz(e),r=new Ck(e);return t.register("authEvent",i=>(z(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Em,{type:Em},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Em];o!==void 0&&t(!!o),Pt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Gj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Z1()||Mv()||qa()}}const gz=mz;class _z{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ar("unexpected MultiFactorSessionType")}}}class Jv extends _z{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Jv(e)}_finalizeEnroll(e,t,r){return qB(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return aj(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Pk{constructor(){}static assertion(e){return Jv._fromCredential(e)}}Pk.FACTOR_ID="phone";var k0="@firebase/auth",N0="1.7.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wz(n){Fr(new Hn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;z(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ek(n)},c=new L4(r,i,s,l);return $4(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Fr(new Hn("auth-internal",e=>{const t=Qe(e.getProvider("auth").getImmediate());return(r=>new yz(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vn(k0,N0,vz(n)),vn(k0,N0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iz=5*60;TV("authIdTokenMaxAge");function Ez(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}M4({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=ct("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Ez().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wz("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tz=2e3;async function Sz(n,e,t){var r;const{BuildInfo:i}=qs();Yn(e.sessionId,"AuthEvent did not contain a session ID");const s=await kz(e.sessionId),o={};return qa()?o.ibi=i.packageName:Cc()?o.apn=i.packageName:Pt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,a_(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function Cz(n){const{BuildInfo:e}=qs(),t={};qa()?t.iosBundleId=e.packageName:Cc()?t.androidPackageName=e.packageName:Pt(n,"operation-not-supported-in-this-environment"),await Ak(n,t)}function Rz(n){const{cordova:e}=qs();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,P4()?"_blank":"_system","location=yes"),t(i)})})}async function Az(n,e,t){const{cordova:r}=qs();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function l(){var d;s();const p=(d=r.plugins.browsertab)===null||d===void 0?void 0:d.close;typeof p=="function"&&p(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function c(){a||(a=window.setTimeout(()=>{o(ct(n,"redirect-cancelled-by-user"))},Tz))}function h(){(document==null?void 0:document.visibilityState)==="visible"&&c()}e.addPassiveListener(l),document.addEventListener("resume",c,!1),Cc()&&document.addEventListener("visibilitychange",h,!1),i=()=>{e.removePassiveListener(l),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",h,!1),a&&window.clearTimeout(a)}})}finally{i()}}function Pz(n){var e,t,r,i,s,o,a,l,c,h;const d=qs();z(typeof((e=d==null?void 0:d.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),z(typeof((t=d==null?void 0:d.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),z(typeof((s=(i=(r=d==null?void 0:d.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),z(typeof((l=(a=(o=d==null?void 0:d.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||l===void 0?void 0:l.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),z(typeof((h=(c=d==null?void 0:d.cordova)===null||c===void 0?void 0:c.InAppBrowser)===null||h===void 0?void 0:h.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function kz(n){const e=Nz(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function Nz(n){if(Yn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bz=20;class xz extends Ck{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Dz(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Lz(),postBody:null,tenantId:n.tenantId,error:ct(n,"no-auth-event")}}function Oz(n,e){return l_()._set(u_(n),e)}async function b0(n){const e=await l_()._get(u_(n));return e&&await l_()._remove(u_(n)),e}function Vz(n,e){var t,r;const i=Fz(e);if(i.includes("/__/auth/callback")){const s=Yh(i),o=s.firebaseError?Mz(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o==null?void 0:o.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],l=a?ct(a):null;return l?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function Lz(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<bz;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function l_(){return _n(Wv)}function u_(n){return Ts("authEvent",n.config.apiKey,n.name)}function Mz(n){try{return JSON.parse(n)}catch{return null}}function Fz(n){const e=Yh(n),t=e.link?decodeURIComponent(e.link):void 0,r=Yh(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Yh(i).link||i||r||t||n}function Yh(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Lo(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uz=500;class Bz{constructor(){this._redirectPersistence=js,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ip,this._overrideRedirectResult=Yv}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new xz(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Pt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){Pz(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),Oj(),await this._originValidation(e);const o=Dz(e,r,i);await Oz(e,o);const a=await Sz(e,o,t),l=await Rz(a);return Az(e,s,l)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Cz(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=qs(),o=setTimeout(async()=>{await b0(e),t.onEvent(x0())},Uz),a=async h=>{clearTimeout(o);const d=await b0(e);let p=null;d&&(h!=null&&h.url)&&(p=Vz(d,h.url)),t.onEvent(p||x0())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const l=i,c=`${s.packageName.toLowerCase()}://`;qs().handleOpenURL=async h=>{if(h.toLowerCase().startsWith(c)&&a({url:h}),typeof l=="function")try{l(h)}catch(d){console.error(d)}}}}const jz=Bz;function x0(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ct("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zz(n,e){Qe(n)._logFramework(e)}var qz="@firebase/auth-compat",$z="0.5.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz=1e3;function ru(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function Gz(){return ru()==="http:"||ru()==="https:"}function kk(n=Le()){return!!((ru()==="file:"||ru()==="ionic:"||ru()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function Kz(){return Cf()||Cy()}function Hz(){return HR()&&(document==null?void 0:document.documentMode)===11}function Qz(n=Le()){return/Edge\/\d+/.test(n)}function Yz(n=Le()){return Hz()||Qz(n)}function Nk(){try{const n=self.localStorage,e=Pc();if(n)return n.setItem(e,"1"),n.removeItem(e),Yz()?Pu():!0}catch{return Xv()&&Pu()}return!1}function Xv(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Tm(){return(Gz()||KR()||kk())&&!Kz()&&Nk()&&!Xv()}function bk(){return kk()&&typeof document<"u"}async function Jz(){return bk()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},Wz);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function Xz(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn={LOCAL:"local",NONE:"none",SESSION:"session"},El=z,xk="persistence";function Zz(n,e){if(El(Object.values(mn).includes(e),n,"invalid-persistence-type"),Cf()){El(e!==mn.SESSION,n,"unsupported-persistence-type");return}if(Cy()){El(e===mn.NONE,n,"unsupported-persistence-type");return}if(Xv()){El(e===mn.NONE||e===mn.LOCAL&&Pu(),n,"unsupported-persistence-type");return}El(e===mn.NONE||Nk(),n,"unsupported-persistence-type")}async function c_(n){await n._initializationPromise;const e=Dk(),t=Ts(xk,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function e3(n,e){const t=Dk();if(!t)return[];const r=Ts(xk,n,e);switch(t.getItem(r)){case mn.NONE:return[Sa];case mn.LOCAL:return[Yu,js];case mn.SESSION:return[js];default:return[]}}function Dk(){var n;try{return((n=Xz())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=z;class mi{constructor(){this.browserResolver=_n(gz),this.cordovaResolver=_n(jz),this.underlyingResolver=null,this._redirectPersistence=js,this._completeRedirectFn=ip,this._overrideRedirectResult=Yv}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return bk()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return t3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await Jz();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(n){return n.unwrap()}function n3(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r3(n){return Vk(n)}function i3(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new s3(n,jB(n,e))}else if(r){const i=Vk(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function Vk(n){const{_tokenResponse:e}=n instanceof Gt?n.customData:n;if(!e)return null;if(!(n instanceof Gt)&&"temporaryProof"in e&&"phoneNumber"in e)return zs.credentialFromResult(n);const t=e.providerId;if(!t||t===Il.PASSWORD)return null;let r;switch(t){case Il.GOOGLE:r=nr;break;case Il.FACEBOOK:r=tr;break;case Il.GITHUB:r=rr;break;case Il.TWITTER:r=ir;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:l}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Ca._create(t,a):pr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Qo(t).credential({idToken:i,accessToken:s,rawNonce:l})}return n instanceof Gt?r.credentialFromError(n):r.credentialFromResult(n)}function Zt(n,e){return e.catch(t=>{throw t instanceof Gt&&i3(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:r3(t),additionalUserInfo:BB(t),user:kr.getOrCreate(i)}})}async function h_(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Zt(n,t.confirm(r))}}class s3{constructor(e,t){this.resolver=t,this.auth=n3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Zt(Ok(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this._delegate=e,this.multiFactor=WB(e)}static getOrCreate(e){return kr.USER_MAP.has(e)||kr.USER_MAP.set(e,new kr(e)),kr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Zt(this.auth,uk(this._delegate,e))}async linkWithPhoneNumber(e,t){return h_(this.auth,Ij(this._delegate,e,t))}async linkWithPopup(e){return Zt(this.auth,Nj(this._delegate,e,mi))}async linkWithRedirect(e){return await c_(Qe(this.auth)),Uj(this._delegate,e,mi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Zt(this.auth,ck(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return h_(this.auth,Ej(this._delegate,e,t))}reauthenticateWithPopup(e){return Zt(this.auth,kj(this._delegate,e,mi))}async reauthenticateWithRedirect(e){return await c_(Qe(this.auth)),Mj(this._delegate,e,mi)}sendEmailVerification(e){return kB(this._delegate,e)}async unlink(e){return await mB(this._delegate,e),this}updateEmail(e){return DB(this._delegate,e)}updatePassword(e){return OB(this._delegate,e)}updatePhoneNumber(e){return Tj(this._delegate,e)}updateProfile(e){return xB(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return NB(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}kr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=z;class d_{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Tl(r,"invalid-api-key",{appName:e.name}),Tl(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?mi:void 0;this._delegate=t.initialize({options:{persistence:o3(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(a4),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?kr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){W4(this._delegate,e,t)}applyActionCode(e){return wB(this._delegate,e)}checkActionCode(e){return hk(this._delegate,e)}confirmPasswordReset(e,t){return vB(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Zt(this._delegate,EB(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return PB(this._delegate,e)}isSignInWithEmailLink(e){return CB(this._delegate,e)}async getRedirectResult(){Tl(Tm(),this._delegate,"operation-not-supported-in-this-environment");const e=await jj(this._delegate,mi);return e?Zt(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){zz(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:o}=D0(e,t,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:o}=D0(e,t,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,t){return SB(this._delegate,e,t)}sendPasswordResetEmail(e,t){return yB(this._delegate,e,t||void 0)}async setPersistence(e){Zz(this._delegate,e);let t;switch(e){case mn.SESSION:t=js;break;case mn.LOCAL:t=await _n(Yu)._isAvailable()?Yu:Wv;break;case mn.NONE:t=Sa;break;default:return Pt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Zt(this._delegate,pB(this._delegate))}signInWithCredential(e){return Zt(this._delegate,Zf(this._delegate,e))}signInWithCustomToken(e){return Zt(this._delegate,_B(this._delegate,e))}signInWithEmailAndPassword(e,t){return Zt(this._delegate,TB(this._delegate,e,t))}signInWithEmailLink(e,t){return Zt(this._delegate,RB(this._delegate,e,t))}signInWithPhoneNumber(e,t){return h_(this._delegate,wj(this._delegate,e,t))}async signInWithPopup(e){return Tl(Tm(),this._delegate,"operation-not-supported-in-this-environment"),Zt(this._delegate,Pj(this._delegate,e,mi))}async signInWithRedirect(e){return Tl(Tm(),this._delegate,"operation-not-supported-in-this-environment"),await c_(this._delegate),Vj(this._delegate,e,mi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return IB(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}d_.Persistence=mn;function D0(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:o=>i(o&&kr.getOrCreate(o)),error:e,complete:t}}function o3(n,e){const t=e3(n,e);if(typeof self<"u"&&!t.includes(Yu)&&t.push(Yu),typeof window<"u")for(const r of[Wv,js])t.includes(r)||t.push(r);return t.includes(Sa)||t.push(Sa),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(){this.providerId="phone",this._delegate=new zs(Ok(et.auth()))}static credential(e,t){return zs.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Zv.PHONE_SIGN_IN_METHOD=zs.PHONE_SIGN_IN_METHOD;Zv.PROVIDER_ID=zs.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=z;class l3{constructor(e,t,r=et.app()){var i;a3((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new yj(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3="auth-compat";function c3(n){n.INTERNAL.registerComponent(new Hn(u3,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new d_(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:_o.EMAIL_SIGNIN,PASSWORD_RESET:_o.PASSWORD_RESET,RECOVER_EMAIL:_o.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:_o.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:_o.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:_o.VERIFY_EMAIL}},EmailAuthProvider:Ji,FacebookAuthProvider:tr,GithubAuthProvider:rr,GoogleAuthProvider:nr,OAuthProvider:Qo,SAMLAuthProvider:jd,PhoneAuthProvider:Zv,PhoneMultiFactorGenerator:Pk,RecaptchaVerifier:l3,TwitterAuthProvider:ir,Auth:d_,AuthCredential:$a,Error:Gt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(qz,$z)}c3(et);const O0="@firebase/database",V0="1.0.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lk="";function h3(n){Lk=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_t(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:ku(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Kn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new d3(e)}}catch{}return new f3},vs=Mk("localStorage"),f_=Mk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=new cc("@firebase/database"),p3=function(){let n=1;return function(){return n++}}(),Fk=function(n){const e=DV(n),t=new NV;t.update(e);const r=t.digest();return Ey.encodeByteArray(r)},Nc=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Nc.apply(null,r):typeof r=="object"?e+=_t(r):e+=r,e+=" "}return e};let Cs=null,L0=!0;const m3=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Jo.logLevel=oe.VERBOSE,Cs=Jo.log.bind(Jo),e&&f_.set("logging_enabled",!0)):typeof n=="function"?Cs=n:(Cs=null,f_.remove("logging_enabled"))},Lt=function(...n){if(L0===!0&&(L0=!1,Cs===null&&f_.get("logging_enabled")===!0&&m3(!0)),Cs){const e=Nc.apply(null,n);Cs(e)}},bc=function(n){return function(...e){Lt(n,...e)}},p_=function(...n){const e="FIREBASE INTERNAL ERROR: "+Nc(...n);Jo.error(e)},zr=function(...n){const e=`FIREBASE FATAL ERROR: ${Nc(...n)}`;throw Jo.error(e),new Error(e)},wn=function(...n){const e="FIREBASE WARNING: "+Nc(...n);Jo.warn(e)},g3=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&wn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Uk=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},_3=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ra="[MIN_NAME]",$s="[MAX_NAME]",Ga=function(n,e){if(n===e)return 0;if(n===Ra||e===$s)return-1;if(e===Ra||n===$s)return 1;{const t=M0(n),r=M0(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},y3=function(n,e){return n===e?0:n<e?-1:1},Sl=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+_t(e))},ew=function(n){if(typeof n!="object"||n===null)return _t(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=_t(e[r]),t+=":",t+=ew(n[e[r]]);return t+="}",t},Bk=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function hn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const jk=function(n){$(!Uk(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,a,l;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const h=c.join("");let d="";for(l=0;l<64;l+=8){let p=parseInt(h.substr(l,8),2).toString(16);p.length===1&&(p="0"+p),d=d+p}return d.toLowerCase()},v3=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},w3=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function I3(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const E3=new RegExp("^-?(0*)\\d{1,10}$"),T3=-2147483648,S3=2147483647,M0=function(n){if(E3.test(n)){const e=Number(n);if(e>=T3&&e<=S3)return e}return null},xc=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw wn("Exception was thrown by user callback.",t),e},Math.floor(0))}},C3=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},iu=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){wn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Lt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',wn(e)}}class Xo{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Xo.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="5",zk="v",qk="s",$k="r",Wk="f",Gk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Kk="ls",Hk="p",m_="ac",Qk="websocket",Yk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,t,r,i,s=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&vs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function P3(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Xk(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let r;if(e===Qk)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Yk)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);P3(n)&&(t.ns=n.namespace);const i=[];return hn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(){this.counters_={}}incrementCounter(e,t=1){Kn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return mV(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm={},Cm={};function nw(n){const e=n.toString();return Sm[e]||(Sm[e]=new k3),Sm[e]}function N3(n,e){const t=n.toString();return Cm[t]||(Cm[t]=e()),Cm[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&xc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0="start",x3="close",D3="pLPCommand",O3="pRTLPCB",Zk="id",eN="pw",tN="ser",V3="cb",L3="seg",M3="ts",F3="d",U3="dframe",nN=1870,rN=30,B3=nN-rN,j3=25e3,z3=3e4;class Mo{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bc(e),this.stats_=nw(t),this.urlFn=l=>(this.appCheckToken&&(l[m_]=this.appCheckToken),Xk(t,Yk,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new b3(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(z3)),_3(()=>{if(this.isClosed_)return;this.scriptTagHolder=new rw((...s)=>{const[o,a,l,c,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===F0)this.id=a,this.password=l;else if(o===x3)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[F0]="t",r[tN]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[V3]=this.scriptTagHolder.uniqueCallbackIdentifier),r[zk]=tw,this.transportSessionId&&(r[qk]=this.transportSessionId),this.lastSessionId&&(r[Kk]=this.lastSessionId),this.applicationId&&(r[Hk]=this.applicationId),this.appCheckToken&&(r[m_]=this.appCheckToken),typeof location<"u"&&location.hostname&&Gk.test(location.hostname)&&(r[$k]=Wk);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Mo.forceAllow_=!0}static forceDisallow(){Mo.forceDisallow_=!0}static isAvailable(){return Mo.forceAllow_?!0:!Mo.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!v3()&&!w3()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=_t(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=zR(t),i=Bk(r,B3);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[U3]="t",r[Zk]=e,r[eN]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=_t(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class rw{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=p3(),window[D3+this.uniqueCallbackIdentifier]=e,window[O3+this.uniqueCallbackIdentifier]=t,this.myIFrame=rw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Lt("frame writing exception"),a.stack&&Lt(a.stack),Lt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Lt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Zk]=this.myID,e[eN]=this.myPW,e[tN]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+rN+r.length<=nN;){const o=this.pendingSegs.shift();r=r+"&"+L3+i+"="+o.seg+"&"+M3+i+"="+o.ts+"&"+F3+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(j3)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Lt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=16384,$3=45e3;let Wd=null;typeof MozWebSocket<"u"?Wd=MozWebSocket:typeof WebSocket<"u"&&(Wd=WebSocket);class Bn{constructor(e,t,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bc(this.connId),this.stats_=nw(t),this.connURL=Bn.connectionURL_(t,o,a,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[zk]=tw,typeof location<"u"&&location.hostname&&Gk.test(location.hostname)&&(o[$k]=Wk),t&&(o[qk]=t),r&&(o[Kk]=r),i&&(o[m_]=i),s&&(o[Hk]=s),Xk(e,Qk,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vs.set("previous_websocket_failure",!0);try{let r;QR(),this.mySock=new Wd(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Bn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Wd!==null&&!Bn.forceDisallow_}static previouslyFailed(){return vs.isInMemoryStorage||vs.get("previous_websocket_failure")===!0}markConnectionHealthy(){vs.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=ku(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if($(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=_t(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=Bk(t,q3);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor($3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Bn.responsesRequiredToBeHealthy=2;Bn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Mo,Bn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Bn&&Bn.isAvailable();let r=t&&!Bn.previouslyFailed();if(e.webSocketOnly&&(t||wn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Bn];else{const i=this.transports_=[];for(const s of Ju.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Ju.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ju.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3=6e4,G3=5e3,K3=10*1024,H3=100*1024,Rm="t",U0="d",Q3="s",B0="r",Y3="e",j0="o",z0="a",q0="n",$0="p",J3="h";class X3{constructor(e,t,r,i,s,o,a,l,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bc("c:"+this.id+":"),this.transportManager_=new Ju(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=iu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>H3?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>K3?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Rm in e){const t=e[Rm];t===z0?this.upgradeIfSecondaryHealthy_():t===B0?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===j0&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Sl("t",e),r=Sl("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:$0,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:z0,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:q0,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Sl("t",e),r=Sl("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Sl(Rm,e);if(U0 in e){const r=e[U0];if(t===J3){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===q0){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Q3?this.onConnectionShutdown_(r):t===B0?this.onReset_(r):t===Y3?p_("Server Error: "+r):t===j0?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):p_("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),tw!==r&&wn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),iu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(W3))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):iu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(G3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:$0,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd extends sN{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Sy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Gd}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=32,G0=768;class Te{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function _e(){return new Te("")}function le(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ji(n){return n.pieces_.length-n.pieceNum_}function Se(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Te(n.pieces_,e)}function oN(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Z3(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function aN(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function lN(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Te(e,0)}function lt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Te)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Te(t,0)}function ue(n){return n.pieceNum_>=n.pieces_.length}function on(n,e){const t=le(n),r=le(e);if(t===null)return e;if(t===r)return on(Se(n),Se(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function iw(n,e){if(ji(n)!==ji(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function jn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ji(n)>ji(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class e6{constructor(e,t){this.errorPrefix_=t,this.parts_=aN(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Rf(this.parts_[r]);uN(this)}}function t6(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Rf(e),uN(n)}function n6(n){const e=n.parts_.pop();n.byteLength_-=Rf(e),n.parts_.length>0&&(n.byteLength_-=1)}function uN(n){if(n.byteLength_>G0)throw new Error(n.errorPrefix_+"has a key path longer than "+G0+" bytes ("+n.byteLength_+").");if(n.parts_.length>W0)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+W0+") or object contains a cycle "+as(n))}function as(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw extends sN{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new sw}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=1e3,r6=60*5*1e3,K0=30*1e3,i6=1.3,s6=3e4,o6="server_kill",H0=3;class Dr extends iN{constructor(e,t,r,i,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Dr.nextPersistentConnectionId_++,this.log_=bc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Cl,this.maxReconnectDelay_=r6,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!QR())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");sw.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Gd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(_t(s)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new Ty,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,c=a.s;Dr.warnOnListenWarnings_(l,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Kn(e,"w")){const r=la(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();wn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||kV(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=K0)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=PV(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_t(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):p_("Unrecognized action received from server: "+_t(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Cl,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Cl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>s6&&(this.reconnectDelay_=Cl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*i6)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Dr.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},c=function(d){$(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,p]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?Lt("getToken() completed but was canceled"):(Lt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,a=new X3(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,_=>{wn(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(o6)},s))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&wn(d),l())}}}interrupt(e){Lt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Lt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Pg(this.interruptReasons_)&&(this.reconnectDelay_=Cl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>ew(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new Te(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){Lt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=H0&&(this.reconnectDelay_=K0,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Lt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=H0&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Lk.replace(/\./g,"-")]=1,Sy()?e["framework.cordova"]=1:Cf()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Gd.getInstance().currentlyOnline();return Pg(this.interruptReasons_)&&e}}Dr.nextPersistentConnectionId_=0;Dr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ae(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new ae(Ra,e),i=new ae(Ra,t);return this.compare(r,i)!==0}minPost(){return ae.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Th;class cN extends sp{static get __EMPTY_NODE(){return Th}static set __EMPTY_NODE(e){Th=e}compare(e,t){return Ga(e.name,t.name)}isDefinedOn(e){throw Da("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ae.MIN}maxPost(){return new ae($s,Th)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new ae(e,Th)}toString(){return".key"}}const Zo=new cN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class gt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??gt.RED,this.left=i??an.EMPTY_NODE,this.right=s??an.EMPTY_NODE}copy(e,t,r,i,s){return new gt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return an.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return an.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}gt.RED=!0;gt.BLACK=!1;class a6{copy(e,t,r,i,s){return this}insert(e,t,r){return new gt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class an{constructor(e,t=an.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new an(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,gt.BLACK,null,null))}remove(e){return new an(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,gt.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Sh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Sh(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Sh(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Sh(this.root_,null,this.comparator_,!0,e)}}an.EMPTY_NODE=new a6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l6(n,e){return Ga(n.name,e.name)}function ow(n,e){return Ga(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g_;function u6(n){g_=n}const hN=function(n){return typeof n=="number"?"number:"+jk(n):"string:"+n},dN=function(n){if(n.isLeafNode()){const e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Kn(e,".sv"),"Priority must be a string or number.")}else $(n===g_||n.isEmpty(),"priority of unexpected type.");$(n===g_||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q0;class dt{constructor(e,t=dt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),dN(this.priorityNode_)}static set __childrenNodeConstructor(e){Q0=e}static get __childrenNodeConstructor(){return Q0}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new dt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:dt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ue(e)?this:le(e)===".priority"?this.priorityNode_:dt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:dt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=le(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:($(r!==".priority"||ji(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,dt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Se(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+hN(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=jk(this.value_):e+=this.value_,this.lazyHash_=Fk(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===dt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof dt.__childrenNodeConstructor?-1:($(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=dt.VALUE_TYPE_ORDER.indexOf(t),s=dt.VALUE_TYPE_ORDER.indexOf(r);return $(i>=0,"Unknown leaf type: "+t),$(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}dt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fN,pN;function c6(n){fN=n}function h6(n){pN=n}class d6 extends sp{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Ga(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ae.MIN}maxPost(){return new ae($s,new dt("[PRIORITY-POST]",pN))}makePost(e,t){const r=fN(e);return new ae(t,new dt("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ke=new d6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6=Math.log(2);class p6{constructor(e){const t=s=>parseInt(Math.log(s)/f6,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Kd=function(n,e,t,r){n.sort(e);const i=function(l,c){const h=c-l;let d,p;if(h===0)return null;if(h===1)return d=n[l],p=t?t(d):d,new gt(p,d.node,gt.BLACK,null,null);{const _=parseInt(h/2,10)+l,E=i(l,_),C=i(_+1,c);return d=n[_],p=t?t(d):d,new gt(p,d.node,gt.BLACK,E,C)}},s=function(l){let c=null,h=null,d=n.length;const p=function(E,C){const P=d-E,I=d;d-=E;const v=i(P+1,I),w=n[P],D=t?t(w):w;_(new gt(D,w.node,C,null,v))},_=function(E){c?(c.left=E,c=E):(h=E,c=E)};for(let E=0;E<l.count;++E){const C=l.nextBitIsOne(),P=Math.pow(2,l.count-(E+1));C?p(P,gt.BLACK):(p(P,gt.BLACK),p(P,gt.RED))}return h},o=new p6(n.length),a=s(o);return new an(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Am;const yo={};class Nr{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return $(yo&&Ke,"ChildrenNode.ts has not been loaded"),Am=Am||new Nr({".priority":yo},{".priority":Ke}),Am}get(e){const t=la(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof an?t:null}hasIndex(e){return Kn(this.indexSet_,e.toString())}addIndex(e,t){$(e!==Zo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(ae.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Kd(r,e.getCompare()):a=yo;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const h=Object.assign({},this.indexes_);return h[l]=a,new Nr(h,c)}addToIndexes(e,t){const r=Cd(this.indexes_,(i,s)=>{const o=la(this.indexSet_,s);if($(o,"Missing index implementation for "+s),i===yo)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(ae.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Kd(a,o.getCompare())}else return yo;else{const a=t.get(e.name);let l=i;return a&&(l=l.remove(new ae(e.name,a))),l.insert(e,e.node)}});return new Nr(r,this.indexSet_)}removeFromIndexes(e,t){const r=Cd(this.indexes_,i=>{if(i===yo)return i;{const s=t.get(e.name);return s?i.remove(new ae(e.name,s)):i}});return new Nr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rl;class ee{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&dN(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Rl||(Rl=new ee(new an(ow),null,Nr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Rl}updatePriority(e){return this.children_.isEmpty()?this:new ee(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Rl:t}}getChild(e){const t=le(e);return t===null?this:this.getImmediateChild(t).getChild(Se(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if($(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new ae(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Rl:this.priorityNode_;return new ee(i,o,s)}}updateChild(e,t){const r=le(e);if(r===null)return t;{$(le(e)!==".priority"||ji(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Se(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(Ke,(o,a)=>{t[o]=a.val(e),r++,s&&ee.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+hN(this.getPriority().val())+":"),this.forEachChild(Ke,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":Fk(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new ae(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ae(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ae(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ae.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ae.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Dc?-1:0}withIndex(e){if(e===Zo||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ee(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Zo||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Ke),i=t.getIterator(Ke);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Zo?null:this.indexMap_.get(e.toString())}}ee.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class m6 extends ee{constructor(){super(new an(ow),ee.EMPTY_NODE,Nr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ee.EMPTY_NODE}isEmpty(){return!1}}const Dc=new m6;Object.defineProperties(ae,{MIN:{value:new ae(Ra,ee.EMPTY_NODE)},MAX:{value:new ae($s,Dc)}});cN.__EMPTY_NODE=ee.EMPTY_NODE;dt.__childrenNodeConstructor=ee;u6(Dc);h6(Dc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g6=!0;function Mt(n,e=null){if(n===null)return ee.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new dt(t,Mt(e))}if(!(n instanceof Array)&&g6){const t=[];let r=!1;if(hn(n,(o,a)=>{if(o.substring(0,1)!=="."){const l=Mt(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),t.push(new ae(o,l)))}}),t.length===0)return ee.EMPTY_NODE;const s=Kd(t,l6,o=>o.name,ow);if(r){const o=Kd(t,Ke.getCompare());return new ee(s,Mt(e),new Nr({".priority":o},{".priority":Ke}))}else return new ee(s,Mt(e),Nr.Default)}else{let t=ee.EMPTY_NODE;return hn(n,(r,i)=>{if(Kn(n,r)&&r.substring(0,1)!=="."){const s=Mt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Mt(e))}}c6(Mt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6 extends sp{constructor(e){super(),this.indexPath_=e,$(!ue(e)&&le(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Ga(e.name,t.name):s}makePost(e,t){const r=Mt(e),i=ee.EMPTY_NODE.updateChild(this.indexPath_,r);return new ae(t,i)}maxPost(){const e=ee.EMPTY_NODE.updateChild(this.indexPath_,Dc);return new ae($s,e)}toString(){return aN(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6 extends sp{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Ga(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ae.MIN}maxPost(){return ae.MAX}makePost(e,t){const r=Mt(e);return new ae(t,r)}toString(){return".value"}}const v6=new y6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(n){return{type:"value",snapshotNode:n}}function Aa(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Xu(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Zu(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function w6(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Xu(t,a)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Aa(t,r)):o.trackChildChange(Zu(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ke,(i,s)=>{t.hasChild(i)||r.trackChildChange(Xu(i,s))}),t.isLeafNode()||t.forEachChild(Ke,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Zu(i,s,o))}else r.trackChildChange(Aa(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ee.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e){this.indexedFilter_=new aw(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ec.getStartPost_(e),this.endPost_=ec.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ae(t,r))||(r=ee.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=ee.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);const s=this;return t.forEachChild(Ke,(o,a)=>{s.matches(new ae(o,a))||(i=i.updateImmediateChild(o,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ec(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ae(t,r))||(r=ee.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=ee.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const d=this.index_.getCompare();o=(p,_)=>d(_,p)}else o=this.index_.getCompare();const a=e;$(a.numChildren()===this.limit_,"");const l=new ae(t,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(t)){const d=a.getImmediateChild(t);let p=i.getChildAfterChild(this.index_,c,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);const _=p==null?1:o(p,l);if(h&&!r.isEmpty()&&_>=0)return s!=null&&s.trackChildChange(Zu(t,r,d)),a.updateImmediateChild(t,r);{s!=null&&s.trackChildChange(Xu(t,d));const C=a.updateImmediateChild(t,ee.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s!=null&&s.trackChildChange(Aa(p.name,p.node)),C.updateImmediateChild(p.name,p.node)):C}}else return r.isEmpty()?e:h&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Xu(c.name,c.node)),s.trackChildChange(Aa(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(c.name,ee.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ke}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ra}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$s}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ke}copy(){const e=new lw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function E6(n){return n.loadsAllData()?new aw(n.getIndex()):n.hasLimit()?new I6(n):new ec(n)}function Y0(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Ke?t="$priority":n.index_===v6?t="$value":n.index_===Zo?t="$key":($(n.index_ instanceof _6,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=_t(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=_t(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+_t(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=_t(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+_t(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function J0(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ke&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd extends iN{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=bc("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Hd.getListenId_(e,r),a={};this.listens_[o]=a;const l=Y0(e._queryParams);this.restRequest_(s+".json",l,(c,h)=>{let d=h;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),la(this.listens_,o)===a){let p;c?c===401?p="permission_denied":p="rest_error:"+c:p="ok",i(p,null)}})}unlisten(e,t){const r=Hd.getListenId_(e,t);delete this.listens_[r]}get(e){const t=Y0(e._queryParams),r=e._path.toString(),i=new Ty;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Xs(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ku(a.responseText)}catch{wn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&wn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(){return{value:null,children:new Map}}function gN(n,e,t){if(ue(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=le(e);n.children.has(r)||n.children.set(r,Qd());const i=n.children.get(r);e=Se(e),gN(i,e,t)}}function __(n,e,t){n.value!==null?t(e,n.value):S6(n,(r,i)=>{const s=new Te(e.toString()+"/"+r);__(i,s,t)})}function S6(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&hn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=10*1e3,R6=30*1e3,A6=5*60*1e3;class P6{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new C6(e);const r=X0+(R6-X0)*Math.random();iu(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;hn(e,(i,s)=>{s>0&&Kn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),iu(this.reportStats_.bind(this),Math.floor(Math.random()*2*A6))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zn;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(zn||(zn={}));function _N(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function uw(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function cw(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=zn.ACK_USER_WRITE,this.source=_N()}operationForChild(e){if(ue(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Te(e));return new Yd(_e(),t,this.revert)}}else return $(le(this.path)===e,"operationForChild called for unrelated child."),new Yd(Se(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t){this.source=e,this.path=t,this.type=zn.LISTEN_COMPLETE}operationForChild(e){return ue(this.path)?new tc(this.source,_e()):new tc(this.source,Se(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=zn.OVERWRITE}operationForChild(e){return ue(this.path)?new Ws(this.source,_e(),this.snap.getImmediateChild(e)):new Ws(this.source,Se(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=zn.MERGE}operationForChild(e){if(ue(this.path)){const t=this.children.subtree(new Te(e));return t.isEmpty()?null:t.value?new Ws(this.source,_e(),t.value):new nc(this.source,_e(),t)}else return $(le(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new nc(this.source,Se(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ue(e))return this.isFullyInitialized()&&!this.filtered_;const t=le(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function N6(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(w6(o.childName,o.snapshotNode))}),Al(n,i,"child_removed",e,r,t),Al(n,i,"child_added",e,r,t),Al(n,i,"child_moved",s,r,t),Al(n,i,"child_changed",e,r,t),Al(n,i,"value",e,r,t),i}function Al(n,e,t,r,i,s){const o=r.filter(a=>a.type===t);o.sort((a,l)=>x6(n,a,l)),o.forEach(a=>{const l=b6(n,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function b6(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function x6(n,e,t){if(e.childName==null||t.childName==null)throw Da("Should only compare child_ events.");const r=new ae(e.childName,e.snapshotNode),i=new ae(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(n,e){return{eventCache:n,serverCache:e}}function su(n,e,t,r){return op(new Gs(e,t,r),n.serverCache)}function yN(n,e,t,r){return op(n.eventCache,new Gs(e,t,r))}function y_(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ks(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pm;const D6=()=>(Pm||(Pm=new an(y3)),Pm);class ke{constructor(e,t=D6()){this.value=e,this.children=t}static fromObject(e){let t=new ke(null);return hn(e,(r,i)=>{t=t.set(new Te(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:_e(),value:this.value};if(ue(e))return null;{const r=le(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Se(e),t);return s!=null?{path:lt(new Te(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ue(e))return this;{const t=le(e),r=this.children.get(t);return r!==null?r.subtree(Se(e)):new ke(null)}}set(e,t){if(ue(e))return new ke(t,this.children);{const r=le(e),s=(this.children.get(r)||new ke(null)).set(Se(e),t),o=this.children.insert(r,s);return new ke(this.value,o)}}remove(e){if(ue(e))return this.children.isEmpty()?new ke(null):new ke(null,this.children);{const t=le(e),r=this.children.get(t);if(r){const i=r.remove(Se(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new ke(null):new ke(this.value,s)}else return this}}get(e){if(ue(e))return this.value;{const t=le(e),r=this.children.get(t);return r?r.get(Se(e)):null}}setTree(e,t){if(ue(e))return t;{const r=le(e),s=(this.children.get(r)||new ke(null)).setTree(Se(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new ke(this.value,o)}}fold(e){return this.fold_(_e(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(lt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,_e(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(ue(e))return null;{const s=le(e),o=this.children.get(s);return o?o.findOnPath_(Se(e),lt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,_e(),t)}foreachOnPath_(e,t,r){if(ue(e))return this;{this.value&&r(t,this.value);const i=le(e),s=this.children.get(i);return s?s.foreachOnPath_(Se(e),lt(t,i),r):new ke(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(lt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.writeTree_=e}static empty(){return new Wn(new ke(null))}}function ou(n,e,t){if(ue(e))return new Wn(new ke(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=on(i,e);return s=s.updateChild(o,t),new Wn(n.writeTree_.set(i,s))}else{const i=new ke(t),s=n.writeTree_.setTree(e,i);return new Wn(s)}}}function Z0(n,e,t){let r=n;return hn(t,(i,s)=>{r=ou(r,lt(e,i),s)}),r}function eS(n,e){if(ue(e))return Wn.empty();{const t=n.writeTree_.setTree(e,new ke(null));return new Wn(t)}}function v_(n,e){return so(n,e)!=null}function so(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(on(t.path,e)):null}function tS(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ke,(r,i)=>{e.push(new ae(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ae(r,i.value))}),e}function Pi(n,e){if(ue(e))return n;{const t=so(n,e);return t!=null?new Wn(new ke(t)):new Wn(n.writeTree_.subtree(e))}}function w_(n){return n.writeTree_.isEmpty()}function Pa(n,e){return vN(_e(),n.writeTree_,e)}function vN(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?($(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=vN(lt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(lt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(n,e){return TN(e,n)}function O6(n,e,t,r,i){$(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ou(n.visibleWrites,e,t)),n.lastWriteId=r}function V6(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function L6(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&M6(a,r.path)?i=!1:jn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return F6(n),!0;if(r.snap)n.visibleWrites=eS(n.visibleWrites,r.path);else{const a=r.children;hn(a,l=>{n.visibleWrites=eS(n.visibleWrites,lt(r.path,l))})}return!0}else return!1}function M6(n,e){if(n.snap)return jn(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&jn(lt(n.path,t),e))return!0;return!1}function F6(n){n.visibleWrites=wN(n.allWrites,U6,_e()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function U6(n){return n.visible}function wN(n,e,t){let r=Wn.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let a;if(s.snap)jn(t,o)?(a=on(t,o),r=ou(r,a,s.snap)):jn(o,t)&&(a=on(o,t),r=ou(r,_e(),s.snap.getChild(a)));else if(s.children){if(jn(t,o))a=on(t,o),r=Z0(r,a,s.children);else if(jn(o,t))if(a=on(o,t),ue(a))r=Z0(r,_e(),s.children);else{const l=la(s.children,le(a));if(l){const c=l.getChild(Se(a));r=ou(r,_e(),c)}}}else throw Da("WriteRecord should have .snap or .children")}}return r}function IN(n,e,t,r,i){if(!r&&!i){const s=so(n.visibleWrites,e);if(s!=null)return s;{const o=Pi(n.visibleWrites,e);if(w_(o))return t;if(t==null&&!v_(o,_e()))return null;{const a=t||ee.EMPTY_NODE;return Pa(o,a)}}}else{const s=Pi(n.visibleWrites,e);if(!i&&w_(s))return t;if(!i&&t==null&&!v_(s,_e()))return null;{const o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(jn(c.path,e)||jn(e,c.path))},a=wN(n.allWrites,o,e),l=t||ee.EMPTY_NODE;return Pa(a,l)}}}function B6(n,e,t){let r=ee.EMPTY_NODE;const i=so(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ke,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Pi(n.visibleWrites,e);return t.forEachChild(Ke,(o,a)=>{const l=Pa(Pi(s,new Te(o)),a);r=r.updateImmediateChild(o,l)}),tS(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Pi(n.visibleWrites,e);return tS(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function j6(n,e,t,r,i){$(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=lt(e,t);if(v_(n.visibleWrites,s))return null;{const o=Pi(n.visibleWrites,s);return w_(o)?i.getChild(t):Pa(o,i.getChild(t))}}function z6(n,e,t,r){const i=lt(e,t),s=so(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=Pi(n.visibleWrites,i);return Pa(o,r.getNode().getImmediateChild(t))}else return null}function q6(n,e){return so(n.visibleWrites,e)}function $6(n,e,t,r,i,s,o){let a;const l=Pi(n.visibleWrites,e),c=so(l,_e());if(c!=null)a=c;else if(t!=null)a=Pa(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],d=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let _=p.getNext();for(;_&&h.length<i;)d(_,r)!==0&&h.push(_),_=p.getNext();return h}else return[]}function W6(){return{visibleWrites:Wn.empty(),allWrites:[],lastWriteId:-1}}function Jd(n,e,t,r){return IN(n.writeTree,n.treePath,e,t,r)}function dw(n,e){return B6(n.writeTree,n.treePath,e)}function nS(n,e,t,r){return j6(n.writeTree,n.treePath,e,t,r)}function Xd(n,e){return q6(n.writeTree,lt(n.treePath,e))}function G6(n,e,t,r,i,s){return $6(n.writeTree,n.treePath,e,t,r,i,s)}function fw(n,e,t){return z6(n.writeTree,n.treePath,e,t)}function EN(n,e){return TN(lt(n.treePath,e),n.writeTree)}function TN(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Zu(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Xu(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Aa(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Zu(r,e.snapshotNode,i.oldSnap));else throw Da("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const SN=new H6;class pw{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Gs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fw(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ks(this.viewCache_),s=G6(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(n){return{filter:n}}function Y6(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function J6(n,e,t,r,i){const s=new K6;let o,a;if(t.type===zn.OVERWRITE){const c=t;c.source.fromUser?o=I_(n,e,c.path,c.snap,r,i,s):($(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ue(c.path),o=Zd(n,e,c.path,c.snap,r,i,a,s))}else if(t.type===zn.MERGE){const c=t;c.source.fromUser?o=Z6(n,e,c.path,c.children,r,i,s):($(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=E_(n,e,c.path,c.children,r,i,a,s))}else if(t.type===zn.ACK_USER_WRITE){const c=t;c.revert?o=nq(n,e,c.path,r,i,s):o=eq(n,e,c.path,c.affectedTree,r,i,s)}else if(t.type===zn.LISTEN_COMPLETE)o=tq(n,e,t.path,r,s);else throw Da("Unknown operation type: "+t.type);const l=s.getChanges();return X6(e,o,l),{viewCache:o,changes:l}}function X6(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=y_(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(mN(y_(e)))}}function CN(n,e,t,r,i,s){const o=e.eventCache;if(Xd(r,t)!=null)return e;{let a,l;if(ue(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Ks(e),h=c instanceof ee?c:ee.EMPTY_NODE,d=dw(r,h);a=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const c=Jd(r,Ks(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=le(t);if(c===".priority"){$(ji(t)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const d=nS(r,t,h,l);d!=null?a=n.filter.updatePriority(h,d):a=o.getNode()}else{const h=Se(t);let d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const p=nS(r,t,o.getNode(),l);p!=null?d=o.getNode().getImmediateChild(c).updateChild(h,p):d=o.getNode().getImmediateChild(c)}else d=fw(r,c,e.serverCache);d!=null?a=n.filter.updateChild(o.getNode(),c,d,h,i,s):a=o.getNode()}}return su(e,a,o.isFullyInitialized()||ue(t),n.filter.filtersNodes())}}function Zd(n,e,t,r,i,s,o,a){const l=e.serverCache;let c;const h=o?n.filter:n.filter.getIndexedFilter();if(ue(t))c=h.updateFullNode(l.getNode(),r,null);else if(h.filtersNodes()&&!l.isFiltered()){const _=l.getNode().updateChild(t,r);c=h.updateFullNode(l.getNode(),_,null)}else{const _=le(t);if(!l.isCompleteForPath(t)&&ji(t)>1)return e;const E=Se(t),P=l.getNode().getImmediateChild(_).updateChild(E,r);_===".priority"?c=h.updatePriority(l.getNode(),P):c=h.updateChild(l.getNode(),_,P,E,SN,null)}const d=yN(e,c,l.isFullyInitialized()||ue(t),h.filtersNodes()),p=new pw(i,d,s);return CN(n,d,t,i,p,a)}function I_(n,e,t,r,i,s,o){const a=e.eventCache;let l,c;const h=new pw(i,e,s);if(ue(t))c=n.filter.updateFullNode(e.eventCache.getNode(),r,o),l=su(e,c,!0,n.filter.filtersNodes());else{const d=le(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),r),l=su(e,c,a.isFullyInitialized(),a.isFiltered());else{const p=Se(t),_=a.getNode().getImmediateChild(d);let E;if(ue(p))E=r;else{const C=h.getCompleteChild(d);C!=null?oN(p)===".priority"&&C.getChild(lN(p)).isEmpty()?E=C:E=C.updateChild(p,r):E=ee.EMPTY_NODE}if(_.equals(E))l=e;else{const C=n.filter.updateChild(a.getNode(),d,E,p,h,o);l=su(e,C,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function rS(n,e){return n.eventCache.isCompleteForChild(e)}function Z6(n,e,t,r,i,s,o){let a=e;return r.foreach((l,c)=>{const h=lt(t,l);rS(e,le(h))&&(a=I_(n,a,h,c,i,s,o))}),r.foreach((l,c)=>{const h=lt(t,l);rS(e,le(h))||(a=I_(n,a,h,c,i,s,o))}),a}function iS(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function E_(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ue(t)?c=r:c=new ke(null).setTree(t,r);const h=e.serverCache.getNode();return c.children.inorderTraversal((d,p)=>{if(h.hasChild(d)){const _=e.serverCache.getNode().getImmediateChild(d),E=iS(n,_,p);l=Zd(n,l,new Te(d),E,i,s,o,a)}}),c.children.inorderTraversal((d,p)=>{const _=!e.serverCache.isCompleteForChild(d)&&p.value===null;if(!h.hasChild(d)&&!_){const E=e.serverCache.getNode().getImmediateChild(d),C=iS(n,E,p);l=Zd(n,l,new Te(d),C,i,s,o,a)}}),l}function eq(n,e,t,r,i,s,o){if(Xd(i,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ue(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Zd(n,e,t,l.getNode().getChild(t),i,s,a,o);if(ue(t)){let c=new ke(null);return l.getNode().forEachChild(Zo,(h,d)=>{c=c.set(new Te(h),d)}),E_(n,e,t,c,i,s,a,o)}else return e}else{let c=new ke(null);return r.foreach((h,d)=>{const p=lt(t,h);l.isCompleteForPath(p)&&(c=c.set(h,l.getNode().getChild(p)))}),E_(n,e,t,c,i,s,a,o)}}function tq(n,e,t,r,i){const s=e.serverCache,o=yN(e,s.getNode(),s.isFullyInitialized()||ue(t),s.isFiltered());return CN(n,o,t,r,SN,i)}function nq(n,e,t,r,i,s){let o;if(Xd(r,t)!=null)return e;{const a=new pw(r,e,i),l=e.eventCache.getNode();let c;if(ue(t)||le(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Jd(r,Ks(e));else{const d=e.serverCache.getNode();$(d instanceof ee,"serverChildren would be complete if leaf node"),h=dw(r,d)}h=h,c=n.filter.updateFullNode(l,h,s)}else{const h=le(t);let d=fw(r,h,e.serverCache);d==null&&e.serverCache.isCompleteForChild(h)&&(d=l.getImmediateChild(h)),d!=null?c=n.filter.updateChild(l,h,d,Se(t),a,s):e.eventCache.getNode().hasChild(h)?c=n.filter.updateChild(l,h,ee.EMPTY_NODE,Se(t),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Jd(r,Ks(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Xd(r,_e())!=null,su(e,c,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new aw(r.getIndex()),s=E6(r);this.processor_=Q6(s);const o=t.serverCache,a=t.eventCache,l=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),h=new Gs(l,o.isFullyInitialized(),i.filtersNodes()),d=new Gs(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=op(d,h),this.eventGenerator_=new k6(this.query_)}get query(){return this.query_}}function iq(n){return n.viewCache_.serverCache.getNode()}function sq(n,e){const t=Ks(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ue(e)&&!t.getImmediateChild(le(e)).isEmpty())?t.getChild(e):null}function sS(n){return n.eventRegistrations_.length===0}function oq(n,e){n.eventRegistrations_.push(e)}function oS(n,e,t){const r=[];if(t){$(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function aS(n,e,t,r){e.type===zn.MERGE&&e.source.queryId!==null&&($(Ks(n.viewCache_),"We should always have a full cache before handling merges"),$(y_(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=J6(n.processor_,i,e,t,r);return Y6(n.processor_,s.viewCache),$(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,RN(n,s.changes,s.viewCache.eventCache.getNode(),null)}function aq(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ke,(s,o)=>{r.push(Aa(s,o))}),t.isFullyInitialized()&&r.push(mN(t.getNode())),RN(n,r,t.getNode(),e)}function RN(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return N6(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ef;class lq{constructor(){this.views=new Map}}function uq(n){$(!ef,"__referenceConstructor has already been defined"),ef=n}function cq(){return $(ef,"Reference.ts has not been loaded"),ef}function hq(n){return n.views.size===0}function mw(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return $(s!=null,"SyncTree gave us an op for an invalid query."),aS(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(aS(o,e,t,r));return s}}function dq(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=Jd(t,i?r:null),l=!1;a?l=!0:r instanceof ee?(a=dw(t,r),l=!1):(a=ee.EMPTY_NODE,l=!1);const c=op(new Gs(a,l,!1),new Gs(r,i,!1));return new rq(e,c)}return o}function fq(n,e,t,r,i,s){const o=dq(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),oq(o,t),aq(o,t)}function pq(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const a=zi(n);if(i==="default")for(const[l,c]of n.views.entries())o=o.concat(oS(c,t,r)),sS(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=n.views.get(i);l&&(o=o.concat(oS(l,t,r)),sS(l)&&(n.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!zi(n)&&s.push(new(cq())(e._repo,e._path)),{removed:s,events:o}}function AN(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ea(n,e){let t=null;for(const r of n.views.values())t=t||sq(r,e);return t}function PN(n,e){if(e._queryParams.loadsAllData())return ap(n);{const r=e._queryIdentifier;return n.views.get(r)}}function kN(n,e){return PN(n,e)!=null}function zi(n){return ap(n)!=null}function ap(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tf;function mq(n){$(!tf,"__referenceConstructor has already been defined"),tf=n}function gq(){return $(tf,"Reference.ts has not been loaded"),tf}let _q=1;class lS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ke(null),this.pendingWriteTree_=W6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function yq(n,e,t,r,i){return O6(n.pendingWriteTree_,e,t,r,i),i?Oc(n,new Ws(_N(),e,t)):[]}function Fo(n,e,t=!1){const r=V6(n.pendingWriteTree_,e);if(L6(n.pendingWriteTree_,e)){let s=new ke(null);return r.snap!=null?s=s.set(_e(),!0):hn(r.children,o=>{s=s.set(new Te(o),!0)}),Oc(n,new Yd(r.path,s,t))}else return[]}function lp(n,e,t){return Oc(n,new Ws(uw(),e,t))}function vq(n,e,t){const r=ke.fromObject(t);return Oc(n,new nc(uw(),e,r))}function wq(n,e){return Oc(n,new tc(uw(),e))}function Iq(n,e,t){const r=gw(n,t);if(r){const i=_w(r),s=i.path,o=i.queryId,a=on(s,e),l=new tc(cw(o),a);return yw(n,s,l)}else return[]}function T_(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||kN(o,e))){const l=pq(o,e,t,r);hq(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!i){const h=c.findIndex(p=>p._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(s,(p,_)=>zi(_));if(h&&!d){const p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){const _=Sq(p);for(let E=0;E<_.length;++E){const C=_[E],P=C.query,I=DN(n,C);n.listenProvider_.startListening(au(P),nf(n,P),I.hashFn,I.onComplete)}}}!d&&c.length>0&&!r&&(h?n.listenProvider_.stopListening(au(e),null):c.forEach(p=>{const _=n.queryToTagMap.get(up(p));n.listenProvider_.stopListening(au(p),_)}))}Cq(n,c)}return a}function Eq(n,e,t,r){const i=gw(n,r);if(i!=null){const s=_w(i),o=s.path,a=s.queryId,l=on(o,e),c=new Ws(cw(a),l,t);return yw(n,o,c)}else return[]}function Tq(n,e,t,r){const i=gw(n,r);if(i){const s=_w(i),o=s.path,a=s.queryId,l=on(o,e),c=ke.fromObject(t),h=new nc(cw(a),l,c);return yw(n,o,h)}else return[]}function uS(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{const E=on(p,i);s=s||ea(_,E),o=o||zi(_)});let a=n.syncPointTree_.get(i);a?(o=o||zi(a),s=s||ea(a,_e())):(a=new lq,n.syncPointTree_=n.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=ee.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,E)=>{const C=ea(E,_e());C&&(s=s.updateImmediateChild(_,C))}));const c=kN(a,e);if(!c&&!e._queryParams.loadsAllData()){const p=up(e);$(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");const _=Rq();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}const h=hw(n.pendingWriteTree_,i);let d=fq(a,e,t,h,s,l);if(!c&&!o&&!r){const p=PN(a,e);d=d.concat(Aq(n,e,p))}return d}function NN(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=on(o,e),c=ea(a,l);if(c)return c});return IN(i,e,s,t,!0)}function Oc(n,e){return bN(e,n.syncPointTree_,null,hw(n.pendingWriteTree_,_e()))}function bN(n,e,t,r){if(ue(n.path))return xN(n,e,t,r);{const i=e.get(_e());t==null&&i!=null&&(t=ea(i,_e()));let s=[];const o=le(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,h=EN(r,o);s=s.concat(bN(a,l,c,h))}return i&&(s=s.concat(mw(i,n,r,t))),s}}function xN(n,e,t,r){const i=e.get(_e());t==null&&i!=null&&(t=ea(i,_e()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=EN(r,o),h=n.operationForChild(o);h&&(s=s.concat(xN(h,a,l,c)))}),i&&(s=s.concat(mw(i,n,r,t))),s}function DN(n,e){const t=e.query,r=nf(n,t);return{hashFn:()=>(iq(e)||ee.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?Iq(n,t._path,r):wq(n,t._path);{const s=I3(i,t);return T_(n,t,null,s)}}}}function nf(n,e){const t=up(e);return n.queryToTagMap.get(t)}function up(n){return n._path.toString()+"$"+n._queryIdentifier}function gw(n,e){return n.tagToQueryMap.get(e)}function _w(n){const e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Te(n.substr(0,e))}}function yw(n,e,t){const r=n.syncPointTree_.get(e);$(r,"Missing sync point for query tag that we're tracking");const i=hw(n.pendingWriteTree_,e);return mw(r,t,i,null)}function Sq(n){return n.fold((e,t,r)=>{if(t&&zi(t))return[ap(t)];{let i=[];return t&&(i=AN(t)),hn(r,(s,o)=>{i=i.concat(o)}),i}})}function au(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(gq())(n._repo,n._path):n}function Cq(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=up(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function Rq(){return _q++}function Aq(n,e,t){const r=e._path,i=nf(n,e),s=DN(n,t),o=n.listenProvider_.startListening(au(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)$(!zi(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,h,d)=>{if(!ue(c)&&h&&zi(h))return[ap(h).query];{let p=[];return h&&(p=p.concat(AN(h).map(_=>_.query))),hn(d,(_,E)=>{p=p.concat(E)}),p}});for(let c=0;c<l.length;++c){const h=l[c];n.listenProvider_.stopListening(au(h),nf(n,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new vw(t)}node(){return this.node_}}class ww{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=lt(this.path_,e);return new ww(this.syncTree_,t)}node(){return NN(this.syncTree_,this.path_)}}const Pq=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},cS=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return kq(n[".sv"],e,t);if(typeof n[".sv"]=="object")return Nq(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},kq=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},Nq=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&$(!1,"Unexpected increment value: "+r);const i=e.node();if($(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},bq=function(n,e,t,r){return Iw(e,new ww(t,n),r)},xq=function(n,e,t){return Iw(n,new vw(e),t)};function Iw(n,e,t){const r=n.getPriority().val(),i=cS(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=cS(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new dt(a,Mt(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new dt(i))),o.forEachChild(Ke,(a,l)=>{const c=Iw(l,e.getImmediateChild(a),t);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Tw(n,e){let t=e instanceof Te?e:new Te(e),r=n,i=le(t);for(;i!==null;){const s=la(r.node.children,i)||{children:{},childCount:0};r=new Ew(i,r,s),t=Se(t),i=le(t)}return r}function Ka(n){return n.node.value}function ON(n,e){n.node.value=e,S_(n)}function VN(n){return n.node.childCount>0}function Dq(n){return Ka(n)===void 0&&!VN(n)}function cp(n,e){hn(n.node.children,(t,r)=>{e(new Ew(t,n,r))})}function LN(n,e,t,r){t&&!r&&e(n),cp(n,i=>{LN(i,e,!0,r)}),t&&r&&e(n)}function Oq(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Vc(n){return new Te(n.parent===null?n.name:Vc(n.parent)+"/"+n.name)}function S_(n){n.parent!==null&&Vq(n.parent,n.name,n)}function Vq(n,e,t){const r=Dq(t),i=Kn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,S_(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,S_(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lq=/[\[\].#$\/\u0000-\u001F\u007F]/,Mq=/[\[\].#$\u0000-\u001F\u007F]/,km=10*1024*1024,MN=function(n){return typeof n=="string"&&n.length!==0&&!Lq.test(n)},FN=function(n){return typeof n=="string"&&n.length!==0&&!Mq.test(n)},Fq=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),FN(n)},UN=function(n,e,t){const r=t instanceof Te?new e6(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+as(r));if(typeof e=="function")throw new Error(n+"contains a function "+as(r)+" with contents = "+e.toString());if(Uk(e))throw new Error(n+"contains "+e.toString()+" "+as(r));if(typeof e=="string"&&e.length>km/3&&Rf(e)>km)throw new Error(n+"contains a string greater than "+km+" utf8 bytes "+as(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(hn(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!MN(o)))throw new Error(n+" contains an invalid key ("+o+") "+as(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);t6(r,o),UN(n,a,r),n6(r)}),i&&s)throw new Error(n+' contains ".value" child '+as(r)+" in addition to actual children.")}},BN=function(n,e,t,r){if(!(r&&t===void 0)&&!FN(t))throw new Error(ZR(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Uq=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),BN(n,e,t,r)},Bq=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!MN(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Fq(t))throw new Error(ZR(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jq{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function jN(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!iw(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function zN(n,e,t){jN(n,t),qN(n,r=>iw(r,e))}function oo(n,e,t){jN(n,t),qN(n,r=>jn(r,e)||jn(e,r))}function qN(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(zq(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function zq(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();Cs&&Lt("event: "+t.toString()),xc(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq="repo_interrupt",$q=25;class Wq{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new jq,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Qd(),this.transactionQueueTree_=new Ew,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Gq(n,e,t){if(n.stats_=nw(n.repoInfo_),n.forceRestClient_||C3())n.server_=new Hd(n.repoInfo_,(r,i,s,o)=>{hS(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>dS(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Dr(n.repoInfo_,e,(r,i,s,o)=>{hS(n,r,i,s,o)},r=>{dS(n,r)},r=>{Hq(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=N3(n.repoInfo_,()=>new P6(n.stats_,n.server_)),n.infoData_=new T6,n.infoSyncTree_=new lS({startListening:(r,i,s,o)=>{let a=[];const l=n.infoData_.getNode(r._path);return l.isEmpty()||(a=lp(n.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Sw(n,"connected",!1),n.serverSyncTree_=new lS({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,l)=>{const c=o(a,l);oo(n.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function Kq(n){const t=n.infoData_.getNode(new Te(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function $N(n){return Pq({timestamp:Kq(n)})}function hS(n,e,t,r,i){n.dataUpdateCount++;const s=new Te(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const l=Cd(t,c=>Mt(c));o=Tq(n.serverSyncTree_,s,l,i)}else{const l=Mt(t);o=Eq(n.serverSyncTree_,s,l,i)}else if(r){const l=Cd(t,c=>Mt(c));o=vq(n.serverSyncTree_,s,l)}else{const l=Mt(t);o=lp(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Rw(n,s)),oo(n.eventQueue_,a,o)}function dS(n,e){Sw(n,"connected",e),e===!1&&Yq(n)}function Hq(n,e){hn(e,(t,r)=>{Sw(n,t,r)})}function Sw(n,e,t){const r=new Te("/.info/"+e),i=Mt(t);n.infoData_.updateSnapshot(r,i);const s=lp(n.infoSyncTree_,r,i);oo(n.eventQueue_,r,s)}function Qq(n){return n.nextWriteId_++}function Yq(n){WN(n,"onDisconnectEvents");const e=$N(n),t=Qd();__(n.onDisconnect_,_e(),(i,s)=>{const o=bq(i,s,n.serverSyncTree_,e);gN(t,i,o)});let r=[];__(t,_e(),(i,s)=>{r=r.concat(lp(n.serverSyncTree_,i,s));const o=t9(n,i);Rw(n,o)}),n.onDisconnect_=Qd(),oo(n.eventQueue_,_e(),r)}function Jq(n,e,t){let r;le(e._path)===".info"?r=uS(n.infoSyncTree_,e,t):r=uS(n.serverSyncTree_,e,t),zN(n.eventQueue_,e._path,r)}function fS(n,e,t){let r;le(e._path)===".info"?r=T_(n.infoSyncTree_,e,t):r=T_(n.serverSyncTree_,e,t),zN(n.eventQueue_,e._path,r)}function Xq(n){n.persistentConnection_&&n.persistentConnection_.interrupt(qq)}function WN(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Lt(t,...e)}function GN(n,e,t){return NN(n.serverSyncTree_,e,t)||ee.EMPTY_NODE}function Cw(n,e=n.transactionQueueTree_){if(e||hp(n,e),Ka(e)){const t=HN(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&Zq(n,Vc(e),t)}else VN(e)&&cp(e,t=>{Cw(n,t)})}function Zq(n,e,t){const r=t.map(c=>c.currentWriteId),i=GN(n,e,r);let s=i;const o=i.hash();for(let c=0;c<t.length;c++){const h=t[c];$(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const d=on(e,h.path);s=s.updateChild(d,h.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;n.server_.put(l.toString(),a,c=>{WN(n,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){const d=[];for(let p=0;p<t.length;p++)t[p].status=2,h=h.concat(Fo(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&d.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();hp(n,Tw(n.transactionQueueTree_,e)),Cw(n,n.transactionQueueTree_),oo(n.eventQueue_,e,h);for(let p=0;p<d.length;p++)xc(d[p])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{wn("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}Rw(n,e)}},o)}function Rw(n,e){const t=KN(n,e),r=Vc(t),i=HN(n,t);return e9(n,i,r),r}function e9(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=on(t,l.path);let h=!1,d;if($(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,d=l.abortReason,i=i.concat(Fo(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=$q)h=!0,d="maxretry",i=i.concat(Fo(n.serverSyncTree_,l.currentWriteId,!0));else{const p=GN(n,l.path,o);l.currentInputSnapshot=p;const _=e[a].update(p.val());if(_!==void 0){UN("transaction failed: Data returned ",_,l.path);let E=Mt(_);typeof _=="object"&&_!=null&&Kn(_,".priority")||(E=E.updatePriority(p.getPriority()));const P=l.currentWriteId,I=$N(n),v=xq(E,p,I);l.currentOutputSnapshotRaw=E,l.currentOutputSnapshotResolved=v,l.currentWriteId=Qq(n),o.splice(o.indexOf(P),1),i=i.concat(yq(n.serverSyncTree_,l.path,v,l.currentWriteId,l.applyLocally)),i=i.concat(Fo(n.serverSyncTree_,P,!0))}else h=!0,d="nodata",i=i.concat(Fo(n.serverSyncTree_,l.currentWriteId,!0))}oo(n.eventQueue_,t,i),i=[],h&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}hp(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)xc(r[a]);Cw(n,n.transactionQueueTree_)}function KN(n,e){let t,r=n.transactionQueueTree_;for(t=le(e);t!==null&&Ka(r)===void 0;)r=Tw(r,t),e=Se(e),t=le(e);return r}function HN(n,e){const t=[];return QN(n,e,t),t.sort((r,i)=>r.order-i.order),t}function QN(n,e,t){const r=Ka(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);cp(e,i=>{QN(n,i,t)})}function hp(n,e){const t=Ka(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,ON(e,t.length>0?t:void 0)}cp(e,r=>{hp(n,r)})}function t9(n,e){const t=Vc(KN(n,e)),r=Tw(n.transactionQueueTree_,e);return Oq(r,i=>{Nm(n,i)}),Nm(n,r),LN(r,i=>{Nm(n,i)}),t}function Nm(n,e){const t=Ka(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?($(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):($(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Fo(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?ON(e,void 0):t.length=s+1,oo(n.eventQueue_,Vc(e),i);for(let o=0;o<r.length;o++)xc(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function r9(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):wn(`Invalid query segment '${t}' in query '${n}'`)}return e}const pS=function(n,e){const t=i9(n),r=t.namespace;t.domain==="firebase.com"&&zr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&zr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||g3();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Jk(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Te(t.pathString)}},i9=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let h=n.indexOf("/");h===-1&&(h=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(h,d)),h<d&&(i=n9(n.substring(h,d)));const p=r9(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const _=e.slice(0,c);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{const E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:l,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}}class JN{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ue(this._path)?null:oN(this._path)}get ref(){return new Yr(this._repo,this._path)}get _queryIdentifier(){const e=J0(this._queryParams),t=ew(e);return t==="{}"?"default":t}get _queryObject(){return J0(this._queryParams)}isEqual(e){if(e=Z(e),!(e instanceof Aw))return!1;const t=this._repo===e._repo,r=iw(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Z3(this._path)}}class Yr extends Aw{constructor(e,t){super(e,t,new lw,!1)}get parent(){const e=lN(this._path);return e===null?null:new Yr(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class rc{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Te(e),r=rf(this.ref,e);return new rc(this._node.getChild(t),r,Ke)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new rc(i,rf(this.ref,r),Ke)))}hasChild(e){const t=new Te(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function o9(n,e){return n=Z(n),n._checkNotDeleted("ref"),e!==void 0?rf(n._root,e):n._root}function rf(n,e){return n=Z(n),le(n._path)===null?Uq("child","path",e,!1):BN("child","path",e,!1),new Yr(n._repo,lt(n._path,e))}class Pw{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new YN("value",this,new rc(e.snapshotNode,new Yr(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new JN(this,e,t):null}matches(e){return e instanceof Pw?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class kw{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new JN(this,e,t):null}createEvent(e,t){$(e.childName!=null,"Child events should have a childName.");const r=rf(new Yr(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new YN(e.type,this,new rc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof kw?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function a9(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const l=t,c=(h,d)=>{fS(n._repo,n,a),l(h,d)};c.userCallback=t.userCallback,c.context=t.context,t=c}const o=new s9(t,s||void 0),a=e==="value"?new Pw(o):new kw(e,o);return Jq(n._repo,n,a),()=>fS(n._repo,n,a)}function l9(n,e,t,r){return a9(n,"value",e,t,r)}uq(Yr);mq(Yr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="FIREBASE_DATABASE_EMULATOR_HOST",C_={};let c9=!1;function h9(n,e,t,r){n.repoInfo_=new Jk(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function d9(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||zr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Lt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=pS(s,i),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[u9]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=pS(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const h=i&&l?new Xo(Xo.OWNER):new A3(n.name,n.options,e);Bq("Invalid Firebase Database URL",o),ue(o.path)||zr("Database URL must point to the root of a Firebase Database (not including a child path).");const d=p9(a,n,h,new R3(n.name,t));return new m9(d,n)}function f9(n,e){const t=C_[e];(!t||t[n.key]!==n)&&zr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Xq(n),delete t[n.key]}function p9(n,e,t,r){let i=C_[e.name];i||(i={},C_[e.name]=i);let s=i[n.toURLString()];return s&&zr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Wq(n,c9,t,r),i[n.toURLString()]=s,s}class m9{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Gq(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Yr(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(f9(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&zr("Cannot call "+e+" on a deleted database.")}}function g9(n=aA(),e){const t=Py(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=EV("database");r&&_9(t,...r)}return t}function _9(n,e,t,r={}){n=Z(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&zr("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&zr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Xo(Xo.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:$R(r.mockUserToken,n.app.options.projectId);s=new Xo(o)}h9(i,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y9(n){h3($r),Fr(new Hn("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return d9(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),vn(O0,V0,n),vn(O0,V0,"esm2017")}Dr.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Dr.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};y9();const v9=()=>{const[n,e]=B.useState("");B.useState(!1);const[t,r]=B.useState(!1),[i,s]=B.useState(""),[o,a]=B.useState(""),[l,c]=B.useState(""),[h,d]=B.useState([]),[p,_]=B.useState(!1),E=Tf(),C={apiKey:"AIzaSyCxVh1JsLTRMXSLipjB3QSwRqd2o7N6FaA",authDomain:"fantqw2g.firebaseapp.com",databaseURL:"https://fantqw2g-default-rtdb.europe-west1.firebasedatabase.app",projectId:"fantqw2g",storageBucket:"fantqw2g.appspot.com",messagingSenderId:"1093154126781",appId:"1:1093154126781:web:c5624592aa67d6a83df0d4",measurementId:"G-VBDDXQSXD4"};et.initializeApp(C),B.useEffect(()=>{et.auth().onAuthStateChanged(w=>{e(w||""),!w&&E("/login")}),v()},[]);const P=()=>{E(`/room/${l}`)},I=()=>{const w=et.firestore(),D=w.collection("rooms"),L={playing:!1,timing:0,url:i,users:[n.uid]};D.add(L).then(M=>{o&&w.collection("withPass").doc(M.id).set({password:o}),E(`/room/${M.id}`)})},v=()=>{et.firestore().collection("rooms").get().then(L=>{const M=[];L.forEach(T=>{var y=T.data();M.push({id:T.id,users:y.users.length})}),d(M),console.log(M)}).catch(L=>{console.log("  :",L)})};return q.jsxs("main",{children:[p&&q.jsx("div",{className:Ln.overlay,onClick:()=>{_(!p)}}),q.jsxs("div",{className:Ln.room_list_container,children:[p?q.jsx("svg",{onClick:()=>{_(!p)},xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:q.jsx("path",{d:"m249-207-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z"})}):q.jsx("svg",{onClick:()=>{_(!p)},xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:q.jsx("path",{d:"M120-240v-60h720v60H120Zm0-210v-60h720v60H120Zm0-210v-60h720v60H120Z"})}),q.jsxs("div",{className:Ln.room_list,style:p?{display:"flex"}:{},children:[q.jsx("p",{children:"Room list: "}),h==null?void 0:h.map(({id:w,users:D})=>q.jsxs("div",{className:Ln.room_li,children:[q.jsx(Ag,{to:"/room/"+w,children:w}),q.jsx("div",{className:Ln.users_count,children:Array.from({length:D}).map((L,M)=>q.jsx("div",{className:Ln.users_circles_count},M))})]},w))]})]}),q.jsx("div",{className:Ln.controls_container,children:q.jsxs("div",{className:Ln.controls,children:[q.jsxs("form",{className:Ln.create_room_form,onSubmit:w=>{w.preventDefault(),I()},children:[q.jsx("input",{value:i,onChange:w=>{s(w.target.value)},type:"text",placeholder:"URL",required:!0}),q.jsxs("div",{className:Ln.create_room_password,children:[q.jsx("label",{htmlFor:"password_on",children:"Password"}),q.jsx("input",{type:"checkbox",id:"password_on",onChange:w=>{r(w.target.checked)}})]}),t&&q.jsx("input",{value:o,onChange:w=>{a(w.target.value)},type:"text",placeholder:"Password"}),q.jsx("button",{children:"Create Room"})]}),q.jsxs("form",{className:Ln.connect_room_form,onSubmit:w=>{w.preventDefault(),P()},children:[q.jsx("input",{type:"text",placeholder:"Room ID",value:l,onChange:w=>{c(w.target.value)}}),q.jsx("button",{children:"Connect to Room"})]})]})})]})},w9="_room_s5e6w_1",I9="_control_forms_s5e6w_10",Pl={room:w9,control_forms:I9};window.PlayerjsAsync=function(){window.pjscnfgs&&Object.entries(window.pjscnfgs).map(([n,e])=>new window.Playerjs(e)),window.pjscnfgs={}};const E9=()=>{const{roomId:n}=NO(),[e,t]=B.useState(""),[r,i]=B.useState(""),[s,o]=B.useState(""),[a,l]=B.useState(!1),[c,h]=B.useState(null),[d,p]=B.useState(""),[_,E]=B.useState(""),C=Tf(),P=B.useRef(null),I=et.firestore(),v=I.collection("rooms").doc(n),w={apiKey:"AIzaSyCxVh1JsLTRMXSLipjB3QSwRqd2o7N6FaA",authDomain:"fantqw2g.firebaseapp.com",databaseURL:"https://fantqw2g-default-rtdb.europe-west1.firebasedatabase.app",projectId:"fantqw2g",storageBucket:"fantqw2g.appspot.com",messagingSenderId:"1093154126781",appId:"1:1093154126781:web:c5624592aa67d6a83df0d4",measurementId:"G-VBDDXQSXD4"};et.initializeApp(w),B.useEffect(()=>{et.auth().onAuthStateChanged(re=>{!re&&C("/login"),re&&(t(re),re.uid&&v.get().then(Re=>{var Ut=Re.data();Ut.users.includes(re.uid)?M():D()}))})},[]);const D=()=>{I.collection("withPass").doc(n).get().then(Re=>{if(Re.exists){var Ut=Re.data();i(Ut.password)}else M()})},L=re=>{re.preventDefault(),s===r?(i(""),M(),v.update({users:et.firestore.FieldValue.arrayUnion(e.uid)})):l(!0)},M=()=>{v.get().then(re=>{var Re=re.data();h(Re),p(Re.url)})};B.useEffect(()=>{c&&T().then(()=>{y(c.url)})},[c]);const T=()=>new Promise((re,Re)=>{const Ut=document.createElement("script");Ut.src="/fantqw2gv2/assets/playerjs.js",Ut.type="text/javascript",Ut.onload=()=>re(),Ut.onerror=()=>Re(new Error("Failed to load the script")),document.body.appendChild(Ut)}),y=re=>{re&&(P.current=new Playerjs({id:"player",file:re}),S(),R())},S=()=>{var re=document.getElementById("player");re&&(re.addEventListener("play",()=>{console.log("play");var Re=P.current.api("time");v.update({playing:!0,timing:Re})}),re.addEventListener("pause",()=>{console.log("pause");var Re=P.current.api("time");v.update({playing:!1,timing:Re})}))},R=()=>{v.onSnapshot(re=>{var Re=re.data();Re.playing?window.pljssglobal[0].api("play"):window.pljssglobal[0].api("pause"),P.current.api("seek",Re.timing),Re.url!=d&&window.location.reload()})},k=re=>{re.preventDefault(),window.pljssglobal[0].api("file",_),v.update({url:_})},b=()=>{v.update({users:et.firestore.FieldValue.arrayRemove(e.uid)}),C("/")},A=()=>{v.delete(),C("/")};return q.jsx("div",{className:Pl.room,children:r?q.jsxs("div",{className:Pl.password_container,children:[q.jsxs("form",{onSubmit:re=>{L(re)},children:[q.jsx("label",{htmlFor:"pass",children:"Enter Password:"}),q.jsx("input",{type:"text",name:"pass",value:s,onChange:re=>{o(re.target.value)}}),q.jsx("button",{children:"Join"})]}),a&&q.jsx("p",{children:"Password is incorect"})]}):q.jsxs(q.Fragment,{children:[q.jsx("div",{id:"player"}),q.jsxs("p",{children:["Room ID: ",n]}),q.jsxs("div",{className:Pl.control_forms,children:[q.jsx("button",{onClick:b,className:Pl.exit_button,children:"Exit Room"}),q.jsxs("form",{onSubmit:k,children:[q.jsx("input",{type:"text",placeholder:"Url",value:_,onChange:re=>{E(re.target.value)}}),q.jsx("button",{children:"Change Url"})]}),q.jsx("button",{onClick:A,className:Pl.delete_button,children:"Delete Room"})]})]})})},T9="_overlay_ujmf5_11",S9="_logo_ujmf5_20",C9="_logo__1_ujmf5_24",R9="_theme__change_ujmf5_30",A9="_icon_ujmf5_33",P9="_right_ujmf5_41",k9="_avatar_ujmf5_47",N9="_noAvatar_link_ujmf5_58",b9="_noAvatar_ujmf5_58",x9="_profile_info_ujmf5_75",D9="_profile_info_container_ujmf5_86",O9="_nickname_ujmf5_92",V9="_uid_ujmf5_108",L9="_signout_button_ujmf5_111",fn={overlay:T9,logo:S9,logo__1:C9,theme__change:R9,icon:A9,right:P9,avatar:k9,noAvatar_link:N9,noAvatar:b9,profile_info:x9,profile_info_container:D9,nickname:O9,uid:V9,signout_button:L9},M9=()=>{const[n,e]=B.useState([]),[t,r]=B.useState(!1),[i,s]=B.useState(!1),[o,a]=B.useState(null),[l,c]=B.useState(""),[h,d]=B.useState(!1),p={apiKey:"AIzaSyCxVh1JsLTRMXSLipjB3QSwRqd2o7N6FaA",authDomain:"fantqw2g.firebaseapp.com",databaseURL:"https://fantqw2g-default-rtdb.europe-west1.firebasedatabase.app",projectId:"fantqw2g",storageBucket:"fantqw2g.appspot.com",messagingSenderId:"1093154126781",appId:"1:1093154126781:web:c5624592aa67d6a83df0d4",measurementId:"G-VBDDXQSXD4"};et.initializeApp(p),B.useEffect(()=>{et.auth().onAuthStateChanged(C=>{C?(e(C),r(!0),_()):(e(null),r(!1))})},[n]);const _=()=>{const C=g9(),P=o9(C,"users/"+n.uid);l9(P,I=>{const v=I.val();console.log(v.username),a(v.username),c(v.username)})},E=()=>{et.auth().signOut()};return q.jsxs("header",{children:[q.jsx("div",{onClick:()=>{s(!i)},style:i?{display:"flex"}:{},className:fn.overlay}),q.jsxs("div",{className:fn.logo,children:[q.jsx(Ag,{to:"/",className:fn.logo__1,children:"fantq"}),q.jsx("span",{className:fn.logo__2,children:"w2g"})]}),q.jsx("div",{className:fn.right,children:t?q.jsx("img",{onClick:()=>{s(!i)},className:fn.avatar,src:n.photoURL}):q.jsx(Ag,{to:"/login",className:fn.noAvatar_link,children:q.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",className:`icon ${fn.noAvatar}`,children:q.jsx("path",{d:"M480-481q-66 0-108-42t-42-108q0-66 42-108t108-42q66 0 108 42t42 108q0 66-42 108t-108 42ZM160-160v-94q0-38 19-65t49-41q67-30 128.5-45T480-420q62 0 123 15.5t127.921 44.694q31.301 14.126 50.19 40.966Q800-292 800-254v94H160Zm60-60h520v-34q0-16-9.5-30.5T707-306q-64-31-117-42.5T480-360q-57 0-111 11.5T252-306q-14 7-23 21.5t-9 30.5v34Zm260-321q39 0 64.5-25.5T570-631q0-39-25.5-64.5T480-721q-39 0-64.5 25.5T390-631q0 39 25.5 64.5T480-541Zm0-90Zm0 411Z"})})})}),q.jsx("div",{className:fn.profile_info,style:i?{top:"8vh"}:{},children:q.jsxs("div",{className:fn.profile_info_container,children:[q.jsx("div",{className:fn.nickname,children:h?q.jsxs("div",{children:[q.jsx("input",{type:"text",value:o,onChange:C=>{c(C.target.value)}}),q.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:q.jsx("path",{d:"M378-246 154-470l43-43 181 181 384-384 43 43-427 427Z"})})]}):q.jsxs("div",{children:[n&&o,q.jsx("svg",{onClick:()=>{d(!0)},xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:q.jsx("path",{d:"M180-180h44l443-443-44-44-443 443v44Zm614-486L666-794l42-42q17-17 42-17t42 17l44 44q17 17 17 42t-17 42l-42 42Zm-42 42L248-120H120v-128l504-504 128 128Zm-107-21-22-22 44 44-22-22Z"})})]})}),q.jsx("div",{children:" UID:"}),q.jsx("div",{className:fn.uid,children:n&&n.uid}),q.jsx("button",{onClick:E,className:fn.signout_button,children:"SignOut"})]})})]})},F9="_loginPage_container_hpzvz_1",U9="_login_container_hpzvz_4",B9="_login_box_hpzvz_11",j9="_signInGoogle_hpzvz_33",z9="_register_box_hpzvz_43",kl={loginPage_container:F9,login_container:U9,login_box:B9,signInGoogle:j9,register_box:z9},q9=()=>{const[n,e]=B.useState(!1),t=Tf(),r={apiKey:"AIzaSyCxVh1JsLTRMXSLipjB3QSwRqd2o7N6FaA",authDomain:"fantqw2g.firebaseapp.com",databaseURL:"https://fantqw2g-default-rtdb.europe-west1.firebasedatabase.app",projectId:"fantqw2g",storageBucket:"fantqw2g.appspot.com",messagingSenderId:"1093154126781",appId:"1:1093154126781:web:c5624592aa67d6a83df0d4",measurementId:"G-VBDDXQSXD4"};et.initializeApp(r),B.useEffect(()=>{et.auth().onAuthStateChanged(s=>{s&&e(!0),console.log(s)})},[]),B.useEffect(()=>{n&&t("/")},[n]);const i=()=>{const s=new et.auth.GoogleAuthProvider;et.auth().signInWithPopup(s).then(o=>{e(!0)}).catch(o=>{const a=o.code,l=o.message;console.log(a,l)})};return q.jsx("div",{className:kl.loginPage_container,children:q.jsxs("div",{className:kl.login_container,children:[q.jsxs("div",{className:kl.login_box,children:[q.jsxs("form",{children:[q.jsx("input",{type:"email",placeholder:"E-mail"}),q.jsx("input",{type:"password",placeholder:"Password"}),q.jsx("button",{children:"SignIn"})]}),q.jsx("p",{children:"- Or Sign in width -"}),q.jsxs("button",{className:kl.signInGoogle,onClick:i,children:[q.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"30px",height:"30px",children:["    ",q.jsx("path",{d:"M 15.003906 3 C 8.3749062 3 3 8.373 3 15 C 3 21.627 8.3749062 27 15.003906 27 C 25.013906 27 27.269078 17.707 26.330078 13 L 25 13 L 22.732422 13 L 15 13 L 15 17 L 22.738281 17 C 21.848702 20.448251 18.725955 23 15 23 C 10.582 23 7 19.418 7 15 C 7 10.582 10.582 7 15 7 C 17.009 7 18.839141 7.74575 20.244141 8.96875 L 23.085938 6.1289062 C 20.951937 4.1849063 18.116906 3 15.003906 3 z"})]}),"Google"]})]}),q.jsx("div",{className:kl.register_box,children:q.jsx("form",{})})]})})};function $9(){return q.jsx("div",{className:"App",children:q.jsxs(XO,{basename:"/fantqw2gv2",children:[q.jsx(M9,{}),q.jsxs(WO,{children:[q.jsx(Mh,{index:!0,element:q.jsx(v9,{})}),q.jsx(Mh,{path:"/room/:roomId",element:q.jsx(E9,{})}),q.jsx(Mh,{path:"/login",element:q.jsx(q9,{})})]})]})})}bm.createRoot(document.getElementById("root")).render(q.jsx(SS.StrictMode,{children:q.jsx($9,{})}));
